

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>34. Knowing the Forecasts of Others &#8212; Advanced Quantitative Economics with Python</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/quantecon-book-theme.css?digest=bd0785fbb14d8d2bd4d9ae501d79ed8d3bc089ec" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>


    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/scripts/quantecon-book-theme.js?digest=d6d86bce9979111653c4c495e33499e1796e172a"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-KZLV7PM9LL"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-KZLV7PM9LL');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"argmax": "arg\\,max", "argmin": "arg\\,min", "col": "col", "Span": "span", "epsilon": "\\varepsilon", "EE": "\\mathbb{E}", "PP": "\\mathbb{P}", "RR": "\\mathbb{R}", "NN": "\\mathbb{N}", "ZZ": "\\mathbb{Z}", "aA": "\\mathcal{A}", "bB": "\\mathcal{B}", "cC": "\\mathcal{C}", "dD": "\\mathcal{D}", "eE": "\\mathcal{E}", "fF": "\\mathcal{F}", "gG": "\\mathcal{G}", "hH": "\\mathcal{H}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'knowing_forecasts_of_others';</script>
    <link rel="canonical" href="https://python-advanced.quantecon.org/knowing_forecasts_of_others.html" />
    <link rel="shortcut icon" href="_static/lectures-favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="35. Asset Pricing II: The Lucas Asset Pricing Model" href="lucas_model.html" />
    <link rel="prev" title="33. Classical Prediction and Filtering With Linear Algebra" href="classical_filtering.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Thomas J. Sargent &amp; John Stachurski" />
<meta name="keywords" content="Python, QuantEcon, Quantitative Economics, Economics, Sloan, Alfred P. Sloan Foundation, Tom J. Sargent, John Stachurski" />
<meta name="description" content=This website presents a set of lectures on advanced quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski. />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="Knowing the Forecasts of Others"/>
<meta name="twitter:description" content="This website presents a set of lectures on advanced quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski.">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="Knowing the Forecasts of Others" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://python-advanced.quantecon.org/knowing_forecasts_of_others.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="This website presents a set of lectures on advanced quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski." />
<meta property="og:site_name" content="Advanced Quantitative Economics with Python" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>


    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=knowing_forecasts_of_others>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">34.1. Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-sequence-of-models">34.1.1. A Sequence of Models</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-setting">34.2. The Setting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tactics">34.3. Tactics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#equilibrium-conditions">34.4. Equilibrium Conditions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#equilibrium-under-perfect-foresight">34.4.1. Equilibrium under perfect foresight</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#equilibrium-with-theta-t-stochastic-but-observed-at-t">34.5. Equilibrium with <span class="math notranslate nohighlight">\(\theta_t\)</span> stochastic but observed at <span class="math notranslate nohighlight">\(t\)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering">34.5.1. Filtering</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#one-noisy-signal">34.5.1.1. One noisy signal</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#state-reconstruction-error">34.5.1.2. State-reconstruction error</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-new-state-variable">34.5.2. A new state variable</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#two-noisy-signals">34.5.3. Two Noisy Signals</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#guess-and-verify-tactic">34.6. Guess-and-Verify Tactic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#equilibrium-with-one-noisy-signal-on-theta-t">34.7. Equilibrium with One Noisy Signal on <span class="math notranslate nohighlight">\(\theta_t\)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-solve-for-tilde-lambda-and-lambda">34.7.1. Step 1: Solve for <span class="math notranslate nohighlight">\(\tilde{\lambda}\)</span> and <span class="math notranslate nohighlight">\(\lambda\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-solve-for-p">34.7.2. Step 2: Solve for <span class="math notranslate nohighlight">\(p\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-represent-the-system-using-quantecon-linearstatespace">34.7.3. Step 3: Represent the system using <code class="docutils literal notranslate"><span class="pre">quantecon.LinearStateSpace</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-compute-impulse-response-functions">34.7.4. Step 4: Compute impulse response functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-compute-stationary-covariance-matrices-and-population-regressions">34.7.5. Step 5: Compute stationary covariance matrices and population regressions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#equilibrium-with-two-noisy-signals-on-theta-t">34.8. Equilibrium with Two Noisy Signals on <span class="math notranslate nohighlight">\(\theta_t\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-step">34.9. Key Step</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#an-observed-common-shock-benchmark">34.10. An observed common shock benchmark</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-of-all-signal-structures">34.11. Comparison of  All Signal Structures</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notes-on-history-of-the-problem">34.12. Notes on History of the Problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#further-historical-remarks">34.12.1. Further historical remarks</a></li>
</ul>
</li>
</ul>
                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="_static/qe-logo-large.png" class="logo logo-img" alt="logo"></a>
                                    
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="intro.html">Advanced Quantitative Economics with Python</a></p>

                        <p class="qe-page__header-subheading">Knowing the Forecasts of Others</p>

                    </div>
                    <!-- length 2, since its a string and empty dict has length 2 - {} -->
                        <p class="qe-page__header-authors" font-size="18">
                            
                                
                                    <a href="http://www.tomsargent.com/" target="_blank"><span>Thomas J. Sargent</span></a>
                                
                            
                                
                                    and <a href="https://johnstachurski.net/" target="_blank"><span>John Stachurski</span></a>
                                
                            
                        </p>


                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <div id="qe-notebook-header" align="right" style="text-align:right;">
        <a href="https://quantecon.org/" title="quantecon.org">
                <img style="width:250px;display:inline;" width="250px" src="https://assets.quantecon.org/img/qe-menubar-logo.svg" alt="QuantEcon">
        </a>
</div><section class="tex2jax_ignore mathjax_ignore" id="knowing-the-forecasts-of-others">
<h1><span class="section-number">34. </span>Knowing the Forecasts of Others<a class="headerlink" href="#knowing-the-forecasts-of-others" title="Permalink to this heading">#</a></h1>
<p>In addition to what’s in Anaconda, this lecture will need the following libraries:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>quantecon
<span class="o">!</span>conda<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>-c<span class="w"> </span>plotly<span class="w"> </span>plotly<span class="w"> </span>plotly-orca
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: quantecon in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (0.8.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: numba&gt;=0.49.0 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from quantecon) (0.60.0)
Requirement already satisfied: numpy&gt;=1.17.0 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from quantecon) (1.26.4)
Requirement already satisfied: requests in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from quantecon) (2.32.3)
Requirement already satisfied: scipy&gt;=1.5.0 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from quantecon) (1.13.1)
Requirement already satisfied: sympy in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from quantecon) (1.13.2)
Requirement already satisfied: llvmlite&lt;0.44,&gt;=0.43.0dev0 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from numba&gt;=0.49.0-&gt;quantecon) (0.43.0)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from requests-&gt;quantecon) (3.3.2)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from requests-&gt;quantecon) (3.7)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from requests-&gt;quantecon) (2.2.3)
Requirement already satisfied: certifi&gt;=2017.4.17 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from requests-&gt;quantecon) (2024.8.30)
Requirement already satisfied: mpmath&lt;1.4,&gt;=1.1.0 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from sympy-&gt;quantecon) (1.3.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Channels:
 - plotly
 - default
 - defaults
Platform: linux-64
Collecting package metadata (repodata.json): - 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>\ 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>| 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/ 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>- 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>\ 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>done
Solving environment: / 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>- 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>\ 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>| 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/ 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>- 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>\ 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>| 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/ 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>- 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>\ 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>done
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># All requested packages already installed.
</pre></div>
</div>
</div>
</details>
</div>
<section id="introduction">
<h2><span class="section-number">34.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>Robert E. Lucas, Jr. <span id="id1">[<a class="reference internal" href="zreferences.html#id24" title="Jr. Robert E. Lucas. An equilibrium model of the business cycle. Journal of Political Economy, 83:1113-1144, 1975.">Robert E. Lucas, 1975</a>]</span>, Kenneth Kasa  <span id="id2">[<a class="reference internal" href="zreferences.html#id27" title="Kenneth Kasa. Forecasting the forecasts of others in the frequency domain. Review of Economic Dynamics, 3:726–756, 2000.">Kasa, 2000</a>]</span>, and Robert Townsend
<span id="id3">[<a class="reference internal" href="zreferences.html#id28" title="Robert M. Townsend. Forecasting the forecasts of others. Journal of Political Economy, 91:546–588, 1983.">Townsend, 1983</a>]</span> showed that putting  decision makers into environments in which they want to infer persistent hidden  state
variables from equilibrium prices and quantities can
elongate and amplify impulse responses to aggregate
shocks.</p>
<p>This provides a promising way to think about amplification mechanisms  in business cycle models.</p>
<p>Townsend <span id="id4">[<a class="reference internal" href="zreferences.html#id28" title="Robert M. Townsend. Forecasting the forecasts of others. Journal of Political Economy, 91:546–588, 1983.">Townsend, 1983</a>]</span>
noted  that living in  such environments   makes decision makers  want  to forecast  forecasts of others.</p>
<p>This theme has been pursued  for situations in which
decision makers’ imperfect information forces them to pursue an
infinite recursion that involves forming beliefs about the beliefs of others
(e.g., <span id="id5">[<a class="reference internal" href="zreferences.html#id31" title="Franklin Allen, Stephen Morris, and Hyun Song Shin. Beauty contests, bubbles, and iterated expectations in asset markets. mimeo, 2002.">Allen <em>et al.</em>, 2002</a>]</span>).</p>
<p>Lucas <span id="id6">[<a class="reference internal" href="zreferences.html#id24" title="Jr. Robert E. Lucas. An equilibrium model of the business cycle. Journal of Political Economy, 83:1113-1144, 1975.">Robert E. Lucas, 1975</a>]</span> side stepped having decision makers forecast the
forecasts of other decision makers by assuming that they simply <strong>pool their
information</strong> before forecasting.</p>
<p>A <strong>pooling equilibrium</strong> like Lucas’s plays a prominent role in this lecture.</p>
<p>Because he didn’t assume such pooling, <span id="id7">[<a class="reference internal" href="zreferences.html#id28" title="Robert M. Townsend. Forecasting the forecasts of others. Journal of Political Economy, 91:546–588, 1983.">Townsend, 1983</a>]</span>
confronted the forecasting the forecasts of others problem.</p>
<p>To formulate the  problem recursively required that Townsend define a decision maker’s <strong>state</strong> vector.</p>
<p>Townsend concluded that his original  model required an intractable infinite dimensional  state space.</p>
<p>Therefore, he constructed a more manageable approximating model in which a hidden Markov component of
a demand shock is
revealed to all firms after a fixed,  finite number of periods.</p>
<p>In this lecture, we illustrate again the theme that <strong>finding the state is an art</strong> by
showing how to formulate Townsend’s original model in terms of a low-dimensional state space.</p>
<p>We show that Townsend’s model shares equilibrium prices and quantities with those   that
prevail in a pooling equilibrium.</p>
<p>That finding emerged from a line of research about  Townsend’s model that   built on <span id="id8">[<a class="reference internal" href="zreferences.html#id26" title="Joseph Pearlman, David Currie, and Paul Levine. Rational Expectations Models with Private Information. Economic Modelling, 3(2):90–105, 1986.">Pearlman <em>et al.</em>, 1986</a>]</span> and that  culminated in
<span id="id9">[<a class="reference internal" href="zreferences.html#id25" title="Joseph G. Pearlman and Thomas J. Sargent. Knowing the Forecasts of Others. Review of Economic Dynamics, 8(2):480-497, April 2005. URL: https://ideas.repec.org/a/red/issued/v8y2005i2p480-497.html, doi:10.1016/j.red.2004.10.011.">Pearlman and Sargent, 2005</a>]</span> .</p>
<p>Rather than directly deploying the <span id="id10">[<a class="reference internal" href="zreferences.html#id26" title="Joseph Pearlman, David Currie, and Paul Levine. Rational Expectations Models with Private Information. Economic Modelling, 3(2):90–105, 1986.">Pearlman <em>et al.</em>, 1986</a>]</span> machinery here, we shall instead implement a  sneaky
<strong>guess-and-verify</strong> tactic.</p>
<ul class="simple">
<li><p>We first compute a pooling equilibrium and represent it as an instance of  a linear  state-space system provided by
the Python class <code class="docutils literal notranslate"><span class="pre">quantecon.LinearStateSpace</span></code>.</p></li>
<li><p>Leaving the state-transition equation for the pooling equilibrium unaltered, we alter the observation vector
for a firm to match what it is in Townsend’s original model. So rather than directly observing the signal received by
firms in the other industry, a firm sees the equilibrium price
of the good produced by the other industry.</p></li>
<li><p>We compute a population linear least squares regression of the noisy signal at time <span class="math notranslate nohighlight">\(t\)</span> that firms in the other
industry would  receive in a pooling equilibrium on time <span class="math notranslate nohighlight">\(t\)</span> information that a firm receives in Townsend’s
original model.</p></li>
<li><p>The <span class="math notranslate nohighlight">\(R^2\)</span> in this regression equals <span class="math notranslate nohighlight">\(1\)</span>.</p></li>
<li><p>That verifies that a firm’s information
set in Townsend’s original model equals its information set in a pooling equilibrium.</p></li>
<li><p>Therefore, equilibrium
prices and quantities in Townsend’s original model equal those in a pooling equilibrium.</p></li>
</ul>
<section id="a-sequence-of-models">
<h3><span class="section-number">34.1.1. </span>A Sequence of Models<a class="headerlink" href="#a-sequence-of-models" title="Permalink to this heading">#</a></h3>
<p>We proceed by describing  a sequence of models of two industries that are linked in a
single way:</p>
<ul class="simple">
<li><p>shocks to the demand curves for their products have a common
component.</p></li>
</ul>
<p>The models are simplified versions   of Townsend’s  <span id="id11">[<a class="reference internal" href="zreferences.html#id28" title="Robert M. Townsend. Forecasting the forecasts of others. Journal of Political Economy, 91:546–588, 1983.">Townsend, 1983</a>]</span>.</p>
<p>Townsend’s is a model of a rational expectations equilibrium in which firms want to <strong>forecast  forecasts of others</strong>.</p>
<p>In Townsend’s model, firms condition  their forecasts on observed endogenous variables whose equilibrium laws of motion
are determined by their own forecasting functions.</p>
<p>We shall  assemble model  components progressively in  ways that can help us to appreciate the structure of the
<strong>pooling equilibrium</strong>  that ultimately interests us.</p>
<p>While keeping all other aspects of the model the same, we shall study
consequences of alternative assumptions about what decision makers
observe.</p>
<p>Technically, this lecture deploys concepts and tools that appear
in  <a class="reference external" href="https://python-intro.quantecon.org/kalman.html">First Look at Kalman Filter</a> and
<a class="reference external" href="https://python-intro.quantecon.org/rational_expectations.html">Rational Expectations Equilibrium</a>.</p>
</section>
</section>
<section id="the-setting">
<h2><span class="section-number">34.2. </span>The Setting<a class="headerlink" href="#the-setting" title="Permalink to this heading">#</a></h2>
<p>We cast all variables in terms of deviations from means.</p>
<p>Therefore,  we omit constants from inverse demand curves
and other functions.</p>
<p>Firms in  industry <span class="math notranslate nohighlight">\(i=1,2\)</span> use a single factor of
production, capital <span class="math notranslate nohighlight">\(k_t^i\)</span>, to produce output of a single good,
<span class="math notranslate nohighlight">\(y_t^i\)</span>.</p>
<p>Firms bear quadratic costs of adjusting their capital stocks.</p>
<p>A representative firm in industry <span class="math notranslate nohighlight">\(i\)</span> has production function
<span class="math notranslate nohighlight">\(y_t^i = f k_t^i\)</span>, <span class="math notranslate nohighlight">\(f &gt;0\)</span>.</p>
<p>The firm acts as a price taker with
respect to output price <span class="math notranslate nohighlight">\(P_t^i\)</span>, and maximizes</p>
<div class="math notranslate nohighlight" id="equation-town1">
<span class="eqno">(34.1)<a class="headerlink" href="#equation-town1" title="Permalink to this equation">#</a></span>\[\begin{aligned}
  E_0^i \sum_{t=0}^\infty \beta^t \left\{ P_t^i f k_t^i - .5
     h (k_{t+1}^i - k_t^i)^2 \right\} ,
  \quad h &gt;0  .\end{aligned}\]</div>
<p>Demand in industry <span class="math notranslate nohighlight">\(i\)</span> is described by the inverse demand curve</p>
<div class="math notranslate nohighlight" id="equation-town2">
<span class="eqno">(34.2)<a class="headerlink" href="#equation-town2" title="Permalink to this equation">#</a></span>\[\begin{aligned}
  P_t^i = - b Y_t^i + \theta_t + \epsilon_t^i  , \quad b &gt;0,
  \end{aligned}\]</div>
<p>where <span class="math notranslate nohighlight">\(P_t^i\)</span> is the price of good <span class="math notranslate nohighlight">\(i\)</span> at <span class="math notranslate nohighlight">\(t\)</span>,
<span class="math notranslate nohighlight">\(Y_t^i = f K_t^i\)</span> is output in market <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(\theta_t\)</span>
is a persistent component of a demand shock that is common across the
two industries, and <span class="math notranslate nohighlight">\(\epsilon_t^i\)</span> is an industry specific
component of the demand shock that is i.i.d. and whose time <span class="math notranslate nohighlight">\(t\)</span>
marginal distribution is <span class="math notranslate nohighlight">\({\mathcal N}(0, \sigma_{\epsilon}^2)\)</span>.</p>
<p>We assume that <span class="math notranslate nohighlight">\(\theta_t\)</span> is governed by</p>
<div class="math notranslate nohighlight" id="equation-town2a">
<span class="eqno">(34.3)<a class="headerlink" href="#equation-town2a" title="Permalink to this equation">#</a></span>\[\begin{aligned}
  \theta_{t+1} = \rho \theta_t + v_{t}
  \end{aligned}\]</div>
<p>where <span class="math notranslate nohighlight">\(\{v_{t}\}\)</span> is an i.i.d. sequence of Gaussian shocks,  each
with mean zero and variance <span class="math notranslate nohighlight">\(\sigma_v^2\)</span>.</p>
<p>To simplify notation, we’ll study a special case by setting
<span class="math notranslate nohighlight">\(h=f=1\)</span>.</p>
<p>Costs of adjusting their capital stocks impart to firms an incentive to forecast the price of the
good that they sell.</p>
<p>Throughout, we use the <strong>rational expectations</strong> equilibrium concept presented
in this lecture <a class="reference external" href="https://python-intro.quantecon.org/rational_expectations.html">Rational Expectations Equilibrium</a>.</p>
<p>We let capital letters denote market wide objects and lower case letters
denote objects chosen by a representative firm.</p>
<p>In each industry, a competitive equilibrium prevails.</p>
<p>To rationalize the big <span class="math notranslate nohighlight">\(K\)</span>, little <span class="math notranslate nohighlight">\(k\)</span> connection, we can
think of there being a continuum of  firms in industry <span class="math notranslate nohighlight">\(i\)</span>, with each firm being indexed by
<span class="math notranslate nohighlight">\(\omega \in [0,1]\)</span> and
<span class="math notranslate nohighlight">\(K^i = \int_0^1 k^i(\omega) d \omega\)</span>.</p>
<p>In equilibrium, <span class="math notranslate nohighlight">\(k_t^i = K_t^i\)</span>, but  we must distinguish
between <span class="math notranslate nohighlight">\(k_t^i\)</span> and <span class="math notranslate nohighlight">\(K_t^i\)</span> when we pose the firm’s
optimization problem.</p>
</section>
<section id="tactics">
<h2><span class="section-number">34.3. </span>Tactics<a class="headerlink" href="#tactics" title="Permalink to this heading">#</a></h2>
<p>We shall  compute
equilibrium laws of motion for capital in industry <span class="math notranslate nohighlight">\(i\)</span> under a
sequence of assumptions about what a representative firm observes.</p>
<p>Successive members of this sequence make a representative firm’s
information more and more obscure.</p>
<p>We begin with the most information, then gradually withdraw information
in a way that approaches and eventually reaches the Townsend-like information
structure that  we are ultimately interested in.</p>
<p>Thus, we shall compute equilibria under the following alternative
information structures:</p>
<ul class="simple">
<li><p><strong>Perfect foresight:</strong> future values of
<span class="math notranslate nohighlight">\(\theta_t, \epsilon_{t}^i\)</span> are observed in industry <span class="math notranslate nohighlight">\(i\)</span>.</p></li>
<li><p><strong>Observed history of stochastic</strong> <span class="math notranslate nohighlight">\(\theta_t\)</span>:
<span class="math notranslate nohighlight">\(\{\theta_t, \epsilon_{t}^i\}\)</span> are realizations from a
stochastic process; current and past values of each are observed at
time <span class="math notranslate nohighlight">\(t\)</span> but future values are not.</p></li>
<li><p><strong>One noise-ridden observation on</strong> <span class="math notranslate nohighlight">\(\theta_t\)</span>: values of
<span class="math notranslate nohighlight">\(\{\theta_t, \epsilon_{t}^i\}\)</span> separately are never observed. However, at
time <span class="math notranslate nohighlight">\(t\)</span>, a history <span class="math notranslate nohighlight">\(w^t\)</span> of  scalar noise-ridden
observations on <span class="math notranslate nohighlight">\(\theta_t\)</span> is observed at time <span class="math notranslate nohighlight">\(t\)</span>.</p></li>
<li><p><strong>Two noise-ridden observations on</strong> <span class="math notranslate nohighlight">\(\theta_t\)</span>: values of
<span class="math notranslate nohighlight">\(\{\theta_t, \epsilon_{t}^i\}\)</span> separately are never observed. However, at
time <span class="math notranslate nohighlight">\(t\)</span>, a history <span class="math notranslate nohighlight">\(w^t\)</span> of <em>two</em> noise-ridden
observations on <span class="math notranslate nohighlight">\(\theta_t\)</span> is observed at time <span class="math notranslate nohighlight">\(t\)</span>.</p></li>
</ul>
<p>Successive computations build one on previous ones.</p>
<p>We proceed by first finding an equilibrium under perfect foresight.</p>
<p>To compute an equilibrium with current and past but not future values of  <span class="math notranslate nohighlight">\(\theta_t\)</span> observed, we use a
<em>certainty equivalence principle</em> to justify modifying the perfect
foresight equilibrium by replacing future values of
<span class="math notranslate nohighlight">\(\theta_s, \epsilon_{s}^i, s \geq t\)</span> with mathematical
expectations conditioned on <span class="math notranslate nohighlight">\(\theta_t\)</span>.</p>
<p>This provides the equilibrium when <span class="math notranslate nohighlight">\(\theta_t\)</span> is observed at
<span class="math notranslate nohighlight">\(t\)</span> but future <span class="math notranslate nohighlight">\(\theta_{t+j}\)</span> and
<span class="math notranslate nohighlight">\(\epsilon_{t+j}^i\)</span> are not observed.</p>
<p>To find an equilibrium when a history <span class="math notranslate nohighlight">\(w^t\)</span> observations  of a <strong>single</strong> noise-ridden
<span class="math notranslate nohighlight">\(\theta_t\)</span> is observed, we again apply a
certainty equivalence principle and replace future values of the random
variables <span class="math notranslate nohighlight">\(\theta_s, \epsilon_{s}^i, s \geq t\)</span> with their
mathematical expectations conditioned on <span class="math notranslate nohighlight">\(w^t\)</span>.</p>
<p>To find an equilibrium when  a history <span class="math notranslate nohighlight">\(w^t\)</span> of  <strong>two</strong> noisy
signals on <span class="math notranslate nohighlight">\(\theta_t\)</span> is observed, we replace future values of the
random variables <span class="math notranslate nohighlight">\(\theta_s, \epsilon_{s}^i, s \geq t\)</span> with their
mathematical expectations conditioned on history <span class="math notranslate nohighlight">\(w^t\)</span>.</p>
<p>We call the equilibrium with two noise-ridden observations on <span class="math notranslate nohighlight">\(\theta_t\)</span> a <strong>pooling equilibrium</strong>.</p>
<ul class="simple">
<li><p>It corresponds to an arrangement in which at the beginning of each
period firms in industries <span class="math notranslate nohighlight">\(1\)</span> and <span class="math notranslate nohighlight">\(2\)</span> somehow get
together and share information about current values of their noisy
signals on <span class="math notranslate nohighlight">\(\theta\)</span>.</p></li>
</ul>
<p>We want ultimately to compare outcomes in  a pooling equilibrium
with an equilibrium under the following alternative information structure for a firm
in industry <span class="math notranslate nohighlight">\(i\)</span> that originally interested Townsend <span id="id12">[<a class="reference internal" href="zreferences.html#id28" title="Robert M. Townsend. Forecasting the forecasts of others. Journal of Political Economy, 91:546–588, 1983.">Townsend, 1983</a>]</span>:</p>
<ul class="simple">
<li><p><strong>Firm</strong> <span class="math notranslate nohighlight">\(i\)</span>’s <strong>noise-ridden signal on</strong> <span class="math notranslate nohighlight">\(\theta_t\)</span> <strong>and the
price in industry</strong> <span class="math notranslate nohighlight">\(-i\)</span>, a firm in industry
<span class="math notranslate nohighlight">\(i\)</span> observes a history <span class="math notranslate nohighlight">\(w^t\)</span> of <em>one</em> noise-ridden signal
on <span class="math notranslate nohighlight">\(\theta_t\)</span> and a history of industry <span class="math notranslate nohighlight">\(-i\)</span>’s price is
observed. (Here <span class="math notranslate nohighlight">\(-i\)</span> means ``not <span class="math notranslate nohighlight">\(i\)</span>’’.)</p></li>
</ul>
<p>With this information structure, a representative firm <span class="math notranslate nohighlight">\(i\)</span> sees the price as well as the
aggregate endogenous state variable <span class="math notranslate nohighlight">\(Y_t^i\)</span> in its own industry.</p>
<p>That allows it to  infer
the total demand shock <span class="math notranslate nohighlight">\(\theta_t + \epsilon_{t}^i\)</span>.</p>
<p>However, at time <span class="math notranslate nohighlight">\(t\)</span>, the firm sees only <span class="math notranslate nohighlight">\(P_t^{-i}\)</span> and does
not see <span class="math notranslate nohighlight">\(Y_t^{-i}\)</span>, so that a firm in industry <span class="math notranslate nohighlight">\(i\)</span> does not <strong>directly</strong>
observe <span class="math notranslate nohighlight">\(\theta_t + \epsilon_t^{-i}\)</span>.</p>
<p>Nevertheless, it will turn out that   equilibrium prices and quantities in this equilibrium equal
their counterparts in a pooling equilibrium because
firms in industry <span class="math notranslate nohighlight">\(i\)</span> are able to infer the noisy signal about the demand shock
received by firms in industry <span class="math notranslate nohighlight">\(-i\)</span>.</p>
<p>We shall verify this assertion  by using a guess and verify tactic that involves running a least
squares regression and inspecting its <span class="math notranslate nohighlight">\(R^2\)</span>. <a class="footnote-reference brackets" href="#footnote0" id="id13">1</a></p>
</section>
<section id="equilibrium-conditions">
<h2><span class="section-number">34.4. </span>Equilibrium Conditions<a class="headerlink" href="#equilibrium-conditions" title="Permalink to this heading">#</a></h2>
<p>It is convenient to solve a firm’s problem without
uncertainty  by forming the Lagrangian:</p>
<div class="math notranslate nohighlight">
\[
\begin{aligned}
J=\sum_{t=0}^\infty \beta^t \left\{
P_t^i  k_t^i - .5   (\mu_t^i)^2  + \phi_t^i \left[
   k_t^i + \mu_t^i - k_{t+1}^i \right]  \right\} \end{aligned}
\]</div>
<p>where  <span class="math notranslate nohighlight">\(\{\phi_t^i\}\)</span> is a sequence of Lagrange multipliers on the
transition law <span class="math notranslate nohighlight">\(k_{t+1}^i = k_{t}^i + \mu_t^i\)</span>.</p>
<p>First order conditions for the
nonstochastic problem are</p>
<div class="math notranslate nohighlight" id="equation-town4">
<span class="eqno">(34.4)<a class="headerlink" href="#equation-town4" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{aligned}
  \phi_t^i &amp; =  \beta \phi_{t+1}^i + \beta  P_{t+1}^i   \\
  \mu_t^i &amp; =  \phi_t^i .   \end{aligned}\end{split}\]</div>
<p>Substituting the demand function <a class="reference internal" href="#equation-town2">(34.2)</a> for
<span class="math notranslate nohighlight">\(P_t^i\)</span>, imposing the condition <span class="math notranslate nohighlight">\(k_t^i = K_t^i\)</span> that makes representative firm be
representative, and using  definition <a class="reference internal" href="#equation-town7">(34.6)</a>
of <span class="math notranslate nohighlight">\(g_t^i\)</span>, the Euler equation <a class="reference internal" href="#equation-town4">(34.4)</a> lagged
by one period can be expressed as
<span class="math notranslate nohighlight">\(- b k_t^i + \theta_t + \epsilon_t^i + (k_{t+1}^i - k_t^i) - g_t^i =0\)</span>
or</p>
<div class="math notranslate nohighlight" id="equation-pcl11">
<span class="eqno">(34.5)<a class="headerlink" href="#equation-pcl11" title="Permalink to this equation">#</a></span>\[\begin{aligned}
  k_{t+1}^i = (b+1) k_t^i - \theta_t - \epsilon_t^i + g_t^i
  \end{aligned}\]</div>
<p>where we define <span class="math notranslate nohighlight">\(g_t^i\)</span> by</p>
<div class="math notranslate nohighlight" id="equation-town7">
<span class="eqno">(34.6)<a class="headerlink" href="#equation-town7" title="Permalink to this equation">#</a></span>\[g_t^i = \beta^{-1} (k_t^i - k_{t-1}^i)\]</div>
<p>We can write  Euler equation <a class="reference internal" href="#equation-town4">(34.4)</a> as:</p>
<div class="math notranslate nohighlight" id="equation-pcl10">
<span class="eqno">(34.7)<a class="headerlink" href="#equation-pcl10" title="Permalink to this equation">#</a></span>\[\begin{aligned}
  g_t^i = P_t^i + \beta g_{t+1}^i
  \end{aligned}\]</div>
<p>In addition, we have the law of motion for <span class="math notranslate nohighlight">\(\theta_t\)</span>,
<a class="reference internal" href="#equation-town2a">(34.3)</a>, and the demand equation
<a class="reference internal" href="#equation-town2">(34.2)</a>.</p>
<p>In summary, with perfect foresight, equilibrium conditions for industry
<span class="math notranslate nohighlight">\(i\)</span> comprise  the following system of difference equations:</p>
<div class="math notranslate nohighlight" id="equation-sol1">
<span class="eqno">(34.8)<a class="headerlink" href="#equation-sol1" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{aligned}
  k_{t+1}^i &amp; =  (1+b)k_t^i - \epsilon_t^i -\theta_t + g_t^i \\
  \theta_{t+1} &amp; =  \rho \theta_t + v_t \\
  g_{t+1}^i  &amp; = \beta^{-1} (g_t^i - P_t^i)   \\
  P_t^i &amp; =  -b k_t^i + \epsilon_t^i + \theta_t  \end{aligned}\end{split}\]</div>
<p>Without perfect foresight, the same system prevails except that the
following equation replaces the third equation of <a class="reference internal" href="#equation-sol1">(34.8)</a>:</p>
<div class="math notranslate nohighlight">
\[
\begin{aligned}
g_{t+1,t}^i = \beta^{-1} (g_t^i - P_t^i) \end{aligned}
\]</div>
<p>where
<span class="math notranslate nohighlight">\(x_{t+1,t}\)</span> denotes the mathematical expectation of
<span class="math notranslate nohighlight">\(x_{t+1}\)</span> conditional on information at time <span class="math notranslate nohighlight">\(t\)</span>.</p>
<section id="equilibrium-under-perfect-foresight">
<h3><span class="section-number">34.4.1. </span>Equilibrium under perfect foresight<a class="headerlink" href="#equilibrium-under-perfect-foresight" title="Permalink to this heading">#</a></h3>
<p>Our first step is to compute the equilibrium law of motion for
<span class="math notranslate nohighlight">\(k_t^i\)</span> under perfect foresight.</p>
<p>Let <span class="math notranslate nohighlight">\(L\)</span> be the lag
operator. <a class="footnote-reference brackets" href="#footnote3" id="id14">2</a></p>
<p>Equations <a class="reference internal" href="#equation-pcl10">(34.7)</a> and <a class="reference internal" href="#equation-pcl11">(34.5)</a>
imply the second order difference equation in
<span class="math notranslate nohighlight">\(k_t^i\)</span>: <a class="footnote-reference brackets" href="#footnote4" id="id15">3</a></p>
<div class="math notranslate nohighlight" id="equation-euler1">
<span class="eqno">(34.9)<a class="headerlink" href="#equation-euler1" title="Permalink to this equation">#</a></span>\[\begin{aligned}
  \left[ (L^{-1} - (1+b))(1-\beta L^{-1}) + b\right] k_t^i
  = \beta L^{-1} \epsilon_t^i + \beta L^{-1} \theta_t .
  \end{aligned}\]</div>
<p>Factor the polynomial in <span class="math notranslate nohighlight">\(L\)</span> on the left side as:</p>
<div class="math notranslate nohighlight">
\[
\begin{aligned}
-\beta [L^{-2} -(\beta^{-1} + (1+b))L^{-1} + \beta^{-1}]
= \tilde \lambda^{-1}(L^{-1} - \tilde \lambda)(1-\tilde \lambda \beta L^{-1})
\end{aligned}
\]</div>
<p>where <span class="math notranslate nohighlight">\(|\tilde \lambda | &lt; 1\)</span> is the smaller root and
<span class="math notranslate nohighlight">\(\lambda\)</span> is the larger root of
<span class="math notranslate nohighlight">\((\lambda-1)(\lambda-1/\beta)=b\lambda\)</span>.</p>
<p>Therefore, <a class="reference internal" href="#equation-euler1">(34.9)</a> can be expressed as</p>
<div class="math notranslate nohighlight">
\[
\begin{aligned}
\tilde \lambda^{-1}(L^{-1} - \tilde \lambda) (1-\tilde \lambda \beta L^{-1})
k_t^i = \beta L^{-1} \epsilon_t^i + \beta L^{-1} \theta_t .
\end{aligned}
\]</div>
<p>Solving the stable root backwards and the unstable root forwards gives</p>
<div class="math notranslate nohighlight">
\[
\begin{aligned}
k_{t+1}^i = \tilde \lambda k_t^i + {\tilde \lambda \beta \over 1 -\tilde
\lambda \beta L^{-1}}
(\epsilon_{t+1}^i + \theta_{t+1}  ) .
\end{aligned}
\]</div>
<p>Recall that we have already set <span class="math notranslate nohighlight">\(k^i = K^i\)</span> at the appropriate point in the argument, namely, <em>after</em> having derived the first-order necessary
conditions for a representative firm in industry <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>Thus,  under perfect foresight the equilibrium capital stock in industry <span class="math notranslate nohighlight">\(i\)</span> satisfies</p>
<div class="math notranslate nohighlight" id="equation-town5">
<span class="eqno">(34.10)<a class="headerlink" href="#equation-town5" title="Permalink to this equation">#</a></span>\[\begin{aligned}
  k_{t+1}^i = \tilde \lambda k_t^i + \sum_{j=1}^\infty (\tilde \lambda \beta)^j
  (\epsilon_{t+j}^i +  \theta_{t+j}) .
  \end{aligned}\]</div>
<p>Next, we shall investigate consequences of replacing future  values of
<span class="math notranslate nohighlight">\((\epsilon_{t+j}^i +  \theta_{t+j})\)</span> in equation <a class="reference internal" href="#equation-town5">(34.10)</a>  with alternative forecasting schemes.</p>
<p>In particular, we shall compute   equilibrium laws of motion for capital
under alternative assumptions about  information available to
firms in market <span class="math notranslate nohighlight">\(i\)</span>.</p>
</section>
</section>
<section id="equilibrium-with-theta-t-stochastic-but-observed-at-t">
<h2><span class="section-number">34.5. </span>Equilibrium with <span class="math notranslate nohighlight">\(\theta_t\)</span> stochastic but observed at <span class="math notranslate nohighlight">\(t\)</span><a class="headerlink" href="#equilibrium-with-theta-t-stochastic-but-observed-at-t" title="Permalink to this heading">#</a></h2>
<p>If future <span class="math notranslate nohighlight">\(\theta\)</span>’s are unknown at <span class="math notranslate nohighlight">\(t\)</span>, it is appropriate
to replace all random variables on the right side of
<a class="reference internal" href="#equation-town5">(34.10)</a> with their conditional expectations based on
the information available to decision makers in market <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>For now, we assume that this information set is
<span class="math notranslate nohighlight">\(I_t^p = \begin{bmatrix} \theta^t &amp; \epsilon^{it} \end{bmatrix}\)</span>,
where <span class="math notranslate nohighlight">\(z^t\)</span> represents the semi-infinite history of variable
<span class="math notranslate nohighlight">\(z_s\)</span> up to time <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>Later we shall give firms less information.</p>
<p>To obtain an appropriate counterpart to <a class="reference internal" href="#equation-town5">(34.10)</a> under our
current assumption about information, we apply a certainty equivalence
principle.</p>
<p>In particular, it is appropriate to take <a class="reference internal" href="#equation-town5">(34.10)</a> and
replace each term <span class="math notranslate nohighlight">\(( \epsilon_{t+j}^i+ \theta_{t+j} )\)</span> on the
right side with
<span class="math notranslate nohighlight">\(E[ (\epsilon_{t+j}^i+ \theta_{t+j}) \vert \theta^t ]\)</span>.</p>
<p>After using <a class="reference internal" href="#equation-town2a">(34.3)</a> and the i.i.d. assumption about
<span class="math notranslate nohighlight">\(\{\epsilon_t^i\}\)</span>, this gives</p>
<div class="math notranslate nohighlight">
\[
\begin{aligned}
k_{t+1}^i = \tilde \lambda k_t^i + {\tilde \lambda \beta \rho \over 1 -
\tilde \lambda \beta \rho }
\theta_t
\end{aligned}
\]</div>
<p>or</p>
<div class="math notranslate nohighlight" id="equation-solution1">
<span class="eqno">(34.11)<a class="headerlink" href="#equation-solution1" title="Permalink to this equation">#</a></span>\[\begin{aligned}
  k_{t+1}^i = \tilde \lambda k_t^i  + {\rho \over  \lambda - \rho} \theta_t
  \end{aligned}\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda \equiv (\beta \tilde \lambda)^{-1}\)</span>.</p>
<p>For our purposes, it is convenient to represent the equilibrium
<span class="math notranslate nohighlight">\(\{k_t^i\}_t\)</span> process recursively as</p>
<div class="math notranslate nohighlight" id="equation-sol10">
<span class="eqno">(34.12)<a class="headerlink" href="#equation-sol10" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{aligned}
  k_{t+1}^i  &amp; =  \tilde \lambda k_t^i  + {1 \over \lambda - \rho}
  \hat \theta_{t+1}  \\
  \hat \theta_{t+1}  &amp; =  \rho \theta_t \\
  \theta_{t+1} &amp; =  \rho \theta_t + v_t.   \end{aligned}\end{split}\]</div>
<section id="filtering">
<h3><span class="section-number">34.5.1. </span>Filtering<a class="headerlink" href="#filtering" title="Permalink to this heading">#</a></h3>
<section id="one-noisy-signal">
<h4><span class="section-number">34.5.1.1. </span>One noisy signal<a class="headerlink" href="#one-noisy-signal" title="Permalink to this heading">#</a></h4>
<p>We get closer to the original Townsend  model that interests us  by now
assuming that firms in market <span class="math notranslate nohighlight">\(i\)</span> do not observe <span class="math notranslate nohighlight">\(\theta_t\)</span>.</p>
<p>Instead they observe a history  <span class="math notranslate nohighlight">\(w^t\)</span> of noisy signals at time <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>In particular, assume that</p>
<div class="math notranslate nohighlight" id="equation-kf1-2">
<span class="eqno">(34.13)<a class="headerlink" href="#equation-kf1-2" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{aligned}
  w_t  &amp; =   \theta_t + e_t  \\
  \theta_{t+1} &amp; =  \rho \theta_t + v_t
  \end{aligned}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(e_t\)</span> and <span class="math notranslate nohighlight">\(v_t\)</span> are mutually independent
i.i.d. Gaussian shock processes with means of zero and variances
<span class="math notranslate nohighlight">\(\sigma_e^2\)</span> and <span class="math notranslate nohighlight">\(\sigma_v^2\)</span>, respectively.</p>
<p>Define</p>
<div class="math notranslate nohighlight">
\[
\begin{aligned}
\hat \theta_{t+1} = E(\theta_{t+1} | w^t)
\end{aligned}
\]</div>
<p>where <span class="math notranslate nohighlight">\(w^t = [w_t, w_{t-1}, \ldots, w_0]\)</span> denotes the history of the <span class="math notranslate nohighlight">\(w_s\)</span> process up to
and including <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>Associated with the  state-space representation
<a class="reference internal" href="#equation-kf1-2">(34.13)</a> is the time-invariant <em>innovations
representation</em></p>
<div class="math notranslate nohighlight" id="equation-kf3-4">
<span class="eqno">(34.14)<a class="headerlink" href="#equation-kf3-4" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{aligned}
  \hat \theta_{t+1}  &amp; =     \rho \hat \theta_t + \kappa a_t  \\
  w_t &amp; =  \hat \theta_t + a_t
  \end{aligned}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(a_t \equiv w_t - E(w_t | w^{t-1})\)</span> is the <em>innovations</em>
process in <span class="math notranslate nohighlight">\(w_t\)</span> and the Kalman gain <span class="math notranslate nohighlight">\(\kappa\)</span> is</p>
<div class="math notranslate nohighlight" id="equation-kal1">
<span class="eqno">(34.15)<a class="headerlink" href="#equation-kal1" title="Permalink to this equation">#</a></span>\[\begin{aligned}
  \kappa = {\rho p \over p + \sigma_e^2} \end{aligned}\]</div>
<p>and where <span class="math notranslate nohighlight">\(p\)</span> satisfies the Riccati equation</p>
<div class="math notranslate nohighlight" id="equation-kf6">
<span class="eqno">(34.16)<a class="headerlink" href="#equation-kf6" title="Permalink to this equation">#</a></span>\[\begin{aligned}
  p = \sigma_v^2   + { p \rho^2 \sigma_e^2 \over \sigma_e^2 + p}.
  \end{aligned}\]</div>
</section>
<section id="state-reconstruction-error">
<h4><span class="section-number">34.5.1.2. </span>State-reconstruction error<a class="headerlink" href="#state-reconstruction-error" title="Permalink to this heading">#</a></h4>
<p>Define the state <em>reconstruction error</em> <span class="math notranslate nohighlight">\(\tilde \theta_t\)</span> by</p>
<div class="math notranslate nohighlight">
\[
\begin{aligned}
\tilde \theta_t = \theta_t - \hat \theta_t .
\end{aligned}
\]</div>
<p>Then <span class="math notranslate nohighlight">\(p = E \tilde \theta_t^2\)</span>.</p>
<p>Equations <a class="reference internal" href="#equation-kf1-2">(34.13)</a> and <a class="reference internal" href="#equation-kf3-4">(34.14)</a> imply</p>
<div class="math notranslate nohighlight" id="equation-kf7">
<span class="eqno">(34.17)<a class="headerlink" href="#equation-kf7" title="Permalink to this equation">#</a></span>\[\begin{aligned}
  \tilde \theta_{t+1} = (\rho - \kappa) \tilde \theta_t + v_t - k e_t .
  \end{aligned}\]</div>
<p>Notice that we can express <span class="math notranslate nohighlight">\(\hat \theta_{t+1}\)</span> as</p>
<div class="math notranslate nohighlight" id="equation-kf8">
<span class="eqno">(34.18)<a class="headerlink" href="#equation-kf8" title="Permalink to this equation">#</a></span>\[\hat \theta_{t+1}   = [\rho \theta_t + v_t]  + [ \kappa e_t - (\rho -\kappa) \tilde \theta_t - v_t]  ,\]</div>
<p>where the first term in braces  equals
<span class="math notranslate nohighlight">\(\theta_{t+1}\)</span> and the second term in braces equals
<span class="math notranslate nohighlight">\(-\tilde \theta_{t+1}\)</span>.</p>
<p>We can express <a class="reference internal" href="#equation-solution1">(34.11)</a> as</p>
<div class="math notranslate nohighlight" id="equation-solution2">
<span class="eqno">(34.19)<a class="headerlink" href="#equation-solution2" title="Permalink to this equation">#</a></span>\[\begin{aligned}
  k_{t+1}^i = \tilde \lambda k_t^i + {1 \over \lambda - \rho}
  E \theta_{t+1} | \theta^t .
  \end{aligned}\]</div>
<p>An application of a certainty equivalence principle asserts that when
only <span class="math notranslate nohighlight">\(w^t\)</span> is observed, a corresponding equilibrium <span class="math notranslate nohighlight">\(\{k_t^i\}\)</span> process can be  found by
replacing the information set <span class="math notranslate nohighlight">\(\theta^t\)</span> with <span class="math notranslate nohighlight">\(w^t\)</span> in
<a class="reference internal" href="#equation-solution2">(34.19)</a>.</p>
<p>Making this substitution and using <a class="reference internal" href="#equation-kf8">(34.18)</a> leads to</p>
<div class="math notranslate nohighlight" id="equation-kf9">
<span class="eqno">(34.20)<a class="headerlink" href="#equation-kf9" title="Permalink to this equation">#</a></span>\[\begin{aligned}
  k_{t+1}^i   = \tilde \lambda k_t^i + {\rho \over  \lambda - \rho} \theta_t + {\kappa \over  \lambda - \rho} e_t  - {\rho - \kappa \over  \lambda - \rho} \tilde \theta_t .
  \end{aligned}\]</div>
<p>Simplifying equation <a class="reference internal" href="#equation-kf8">(34.18)</a>, we also have</p>
<div class="math notranslate nohighlight" id="equation-kf8a">
<span class="eqno">(34.21)<a class="headerlink" href="#equation-kf8a" title="Permalink to this equation">#</a></span>\[\begin{aligned}
  \hat \theta_{t+1}  = \rho \theta_t +  \kappa e_t - (\rho -\kappa) \tilde \theta_t  .
  \end{aligned}\]</div>
<p>Equations <a class="reference internal" href="#equation-kf9">(34.20)</a>, <a class="reference internal" href="#equation-kf8a">(34.21)</a> describe
an equilibrium when <span class="math notranslate nohighlight">\(w^t\)</span> is observed.</p>
</section>
</section>
<section id="a-new-state-variable">
<h3><span class="section-number">34.5.2. </span>A new state variable<a class="headerlink" href="#a-new-state-variable" title="Permalink to this heading">#</a></h3>
<p>Relative to <a class="reference internal" href="#equation-solution1">(34.11)</a>, the equilibrium acquires a <strong>new
state variable</strong>, namely, the <span class="math notranslate nohighlight">\(\theta\)</span>–reconstruction error,
<span class="math notranslate nohighlight">\(\tilde \theta_t\)</span>.</p>
<p>For a subsequent argument, by using <a class="reference internal" href="#equation-kal1">(34.15)</a>, it is convenient  to
write <a class="reference internal" href="#equation-kf9">(34.20)</a> as</p>
<div class="math notranslate nohighlight" id="equation-sol2a">
<span class="eqno">(34.22)<a class="headerlink" href="#equation-sol2a" title="Permalink to this equation">#</a></span>\[\begin{aligned}
  k_{t+1}^i = \tilde \lambda k_t^i + {\rho \over  \lambda - \rho } \theta_t + {1 \over  \lambda - \rho} {p \rho \over p + \sigma_e^2} e_t - {1 \over \lambda - \rho} {\rho \sigma_e^2 \over p + \sigma_e^2}
  \tilde \theta_t
  \end{aligned}\]</div>
<p>In summary, when decision makers in market <span class="math notranslate nohighlight">\(i\)</span> observe a semi-infinite history <span class="math notranslate nohighlight">\(w^t\)</span> of  noisy
signals <span class="math notranslate nohighlight">\(w_t\)</span> on <span class="math notranslate nohighlight">\(\theta_t\)</span> at <span class="math notranslate nohighlight">\(t\)</span>, we  an
equilibrium law of motion for <span class="math notranslate nohighlight">\(k_t^i\)</span> can be represented as</p>
<div class="math notranslate nohighlight" id="equation-sol0a">
<span class="eqno">(34.23)<a class="headerlink" href="#equation-sol0a" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{aligned}
k_{t+1}^i &amp; =  \tilde \lambda k_t^i + {1 \over \lambda - \rho}   \hat \theta_{t+1}  \\
\hat \theta_{t+1} &amp; =  \rho \theta_t + {\rho p \over p + \sigma_e^2} e_t - {\rho \sigma_e^2 \over p + \sigma_e^2} \tilde \theta_t  \\
\tilde \theta_{t+1} &amp; = { \rho \sigma_e^2 \over p + \sigma_e^2} \tilde
   \theta_t - {p \rho \over p + \sigma_e^2} e_t + v_t  \\
\theta_{t+1} &amp; =  \rho \theta_t + v_t .  \end{aligned}\end{split}\]</div>
</section>
<section id="two-noisy-signals">
<h3><span class="section-number">34.5.3. </span>Two Noisy Signals<a class="headerlink" href="#two-noisy-signals" title="Permalink to this heading">#</a></h3>
<p>We now construct a <strong>pooling equilibrium</strong> by assuming that at time <span class="math notranslate nohighlight">\(t\)</span> a firm in
industry <span class="math notranslate nohighlight">\(i\)</span> receives a vector <span class="math notranslate nohighlight">\(w_t\)</span> of <em>two</em> noisy signals
on <span class="math notranslate nohighlight">\(\theta_t\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\theta_{t+1} &amp; = \rho\theta_{t}+v_{t} \\
w_{t} &amp; = \begin{bmatrix}1 \\
1
\end{bmatrix}\theta_{t}+\begin{bmatrix}e_{1t} \\
e_{2t}
\end{bmatrix}
\end{aligned}
\end{split}\]</div>
<p>To justify that we are constructing is a <strong>pooling equilibrium</strong> we can
assume that</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\begin{bmatrix} e_{1t} \\ e_{2t}  \end{bmatrix} =
\begin{bmatrix} \epsilon_{t}^1 \\ \epsilon_{t}^2  \end{bmatrix}
\end{aligned}
\end{split}\]</div>
<p>so that a firm in industry <span class="math notranslate nohighlight">\(i\)</span> observes the noisy signals on that
<span class="math notranslate nohighlight">\(\theta_t\)</span> presented to firms in both industries <span class="math notranslate nohighlight">\(i\)</span> and
<span class="math notranslate nohighlight">\(-i\)</span>.</p>
<p>The pertinent  innovations representation now becomes</p>
<div class="math notranslate nohighlight" id="equation-kf22-23">
<span class="eqno">(34.24)<a class="headerlink" href="#equation-kf22-23" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{aligned}
  \hat \theta_{t+1} &amp; =   \rho
  \hat \theta_t + \kappa a_t  \\
  w_t  &amp; =  \begin{bmatrix} 1 \\ 1 \end{bmatrix} \hat \theta_t + a_t
 \end{aligned}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(a_t \equiv w_t - E [w_t | w^{t-1}]\)</span> is a
<span class="math notranslate nohighlight">\((2 \times 1)\)</span> vector of innovations in <span class="math notranslate nohighlight">\(w_t\)</span> and <span class="math notranslate nohighlight">\(\kappa\)</span>
is now a <span class="math notranslate nohighlight">\((1 \times 2)\)</span> vector of Kalman gains.</p>
<p>Formulas for the Kalman filter imply that</p>
<div class="math notranslate nohighlight" id="equation-kf24">
<span class="eqno">(34.25)<a class="headerlink" href="#equation-kf24" title="Permalink to this equation">#</a></span>\[\begin{aligned}
  \kappa ={ \rho  p \over 2 p + \sigma_e^2}
  \begin{bmatrix}1 &amp; 1 \end{bmatrix}
  \end{aligned}\]</div>
<p>where <span class="math notranslate nohighlight">\(p = E \tilde \theta_t \tilde \theta_t^T\)</span> now satisfies the
Riccati equation</p>
<div class="math notranslate nohighlight" id="equation-ricc2">
<span class="eqno">(34.26)<a class="headerlink" href="#equation-ricc2" title="Permalink to this equation">#</a></span>\[\begin{aligned}
  p = \sigma_v^2 + {p \rho^2 \sigma_e^2 \over 2 p + \sigma_e^2}.
  \end{aligned}\]</div>
<p>Thus, when a representative firm in industry <span class="math notranslate nohighlight">\(i\)</span> observes <em>two</em>
noisy signals on <span class="math notranslate nohighlight">\(\theta_t\)</span>, we can express the equilibrium law of
motion for capital recursively as</p>
<div class="math notranslate nohighlight" id="equation-sol3">
<span class="eqno">(34.27)<a class="headerlink" href="#equation-sol3" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{aligned}
k_{t+1}^i &amp; =  \tilde \lambda k_t^i + {1 \over \lambda - \rho}\hat \theta_{t+1}  \\
\hat \theta_{t+1} &amp; =  \rho \theta_t + {\rho p \over 2  p + \sigma_e^2} (e_{1t}+e_{2t}) - {\rho \sigma_e^2 \over 2 p + \sigma_e^2} \tilde \theta_t \\
\tilde \theta_{t+1} &amp; =  { \rho \sigma_e^2 \over 2 p + \sigma_e^2} \tilde  \theta_t - {p \rho \over 2 p + \sigma_e^2}(e_{1t}+e_{2t}) +v_t \\
\theta_{t+1} &amp; =  \rho \theta_t + v_t .
 \end{aligned}\end{split}\]</div>
<p>Below, by using a guess-and-verify tactic,  we shall show that outcomes in this  <strong>pooling equilibrium</strong> equal those in an equilibrium under the alternative
information structure that interested Townsend <span id="id16">[<a class="reference internal" href="zreferences.html#id28" title="Robert M. Townsend. Forecasting the forecasts of others. Journal of Political Economy, 91:546–588, 1983.">Townsend, 1983</a>]</span> but that originally seemed too challenging to compute. <a class="footnote-reference brackets" href="#footnote5" id="id17">4</a></p>
</section>
</section>
<section id="guess-and-verify-tactic">
<h2><span class="section-number">34.6. </span>Guess-and-Verify Tactic<a class="headerlink" href="#guess-and-verify-tactic" title="Permalink to this heading">#</a></h2>
<p>As a preliminary step we shall take our recursive representation <a class="reference internal" href="#equation-sol0a">(34.23)</a>
of an equilibrium in industry <span class="math notranslate nohighlight">\(i\)</span> with one noisy signal
on <span class="math notranslate nohighlight">\(\theta_t\)</span> and perform the following steps:</p>
<ul class="simple">
<li><p>Compute <span class="math notranslate nohighlight">\(\lambda\)</span> and <span class="math notranslate nohighlight">\(\tilde{\lambda}\)</span> by posing a
root-finding problem and  solving it with <code class="docutils literal notranslate"><span class="pre">numpy.roots</span></code></p></li>
<li><p>Compute <span class="math notranslate nohighlight">\(p\)</span> by forming the appropriate  discrete Riccati equation and then solving it
using <code class="docutils literal notranslate"><span class="pre">quantecon.solve_discrete_riccati</span></code></p></li>
<li><p>Add a <em>measurement equation</em> for
<span class="math notranslate nohighlight">\(P_t^i = b k_t^i + \theta_t + e_t\)</span>, <span class="math notranslate nohighlight">\(\theta_t + e_t\)</span>,
and <span class="math notranslate nohighlight">\(e_t\)</span> to system <a class="reference internal" href="#equation-sol0a">(34.23)</a>.</p></li>
<li><p>Write the resulting system
in state-space form and encode it using <code class="docutils literal notranslate"><span class="pre">quantecon.LinearStateSpace</span></code></p></li>
<li><p>Use methods of the <code class="docutils literal notranslate"><span class="pre">quantecon.LinearStateSpace</span></code> to compute impulse response
functions of <span class="math notranslate nohighlight">\(k_t^i\)</span> with respect to shocks <span class="math notranslate nohighlight">\(v_t, e_t\)</span>.</p></li>
</ul>
<p>After analyzing the one-noisy-signal structure in this way,  by making appropriate modifications
we shall analyze the two-noisy-signal
structure.</p>
<p>We proceed to analyze first the one-noisy-signal structure and then the two-noisy-signal structure.</p>
</section>
<section id="equilibrium-with-one-noisy-signal-on-theta-t">
<h2><span class="section-number">34.7. </span>Equilibrium with One Noisy Signal on <span class="math notranslate nohighlight">\(\theta_t\)</span><a class="headerlink" href="#equilibrium-with-one-noisy-signal-on-theta-t" title="Permalink to this heading">#</a></h2>
<section id="step-1-solve-for-tilde-lambda-and-lambda">
<h3><span class="section-number">34.7.1. </span>Step 1: Solve for <span class="math notranslate nohighlight">\(\tilde{\lambda}\)</span> and <span class="math notranslate nohighlight">\(\lambda\)</span><a class="headerlink" href="#step-1-solve-for-tilde-lambda-and-lambda" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Cast
<span class="math notranslate nohighlight">\(\left(\lambda-1\right)\left(\lambda-\frac{1}{\beta}\right)=b\lambda\)</span>
as <span class="math notranslate nohighlight">\(p\left(\lambda\right)=0\)</span> where <span class="math notranslate nohighlight">\(p\)</span> is a polynomial
function of <span class="math notranslate nohighlight">\(\lambda\)</span>.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">numpy.roots</span></code> to solve for the roots of <span class="math notranslate nohighlight">\(p\)</span></p></li>
<li><p>Verify <span class="math notranslate nohighlight">\(\lambda \approx \frac{1}{\beta\tilde{\lambda}}\)</span></p></li>
</ol>
<p>Note that
<span class="math notranslate nohighlight">\(p\left(\lambda\right)=\lambda^{2}-\left(1+b+\frac{1}{\beta}\right)\lambda+\frac{1}{\beta}\)</span>.</p>
</section>
<section id="step-2-solve-for-p">
<h3><span class="section-number">34.7.2. </span>Step 2: Solve for <span class="math notranslate nohighlight">\(p\)</span><a class="headerlink" href="#step-2-solve-for-p" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Cast
<span class="math notranslate nohighlight">\(p=\sigma_{v}^{2}+\frac{p\rho^{2}\sigma_{e}^{2}}{2p+\sigma_{e}^{2}}\)</span>
as a discrete matrix Riccati equation.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">quantecon.solve_discrete_riccati</span></code> to solve for <span class="math notranslate nohighlight">\(p\)</span></p></li>
<li><p>Verify
<span class="math notranslate nohighlight">\(p \approx\sigma_{v}^{2}+\frac{p\rho^{2}\sigma_{e}^{2}}{2p+\sigma_{e}^{2}}\)</span></p></li>
</ol>
<p>Note that:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
   A &amp; = &amp; \left[\begin{array}{c}
   \rho\end{array}\right]\\
   B &amp; = &amp; \left[\begin{array}{c}
   \sqrt{2}\end{array}\right]\\
   R &amp; = &amp; \left[\begin{array}{c}
   \sigma_{e}^{2}\end{array}\right]\\
   Q &amp; = &amp; \left[\begin{array}{c}
   \sigma_{v}^{2}\end{array}\right]\\
   N &amp; = &amp; \left[\begin{array}{c}
   0\end{array}\right]
\end{aligned}
\end{split}\]</div>
</section>
<section id="step-3-represent-the-system-using-quantecon-linearstatespace">
<h3><span class="section-number">34.7.3. </span>Step 3: Represent the system using <code class="docutils literal notranslate"><span class="pre">quantecon.LinearStateSpace</span></code><a class="headerlink" href="#step-3-represent-the-system-using-quantecon-linearstatespace" title="Permalink to this heading">#</a></h3>
<p>We use the following representation for constructing the
<code class="docutils literal notranslate"><span class="pre">quantecon.LinearStateSpace</span></code> instance.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\underbrace{\left[\begin{array}{c}
e_{t+1}\\
k_{t+1}^{i}\\
\tilde{\theta}_{t+1}\\
P_{t+1}\\
\theta_{t+1}\\
v_{t+1}
\end{array}\right]}_{x_{t+1}} &amp; =  \underbrace{\left[\begin{array}{cccccc}
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
\frac{\kappa}{\lambda-\rho} &amp; \tilde{\lambda} &amp; \frac{-1}{\lambda-\rho}\frac{\kappa\sigma_{e}^{2}}{p} &amp; 0 &amp; \frac{\rho}{\lambda-\rho} &amp; 0\\
-\kappa &amp; 0 &amp; \frac{\kappa\sigma_{e}^{2}}{p} &amp; 0 &amp; 0 &amp; 1\\
\frac{b\kappa}{\lambda-\rho} &amp; b\tilde{\lambda} &amp; \frac{-b}{\lambda-\rho}\frac{\kappa\sigma_{e}^{2}}{p} &amp; 0 &amp; \frac{b\rho}{\lambda-\rho}+\rho &amp; 1\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \rho &amp; 1\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0
\end{array}\right]}_{A}\underbrace{\left[\begin{array}{c}
e_{t}\\
k_{t}^{i}\\
\tilde{\theta}_{t}\\
P_{t}\\
\theta_{t}\\
v_{t}
\end{array}\right]}_{x_{t}}+\underbrace{\left[\begin{array}{cc}
\sigma_{e} &amp; 0\\
0 &amp; 0\\
0 &amp; 0\\
\sigma_{e} &amp; 0\\
0 &amp; 0\\
0 &amp; \sigma_{v}
\end{array}\right]}_{C}\left[\begin{array}{c}
z_{1,t+1}\\
z_{2,t+1}
\end{array}\right]\\
\underbrace{\left[\begin{array}{c}
P_{t}\\
e_{t}+\theta_{t}\\
e_{t}
\end{array}\right]}_{y_{t}} &amp; = \underbrace{\left[\begin{array}{cccccc}
0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0\\
1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0\\
1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0
\end{array}\right]}_{G}\underbrace{\left[\begin{array}{c}
e_{t}\\
k_{t}^{i}\\
\tilde{\theta}_{t}\\
P_{t}\\
\theta_{t}\\
v_{t}
\end{array}\right]}_{x_{t}}+\underbrace{\left[\begin{array}{c}
0\\
0\\
0
\end{array}\right]}_{H}w_{t+1}\\
\left[\begin{array}{c}
z_{1,t+1}\\
z_{2,t+1}\\
w_{t+1}
\end{array}\right] &amp; \sim \mathcal{N}\left(0,I\right)\\
\kappa &amp; = \frac{\rho p}{p+\sigma_{e}^{2}}
\end{aligned}
\end{split}\]</div>
<p>This representation includes extraneous variables  such as <span class="math notranslate nohighlight">\(P_{t}\)</span> in the
state vector.</p>
<p>We formulate things in this way because
it allows us easily to compute covariances of these variables with other
components of the state vector (step 5 above) by using the <code class="docutils literal notranslate"><span class="pre">stationary_distributions</span></code> method of the <code class="docutils literal notranslate"><span class="pre">LinearStateSpace</span></code> class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">quantecon</span> <span class="k">as</span> <span class="nn">qe</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">plotly.offline</span> <span class="k">as</span> <span class="nn">pyo</span>
<span class="kn">from</span> <span class="nn">statsmodels.regression.linear_model</span> <span class="kn">import</span> <span class="n">OLS</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">Latex</span><span class="p">,</span> <span class="n">Image</span>

<span class="n">pyo</span><span class="o">.</span><span class="n">init_notebook_mode</span><span class="p">(</span><span class="n">connected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <script type="text/javascript">
        window.PlotlyConfig = {MathJaxConfig: 'local'};
        if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
        if (typeof require !== 'undefined') {
        require.undef("plotly");
        requirejs.config({
            paths: {
                'plotly': ['https://cdn.plot.ly/plotly-2.35.2.min']
            }
        });
        require(['plotly'], function(Plotly) {
            window._Plotly = Plotly;
        });
        }
        </script>
        </div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">β</span> <span class="o">=</span> <span class="mf">0.9</span>  <span class="c1"># Discount factor</span>
<span class="n">ρ</span> <span class="o">=</span> <span class="mf">0.8</span>  <span class="c1"># Persistence parameter for the hidden state</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">1.5</span>  <span class="c1"># Demand curve parameter</span>
<span class="n">σ_v</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># Standard deviation of shock to θ_t</span>
<span class="n">σ_e</span> <span class="o">=</span> <span class="mf">0.6</span>  <span class="c1"># Standard deviation of shocks to w_t</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute λ</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">β</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="n">β</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">β</span><span class="p">])</span>
<span class="n">roots_poly</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
<span class="n">λ_tilde</span> <span class="o">=</span> <span class="n">roots_poly</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">λ</span> <span class="o">=</span> <span class="n">roots_poly</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Verify that λ = (βλ_tilde) ^ (-1)</span>
<span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-12</span>
<span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">λ</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">β</span> <span class="o">*</span> <span class="n">λ_tilde</span><span class="p">)))</span> <span class="o">&lt;</span> <span class="n">tol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_ricc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">ρ</span><span class="p">]])</span>
<span class="n">B_ricc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">]])</span>
<span class="n">R_ricc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">σ_e</span> <span class="o">**</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">Q_ricc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">σ_v</span> <span class="o">**</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">N_ricc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">qe</span><span class="o">.</span><span class="n">solve_discrete_riccati</span><span class="p">(</span><span class="n">A_ricc</span><span class="p">,</span> <span class="n">B_ricc</span><span class="p">,</span> <span class="n">Q_ricc</span><span class="p">,</span> <span class="n">R_ricc</span><span class="p">,</span> <span class="n">N_ricc</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

<span class="n">p_one</span> <span class="o">=</span> <span class="n">p</span>  <span class="c1"># Save for comparison later</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Verify that p = σ_v ^ 2 + p * ρ ^ 2 - (ρ * p) ^ 2 / (p + σ_e ** 2)</span>
<span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-12</span>
<span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="p">(</span><span class="n">σ_v</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">p</span> <span class="o">*</span> <span class="n">ρ</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">ρ</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">σ_e</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span> <span class="o">&lt;</span> <span class="n">tol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">κ</span> <span class="o">=</span> <span class="n">ρ</span> <span class="o">*</span> <span class="n">p</span> <span class="o">/</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">σ_e</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">κ_prod</span> <span class="o">=</span> <span class="n">κ</span> <span class="o">*</span> <span class="n">σ_e</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">p</span>

<span class="n">κ_one</span> <span class="o">=</span> <span class="n">κ</span>  <span class="c1"># Save for comparison later</span>

<span class="n">A_lss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="n">κ</span> <span class="o">/</span> <span class="p">(</span><span class="n">λ</span> <span class="o">-</span> <span class="n">ρ</span><span class="p">),</span> <span class="n">λ_tilde</span><span class="p">,</span> <span class="o">-</span><span class="n">κ_prod</span> <span class="o">/</span> <span class="p">(</span><span class="n">λ</span> <span class="o">-</span> <span class="n">ρ</span><span class="p">),</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">ρ</span> <span class="o">/</span> <span class="p">(</span><span class="n">λ</span> <span class="o">-</span> <span class="n">ρ</span><span class="p">),</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="o">-</span><span class="n">κ</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">κ_prod</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
                 <span class="p">[</span><span class="n">b</span> <span class="o">*</span> <span class="n">κ</span> <span class="o">/</span> <span class="p">(</span><span class="n">λ</span> <span class="o">-</span> <span class="n">ρ</span><span class="p">)</span> <span class="p">,</span> <span class="n">b</span> <span class="o">*</span> <span class="n">λ_tilde</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span> <span class="o">*</span> <span class="n">κ_prod</span> <span class="o">/</span> <span class="p">(</span><span class="n">λ</span> <span class="o">-</span> <span class="n">ρ</span><span class="p">),</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">b</span> <span class="o">*</span> <span class="n">ρ</span> <span class="o">/</span> <span class="p">(</span><span class="n">λ</span> <span class="o">-</span> <span class="n">ρ</span><span class="p">)</span> <span class="o">+</span> <span class="n">ρ</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">ρ</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>

<span class="n">C_lss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">σ_e</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="n">σ_e</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">σ_v</span><span class="p">]])</span>

<span class="n">G_lss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>

<span class="n">lss</span> <span class="o">=</span> <span class="n">qe</span><span class="o">.</span><span class="n">LinearStateSpace</span><span class="p">(</span><span class="n">A_lss</span><span class="p">,</span> <span class="n">C_lss</span><span class="p">,</span> <span class="n">G_lss</span><span class="p">,</span> <span class="n">mu_0</span><span class="o">=</span><span class="n">mu_0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts_length</span> <span class="o">=</span> <span class="mi">100_000</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">lss</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">ts_length</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Verify that two ways of computing P_t match</span>
<span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span> <span class="o">@</span> <span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span> <span class="o">&lt;</span> <span class="mf">1e-12</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-4-compute-impulse-response-functions">
<h3><span class="section-number">34.7.4. </span>Step 4: Compute impulse response functions<a class="headerlink" href="#step-4-compute-impulse-response-functions" title="Permalink to this heading">#</a></h3>
<p>To compute impulse response functions of <span class="math notranslate nohighlight">\(k_t^i\)</span>, we use the <code class="docutils literal notranslate"><span class="pre">impulse_response</span></code> method of the
<code class="docutils literal notranslate"><span class="pre">quantecon.LinearStateSpace</span></code> class and plot outcomes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xcoef</span><span class="p">,</span> <span class="n">ycoef</span> <span class="o">=</span> <span class="n">lss</span><span class="o">.</span><span class="n">impulse_response</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xcoef</span><span class="p">])[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$e_{t+1}$&#39;</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$v_{t+1}$&#39;</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Impulse Response Function&#39;</span><span class="p">,</span>
                   <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span>
                   <span class="n">yaxis_title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$k^</span><span class="si">{i}</span><span class="s1">_</span><span class="si">{t}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">fig1</span> <span class="o">=</span> <span class="n">fig</span>
<span class="c1"># Export to PNG file</span>
<span class="n">Image</span><span class="p">(</span><span class="n">fig1</span><span class="o">.</span><span class="n">to_image</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">))</span>
<span class="c1"># fig1.show() will provide interactive plot when running</span>
<span class="c1"># notebook locally</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a61874fd4e09414f696c723d0b61506f1ccafe49fefda60e25c064ea7fa6a013.png" src="_images/a61874fd4e09414f696c723d0b61506f1ccafe49fefda60e25c064ea7fa6a013.png" />
</div>
</div>
</section>
<section id="step-5-compute-stationary-covariance-matrices-and-population-regressions">
<h3><span class="section-number">34.7.5. </span>Step 5: Compute stationary covariance matrices and population regressions<a class="headerlink" href="#step-5-compute-stationary-covariance-matrices-and-population-regressions" title="Permalink to this heading">#</a></h3>
<p>We compute stationary covariance matrices  by
calling the <code class="docutils literal notranslate"><span class="pre">stationary_distributions</span></code> method of
the <code class="docutils literal notranslate"><span class="pre">quantecon.LinearStateSpace</span></code> class.</p>
<p>By appropriately decomposing the covariance matrix of the state vector, we obtain ingredients
of pertinent population regression coefficients.</p>
<p>Define</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\Sigma_{x}=\left[\begin{array}{cc}
\Sigma_{11} &amp; \Sigma_{12}\\
\Sigma_{21} &amp; \Sigma_{22}
\end{array}\right]
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Sigma_{11}\)</span> is the covariance matrix of dependent variables and <span class="math notranslate nohighlight">\(\Sigma_{22}\)</span> is the covariance matrix of independent variables.</p>
<p>Regression coefficients are  <span class="math notranslate nohighlight">\(\beta=\Sigma_{21}\Sigma_{22}^{-1}\)</span>.</p>
<p>To verify an instance of a law of large numbers computation, we construct a long  simulation of
the state vector and for the resulting sample compute
the ordinary least-squares estimator  of <span class="math notranslate nohighlight">\(\beta\)</span> that we shall compare with corresponding population regression
coefficients.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">Σ_x</span><span class="p">,</span> <span class="n">Σ_y</span><span class="p">,</span> <span class="n">Σ_yx</span> <span class="o">=</span> <span class="n">lss</span><span class="o">.</span><span class="n">stationary_distributions</span><span class="p">()</span>

<span class="n">Σ_11</span> <span class="o">=</span> <span class="n">Σ_x</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">Σ_12</span> <span class="o">=</span> <span class="n">Σ_x</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
<span class="n">Σ_21</span> <span class="o">=</span> <span class="n">Σ_x</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">Σ_22</span> <span class="o">=</span> <span class="n">Σ_x</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>

<span class="n">reg_coeffs</span> <span class="o">=</span> <span class="n">Σ_12</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">Σ_22</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Regression coefficients (e_t on k_t, P_t, </span><span class="se">\\</span><span class="s1">tilde{</span><span class="se">\\</span><span class="s1">theta_t})&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;k_t:&#39;</span><span class="p">,</span> <span class="n">reg_coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\tilde{\theta_t}:&#39;</span><span class="p">,</span> <span class="n">reg_coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;P_t:&#39;</span><span class="p">,</span> <span class="n">reg_coeffs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Regression coefficients (e_t on k_t, P_t, \tilde{\theta_t})
------------------------------
k_t: -3.275556845219769
\tilde{\theta_t}: -0.9649461170475457
P_t: 0.9649461170475457
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute R squared</span>
<span class="n">R_squared</span> <span class="o">=</span> <span class="n">reg_coeffs</span> <span class="o">@</span> <span class="n">Σ_x</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">@</span> <span class="n">reg_coeffs</span>  <span class="o">/</span> <span class="n">Σ_x</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">R_squared</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9649461170475461
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Verify that the computed coefficients are close to least squares estimates</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">OLS</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">reg_res</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">reg_coeffs</span> <span class="o">-</span> <span class="n">reg_res</span><span class="o">.</span><span class="n">params</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">1e-2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Verify that R_squared matches least squares estimate</span>
<span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">reg_res</span><span class="o">.</span><span class="n">rsquared</span> <span class="o">-</span> <span class="n">R_squared</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Verify that θ_t + e_t can be recovered</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">reg_res</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">reg_res</span><span class="o">.</span><span class="n">rsquared</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="equilibrium-with-two-noisy-signals-on-theta-t">
<h2><span class="section-number">34.8. </span>Equilibrium with Two Noisy Signals on <span class="math notranslate nohighlight">\(\theta_t\)</span><a class="headerlink" href="#equilibrium-with-two-noisy-signals-on-theta-t" title="Permalink to this heading">#</a></h2>
<p>Steps 1, 4, and 5 are identical to those for the  one-noisy-signal structure.</p>
<p>Step 2  requires a straightforward modification.</p>
<p>For step 3, we  construct the  following state-space representation so that we can get our hands on
all of the random processes that we require in order  to compute a regression of the noisy signal about
<span class="math notranslate nohighlight">\(\theta\)</span> from the other industry that a firm receives directly in a pooling equilibrium against information that
a firm would receive in Townsend’s original model.</p>
<p>For this purpose, we include  equilibrium goods prices from  both industries in the state vector:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\underbrace{\left[\begin{array}{c}
e_{1,t+1}\\
e_{2,t+1}\\
k_{t+1}^{i}\\
\tilde{\theta}_{t+1}\\
P_{t+1}^{1}\\
P_{t+1}^{2}\\
\theta_{t+1}\\
v_{t+1}
\end{array}\right]}_{x_{t+1}} &amp; = \underbrace{\left[\begin{array}{cccccccc}
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
\frac{\kappa}{\lambda-\rho} &amp; \frac{\kappa}{\lambda-\rho} &amp; \tilde{\lambda} &amp; \frac{-1}{\lambda-\rho}\frac{\kappa\sigma_{e}^{2}}{p} &amp; 0 &amp; 0 &amp; \frac{\rho}{\lambda-\rho} &amp; 0\\
-\kappa &amp; -\kappa &amp; 0 &amp; \frac{\kappa\sigma_{e}^{2}}{p} &amp; 0 &amp; 0 &amp; 0 &amp; 1\\
\frac{b\kappa}{\lambda-\rho} &amp; \frac{b\kappa}{\lambda-\rho} &amp; b\tilde{\lambda} &amp; \frac{-b}{\lambda-\rho}\frac{\kappa\sigma_{e}^{2}}{p} &amp; 0 &amp; 0 &amp; \frac{b\rho}{\lambda-\rho}+\rho &amp; 1\\
\frac{b\kappa}{\lambda-\rho} &amp; \frac{b\kappa}{\lambda-\rho} &amp; b\tilde{\lambda} &amp; \frac{-b}{\lambda-\rho}\frac{\kappa\sigma_{e}^{2}}{p} &amp; 0 &amp; 0 &amp; \frac{b\rho}{\lambda-\rho}+\rho &amp; 1\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \rho &amp; 1\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0
\end{array}\right]}_{A}\underbrace{\left[\begin{array}{c}
e_{1,t}\\
e_{2,t}\\
k_{t}^{i}\\
\tilde{\theta}_{t}\\
P_{t}^{1}\\
P_{t}^{2}\\
\theta_{t}\\
v_{t}
\end{array}\right]}_{x_{t}}+\underbrace{\left[\begin{array}{ccc}
\sigma_{e} &amp; 0 &amp; 0\\
0 &amp; \sigma_{e} &amp; 0\\
0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0\\
\sigma_{e} &amp; 0 &amp; 0\\
0 &amp; \sigma_{e} &amp; 0\\
0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; \sigma_{v}
\end{array}\right]}_{C}\left[\begin{array}{c}
z_{1,t+1}\\
z_{2,t+1}\\
z_{3,t+1}
\end{array}\right]\\
\underbrace{\left[\begin{array}{c}
P_{t}^{1}\\
P_{t}^{2}\\
e_{1,t}+\theta_{t}\\
e_{2,t}+\theta_{t}\\
e_{1,t}\\
e_{2,t}
\end{array}\right]}_{y_{t}} &amp; = \underbrace{\left[\begin{array}{cccccccc}
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0\\
1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0\\
0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0\\
1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0
\end{array}\right]}_{G}\underbrace{\left[\begin{array}{c}
e_{1,t}\\
e_{2,t}\\
k_{t}^{i}\\
\tilde{\theta}_{t}\\
P_{t}^{1}\\
P_{t}^{2}\\
\theta_{t}\\
v_{t}
\end{array}\right]}_{x_{t}}+\underbrace{\left[\begin{array}{c}
0\\
0\\
0\\
0\\
0\\
0
\end{array}\right]}_{H}w_{t+1}\\
\left[\begin{array}{c}
z_{1,t+1}\\
z_{2,t+1}\\
z_{3,t+1}\\
w_{t+1}
\end{array}\right] &amp; \sim \mathcal{N}\left(0,I\right)\\
\kappa &amp; = \frac{\rho p}{2p+\sigma_{e}^{2}}
\end{aligned}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_ricc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">ρ</span><span class="p">]])</span>
<span class="n">B_ricc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)]])</span>
<span class="n">R_ricc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">σ_e</span> <span class="o">**</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">Q_ricc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">σ_v</span> <span class="o">**</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">N_ricc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">qe</span><span class="o">.</span><span class="n">solve_discrete_riccati</span><span class="p">(</span><span class="n">A_ricc</span><span class="p">,</span> <span class="n">B_ricc</span><span class="p">,</span> <span class="n">Q_ricc</span><span class="p">,</span> <span class="n">R_ricc</span><span class="p">,</span> <span class="n">N_ricc</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

<span class="n">p_two</span> <span class="o">=</span> <span class="n">p</span>  <span class="c1"># Save for comparison later</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Verify that p = σ_v^2 + (pρ^2σ_e^2) / (2p + σ_e^2)</span>
<span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-12</span>
<span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="p">(</span><span class="n">σ_v</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">p</span> <span class="o">*</span> <span class="n">ρ</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">σ_e</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span> <span class="o">+</span> <span class="n">σ_e</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span> <span class="o">&lt;</span> <span class="n">tol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">κ</span> <span class="o">=</span> <span class="n">ρ</span> <span class="o">*</span> <span class="n">p</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span> <span class="o">+</span> <span class="n">σ_e</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">κ_prod</span> <span class="o">=</span> <span class="n">κ</span> <span class="o">*</span> <span class="n">σ_e</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">p</span>

<span class="n">κ_two</span> <span class="o">=</span> <span class="n">κ</span>  <span class="c1"># Save for comparison later</span>

<span class="n">A_lss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="n">κ</span> <span class="o">/</span> <span class="p">(</span><span class="n">λ</span> <span class="o">-</span> <span class="n">ρ</span><span class="p">),</span> <span class="n">κ</span> <span class="o">/</span> <span class="p">(</span><span class="n">λ</span> <span class="o">-</span> <span class="n">ρ</span><span class="p">),</span> <span class="n">λ_tilde</span><span class="p">,</span> <span class="o">-</span><span class="n">κ_prod</span> <span class="o">/</span> <span class="p">(</span><span class="n">λ</span> <span class="o">-</span> <span class="n">ρ</span><span class="p">),</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">ρ</span> <span class="o">/</span> <span class="p">(</span><span class="n">λ</span> <span class="o">-</span> <span class="n">ρ</span><span class="p">),</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="o">-</span><span class="n">κ</span><span class="p">,</span> <span class="o">-</span><span class="n">κ</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">κ_prod</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
                 <span class="p">[</span><span class="n">b</span> <span class="o">*</span> <span class="n">κ</span> <span class="o">/</span> <span class="p">(</span><span class="n">λ</span> <span class="o">-</span> <span class="n">ρ</span><span class="p">),</span> <span class="n">b</span> <span class="o">*</span> <span class="n">κ</span> <span class="o">/</span> <span class="p">(</span><span class="n">λ</span> <span class="o">-</span> <span class="n">ρ</span><span class="p">),</span> <span class="n">b</span> <span class="o">*</span> <span class="n">λ_tilde</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span> <span class="o">*</span> <span class="n">κ_prod</span> <span class="o">/</span> <span class="p">(</span><span class="n">λ</span> <span class="o">-</span> <span class="n">ρ</span><span class="p">),</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">b</span> <span class="o">*</span> <span class="n">ρ</span> <span class="o">/</span> <span class="p">(</span><span class="n">λ</span> <span class="o">-</span> <span class="n">ρ</span><span class="p">)</span> <span class="o">+</span> <span class="n">ρ</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
                 <span class="p">[</span><span class="n">b</span> <span class="o">*</span> <span class="n">κ</span> <span class="o">/</span> <span class="p">(</span><span class="n">λ</span> <span class="o">-</span> <span class="n">ρ</span><span class="p">),</span> <span class="n">b</span> <span class="o">*</span> <span class="n">κ</span> <span class="o">/</span> <span class="p">(</span><span class="n">λ</span> <span class="o">-</span> <span class="n">ρ</span><span class="p">),</span> <span class="n">b</span> <span class="o">*</span> <span class="n">λ_tilde</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span> <span class="o">*</span> <span class="n">κ_prod</span> <span class="o">/</span> <span class="p">(</span><span class="n">λ</span> <span class="o">-</span> <span class="n">ρ</span><span class="p">),</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">b</span> <span class="o">*</span> <span class="n">ρ</span> <span class="o">/</span> <span class="p">(</span><span class="n">λ</span> <span class="o">-</span> <span class="n">ρ</span><span class="p">)</span> <span class="o">+</span> <span class="n">ρ</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">ρ</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>

<span class="n">C_lss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">σ_e</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">σ_e</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="n">σ_e</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">σ_e</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">σ_v</span><span class="p">]])</span>

<span class="n">G_lss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>

<span class="n">lss</span> <span class="o">=</span> <span class="n">qe</span><span class="o">.</span><span class="n">LinearStateSpace</span><span class="p">(</span><span class="n">A_lss</span><span class="p">,</span> <span class="n">C_lss</span><span class="p">,</span> <span class="n">G_lss</span><span class="p">,</span> <span class="n">mu_0</span><span class="o">=</span><span class="n">mu_0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts_length</span> <span class="o">=</span> <span class="mi">100_000</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">lss</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">ts_length</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xcoef</span><span class="p">,</span> <span class="n">ycoef</span> <span class="o">=</span> <span class="n">lss</span><span class="o">.</span><span class="n">impulse_response</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xcoef</span><span class="p">])[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$e_{1,t+1}$&#39;</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$e_{2,t+1}$&#39;</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$v_{t+1}$&#39;</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Impulse Response Function&#39;</span><span class="p">,</span>
                   <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span>
                   <span class="n">yaxis_title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$k^</span><span class="si">{i}</span><span class="s1">_</span><span class="si">{t}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">fig2</span><span class="o">=</span><span class="n">fig</span>
<span class="c1"># Export to PNG file</span>
<span class="n">Image</span><span class="p">(</span><span class="n">fig2</span><span class="o">.</span><span class="n">to_image</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">))</span>
<span class="c1"># fig2.show() will provide interactive plot when running</span>
<span class="c1"># notebook locally</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01d032b8af9cc8d3460d8b700bcb8db5a9c3acc47be5b10e7adac0cc844cc081.png" src="_images/01d032b8af9cc8d3460d8b700bcb8db5a9c3acc47be5b10e7adac0cc844cc081.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">Σ_x</span><span class="p">,</span> <span class="n">Σ_y</span><span class="p">,</span> <span class="n">Σ_yx</span> <span class="o">=</span> <span class="n">lss</span><span class="o">.</span><span class="n">stationary_distributions</span><span class="p">()</span>

<span class="n">Σ_11</span> <span class="o">=</span> <span class="n">Σ_x</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">Σ_12</span> <span class="o">=</span> <span class="n">Σ_x</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="n">Σ_21</span> <span class="o">=</span> <span class="n">Σ_x</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">Σ_22</span> <span class="o">=</span> <span class="n">Σ_x</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>

<span class="n">reg_coeffs</span> <span class="o">=</span> <span class="n">Σ_12</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">Σ_22</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Regression coefficients (e_{2,t} on k_t, P^</span><span class="si">{1}</span><span class="s1">_t, </span><span class="se">\\</span><span class="s1">tilde{</span><span class="se">\\</span><span class="s1">theta_t})&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;k_t:&#39;</span><span class="p">,</span> <span class="n">reg_coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\tilde{\theta_t}:&#39;</span><span class="p">,</span> <span class="n">reg_coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;P_t:&#39;</span><span class="p">,</span> <span class="n">reg_coeffs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Regression coefficients (e_{2,t} on k_t, P^{1}_t, \tilde{\theta_t})
------------------------------
k_t: 0.0
\tilde{\theta_t}: 0.0
P_t: 0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute R squared</span>
<span class="n">R_squared</span> <span class="o">=</span> <span class="n">reg_coeffs</span> <span class="o">@</span> <span class="n">Σ_x</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="o">@</span> <span class="n">reg_coeffs</span>  <span class="o">/</span> <span class="n">Σ_x</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">R_squared</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Verify that the computed coefficients are close to least squares estimates</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">OLS</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">reg_res</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">reg_coeffs</span> <span class="o">-</span> <span class="n">reg_res</span><span class="o">.</span><span class="n">params</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">1e-2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Verify that R_squared matches least squares estimate</span>
<span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">reg_res</span><span class="o">.</span><span class="n">rsquared</span> <span class="o">-</span> <span class="n">R_squared</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">Σ_x</span><span class="p">,</span> <span class="n">Σ_y</span><span class="p">,</span> <span class="n">Σ_yx</span> <span class="o">=</span> <span class="n">lss</span><span class="o">.</span><span class="n">stationary_distributions</span><span class="p">()</span>

<span class="n">Σ_11</span> <span class="o">=</span> <span class="n">Σ_x</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">Σ_12</span> <span class="o">=</span> <span class="n">Σ_x</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
<span class="n">Σ_21</span> <span class="o">=</span> <span class="n">Σ_x</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">Σ_22</span> <span class="o">=</span> <span class="n">Σ_x</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>

<span class="n">reg_coeffs</span> <span class="o">=</span> <span class="n">Σ_12</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">Σ_22</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Regression coefficients (e_{2,t} on k_t, P^</span><span class="si">{1}</span><span class="s1">_t, P^</span><span class="si">{2}</span><span class="s1">_t, </span><span class="se">\\</span><span class="s1">tilde{</span><span class="se">\\</span><span class="s1">theta_t})&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;k_t:&#39;</span><span class="p">,</span> <span class="n">reg_coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\tilde{\theta_t}:&#39;</span><span class="p">,</span> <span class="n">reg_coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;P^</span><span class="si">{1}</span><span class="s1">_t:&#39;</span><span class="p">,</span> <span class="n">reg_coeffs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;P^</span><span class="si">{2}</span><span class="s1">_t:&#39;</span><span class="p">,</span> <span class="n">reg_coeffs</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Regression coefficients (e_{2,t} on k_t, P^{1}_t, P^{2}_t, \tilde{\theta_t})
------------------------------
k_t: -3.1373589171035627
\tilde{\theta_t}: -0.9242343967443672
P^{1}_t: -0.037882801627816154
P^{2}_t: 0.9621171983721835
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute R squared</span>
<span class="n">R_squared</span> <span class="o">=</span> <span class="n">reg_coeffs</span> <span class="o">@</span> <span class="n">Σ_x</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">@</span> <span class="n">reg_coeffs</span>  <span class="o">/</span> <span class="n">Σ_x</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">R_squared</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9621171983721837
</pre></div>
</div>
</div>
</div>
</section>
<section id="key-step">
<h2><span class="section-number">34.9. </span>Key Step<a class="headerlink" href="#key-step" title="Permalink to this heading">#</a></h2>
<p>Now we come to the key step for verifying that equilibrium outcomes for prices and quantities are identical
in the pooling equilibrium  original model that led Townsend to deduce an infinite-dimensional state space.</p>
<p>We accomplish this by  computing a population linear least squares regression of the noisy signal that firms in the other
industry receive in a pooling equilibrium on  time <span class="math notranslate nohighlight">\(t\)</span> information that a firm  would  receive in Townsend’s
original model.</p>
<p>Let’s compute the regression and stare at the <span class="math notranslate nohighlight">\(R^2\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Verify that θ_t + e^{2}_t can be recovered</span>

<span class="c1"># θ_t + e^{2}_t on k^{i}_t, P^{1}_t, P^{2}_t, \\tilde{\\theta_t}</span>


<span class="n">model</span> <span class="o">=</span> <span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">reg_res</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">reg_res</span><span class="o">.</span><span class="n">rsquared</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg_res</span><span class="o">.</span><span class="n">rsquared</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<p>The <span class="math notranslate nohighlight">\(R^2\)</span> in this regression equals <span class="math notranslate nohighlight">\(1\)</span>.</p>
<p>That verifies that a firm’s information
set in Townsend’s original model equals its information set in a pooling equilibrium.</p>
<p>Therefore, equilibrium prices and quantities in Townsend’s original model equal those in a pooling equilibrium.</p>
</section>
<section id="an-observed-common-shock-benchmark">
<h2><span class="section-number">34.10. </span>An observed common shock benchmark<a class="headerlink" href="#an-observed-common-shock-benchmark" title="Permalink to this heading">#</a></h2>
<p>For purposes of comparison, it is  useful to construct a model in which demand disturbance in  both industries
still both share  have a common persistent component <span class="math notranslate nohighlight">\(\theta_t\)</span>, but in which the persistent component <span class="math notranslate nohighlight">\(\theta\)</span> is observed each period.</p>
<p>In this case, firms share the same information immediately and have no need to deploy signal-extraction techniques.</p>
<p>Thus, consider a version of our  model in which histories of both <span class="math notranslate nohighlight">\(\epsilon_t^i\)</span> and <span class="math notranslate nohighlight">\(\theta_t\)</span> are observed by a representative  firm.</p>
<p>In this case,  the firm’s optimal decision rule is  described by</p>
<div class="math notranslate nohighlight">
\[
k_{t+1}^i =  \tilde \lambda k_t^i + \frac{1}{\lambda - \rho} \hat \theta_{t+1}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat \theta_{t+1} = E_t \theta_{t+1}\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[
\hat \theta_{t+1} = \rho \theta_t
\]</div>
<p>Thus, the firm’s decision rule can be expressed</p>
<div class="math notranslate nohighlight">
\[
k_{t+1}^i = \tilde \lambda k_t^i + \frac{\rho}{\lambda - \rho} \theta_t
\]</div>
<p>Consequently, when a history  <span class="math notranslate nohighlight">\(\theta_s, s \leq t\)</span> is observed without noise,
the following state space system prevails:</p>
<div class="math notranslate nohighlight">
\[
\begin{aligned}
\begin{bmatrix} \theta_{t+1} \cr k_{t+1}^i \end{bmatrix} &amp; =
\begin{bmatrix} \rho &amp; 0 \cr
       \frac{\rho}{\lambda -\rho} &amp; \tilde \lambda \end{bmatrix}
       \begin{bmatrix} \theta_t \cr k_t^i \end{bmatrix}
       + \begin{bmatrix} \sigma_v \cr 0 \end{bmatrix} z_{1,t+1} \cr
\begin{bmatrix} \theta_t \cr  k_t^i \end{bmatrix} &amp; =  \begin{bmatrix} 1 &amp; 0 \cr 0 &amp; 1 \end{bmatrix}
\begin{bmatrix} \theta_t \cr k_t^i \end{bmatrix} +
\begin{bmatrix} 0 \cr 0 \end{bmatrix} z_{1,t+1}
\end{aligned}
\]</div>
<p>where <span class="math notranslate nohighlight">\(z_{t,t+1} \)</span> is a scalar iid standardized Gaussian process.</p>
<p>As usual, the system can be written as</p>
<div class="math notranslate nohighlight">
\[
\begin{aligned}
x_{t+1} &amp; = A x_t + C z_{t+1} \cr
y_t &amp; = G x_t + H w_{t+1}
\end{aligned}
\]</div>
<p>In order once again to use the  quantecon class <code class="docutils literal notranslate"><span class="pre">quantecon.LinearStateSpace</span></code>, let’s form  pertinent state-space matrices</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ao_lss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">ρ</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="n">ρ</span> <span class="o">/</span> <span class="p">(</span><span class="n">λ</span> <span class="o">-</span> <span class="n">ρ</span><span class="p">),</span> <span class="n">λ_tilde</span><span class="p">]])</span>

<span class="n">Co_lss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">σ_v</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">]])</span>

<span class="n">Go_lss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">muo_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>

<span class="n">lsso</span> <span class="o">=</span> <span class="n">qe</span><span class="o">.</span><span class="n">LinearStateSpace</span><span class="p">(</span><span class="n">Ao_lss</span><span class="p">,</span> <span class="n">Co_lss</span><span class="p">,</span> <span class="n">Go_lss</span><span class="p">,</span> <span class="n">mu_0</span><span class="o">=</span><span class="n">muo_0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s form and plot an  impulse response function of <span class="math notranslate nohighlight">\(k_t^i\)</span> to shocks <span class="math notranslate nohighlight">\(v_t\)</span> to <span class="math notranslate nohighlight">\(\theta_{t+1}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xcoef</span><span class="p">,</span> <span class="n">ycoef</span> <span class="o">=</span> <span class="n">lsso</span><span class="o">.</span><span class="n">impulse_response</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ycoef</span><span class="p">])[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$z_{t+1}$&#39;</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Impulse Response Function&#39;</span><span class="p">,</span>
                   <span class="n">xaxis_title</span><span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;lag $j$&#39;</span><span class="p">,</span>
                   <span class="n">yaxis_title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$k^</span><span class="si">{i}</span><span class="s1">_</span><span class="si">{t}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">fig3</span> <span class="o">=</span> <span class="n">fig</span>
<span class="c1"># Export to PNG file</span>
<span class="n">Image</span><span class="p">(</span><span class="n">fig3</span><span class="o">.</span><span class="n">to_image</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">))</span>
<span class="c1"># fig1.show() will provide interactive plot when running</span>
<span class="c1"># notebook locally</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8ae104ec38e53c5ce274d363ef628b81326df76d03bd7714b0aa484399731a09.png" src="_images/8ae104ec38e53c5ce274d363ef628b81326df76d03bd7714b0aa484399731a09.png" />
</div>
</div>
</section>
<section id="comparison-of-all-signal-structures">
<h2><span class="section-number">34.11. </span>Comparison of  All Signal Structures<a class="headerlink" href="#comparison-of-all-signal-structures" title="Permalink to this heading">#</a></h2>
<p>It is enlightening side by side to  plot impulse response functions for capital for the two
noisy-signal information structures and the  noiseless signal on <span class="math notranslate nohighlight">\(\theta\)</span> that we have just presented.</p>
<p>Please remember that the two-signal structure corresponds to the <strong>pooling equilibrium</strong> and also
<strong>Townsend’s original model</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig_comb</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span>
                        <span class="o">*</span><span class="n">fig1</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                        <span class="o">*</span><span class="n">fig2</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">xaxis</span><span class="o">=</span><span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="n">yaxis</span><span class="o">=</span><span class="s1">&#39;y2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                        <span class="o">*</span><span class="n">fig3</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">xaxis</span><span class="o">=</span><span class="s1">&#39;x3&#39;</span><span class="p">,</span> <span class="n">yaxis</span><span class="o">=</span><span class="s1">&#39;y3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
                    <span class="p">])</span><span class="o">.</span><span class="n">set_subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
                           <span class="n">subplot_titles</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;One noisy-signal&quot;</span><span class="p">,</span>
                                           <span class="s2">&quot;Two noisy-signal&quot;</span><span class="p">,</span>
                                           <span class="s2">&quot;No Noise&quot;</span><span class="p">),</span>
                           <span class="n">horizontal_spacing</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
                           <span class="n">shared_yaxes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Export to PNG file</span>
<span class="n">Image</span><span class="p">(</span><span class="n">fig_comb</span><span class="o">.</span><span class="n">to_image</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">))</span>
<span class="c1"># fig_comb.show() # will provide interactive plot when running</span>
<span class="c1"># notebook locally</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/22a8d98a23cd3aeaf539a20c58145b4b6080e7499b2f6ce7e717b03670c57ce9.png" src="_images/22a8d98a23cd3aeaf539a20c58145b4b6080e7499b2f6ce7e717b03670c57ce9.png" />
</div>
</div>
<p>The three panels in the graph above show that</p>
<ul class="simple">
<li><p>responses of <span class="math notranslate nohighlight">\( k_t^i \)</span> to  shocks <span class="math notranslate nohighlight">\( v_t \)</span> to the hidden Markov demand state <span class="math notranslate nohighlight">\( \theta_t \)</span> process are   <strong>largest</strong> in   the no-noisy-signal structure in which the firm observes <span class="math notranslate nohighlight">\(\theta_t\)</span> at time <span class="math notranslate nohighlight">\(t\)</span></p></li>
<li><p>responses of <span class="math notranslate nohighlight">\( k_t^i \)</span> to  shocks <span class="math notranslate nohighlight">\( v_t \)</span> to the hidden Markov demand state <span class="math notranslate nohighlight">\( \theta_t \)</span> process are   <strong>smaller</strong> in   the two-noisy-signal structure</p></li>
<li><p>responses of <span class="math notranslate nohighlight">\( k_t^i \)</span> to  shocks <span class="math notranslate nohighlight">\( v_t \)</span> to the hidden Markov demand state <span class="math notranslate nohighlight">\( \theta_t \)</span> process are   <strong>smallest</strong> in   the one-noisy-signal structure</p></li>
</ul>
<p>With respect to the iid demand shocks <span class="math notranslate nohighlight">\(e_t\)</span> the graphs show that</p>
<ul class="simple">
<li><p>responses of <span class="math notranslate nohighlight">\( k_t^i \)</span> to  shocks <span class="math notranslate nohighlight">\( e_t \)</span> to the hidden Markov demand state <span class="math notranslate nohighlight">\( \theta_t \)</span> process are   <strong>smallest</strong> (i.e., nonexistent) in   the no-noisy-signal structure in which the firm observes <span class="math notranslate nohighlight">\(\theta_t\)</span> at time <span class="math notranslate nohighlight">\(t\)</span></p></li>
<li><p>responses of <span class="math notranslate nohighlight">\( k_t^i \)</span> to  shocks <span class="math notranslate nohighlight">\( e_t \)</span> to the hidden Markov demand state <span class="math notranslate nohighlight">\( \theta_t \)</span> process are   <strong>larger</strong> in   the two-noisy-signal structure</p></li>
<li><p>responses of <span class="math notranslate nohighlight">\( k_t^i \)</span> to idiosyncratic <em>own-market</em>   noise-shocks <span class="math notranslate nohighlight">\( e_t \)</span> are <strong>largest</strong> in the one-noisy-signal structure</p></li>
</ul>
<p>Among other things,  these  findings indicate that time series correlations and coherences between outputs in the two industries are higher in the two-noisy-signals or <strong>pooling</strong> model than they are in the one-noisy signal model.</p>
<p>The enhanced influence of the shocks <span class="math notranslate nohighlight">\( v_t \)</span> to the hidden Markov demand state <span class="math notranslate nohighlight">\( \theta_t \)</span> process that
emerges from the two-noisy-signal model relative to the one-noisy-signal model is a  symptom of a lower
equilibrium hidden-state  reconstruction error variance in the two-signal model:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">Latex</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">textbf{Reconstruction error variances}$&#39;</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">Latex</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;One-noise structure: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">p_one</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">Latex</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Two-noise structure: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">p_two</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\textbf{Reconstruction error variances}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[One-noise structure: 0.36618\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Two-noise structure: 0.324062\]</div>
</div>
</div>
<p>Kalman gains  for the two
structures are</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">Latex</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">textbf{Kalman Gains}$&#39;</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">Latex</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;One noisy-signal structure: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">κ_one</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">Latex</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Two noisy-signals structure: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">κ_two</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\textbf{Kalman Gains}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[One noisy-signal structure: 0.403404\]</div>
<div class="output text_latex math notranslate nohighlight">
\[Two noisy-signals structure: 0.25716\]</div>
</div>
</div>
<p>Another  lesson that comes from the preceding three-panel graph is that the presence of iid noise
<span class="math notranslate nohighlight">\(\epsilon_t^i\)</span> in industry <span class="math notranslate nohighlight">\(i\)</span> generates a response in <span class="math notranslate nohighlight">\(k_t^{-i}\)</span> in the two-noisy-signal structure, but not in the one-noisy-signal structure.</p>
</section>
<section id="notes-on-history-of-the-problem">
<h2><span class="section-number">34.12. </span>Notes on History of the Problem<a class="headerlink" href="#notes-on-history-of-the-problem" title="Permalink to this heading">#</a></h2>
<p>To truncate what he saw as an intractable, infinite dimensional  state space,
Townsend constructed an approximating model in which the common hidden Markov demand shock
is revealed to all firms  after a fixed number of periods.</p>
<p>Thus,</p>
<ul class="simple">
<li><p>Townsend wanted to assume that at time <span class="math notranslate nohighlight">\( t \)</span> firms in industry <span class="math notranslate nohighlight">\( i \)</span> observe
<span class="math notranslate nohighlight">\( k_t^i, Y_t^i, P_t^i, (P^{-i})^t \)</span>, where <span class="math notranslate nohighlight">\( (P^{-i})^t \)</span> is the history of prices in
the other market up to time <span class="math notranslate nohighlight">\( t \)</span>.</p></li>
<li><p>Because that turned out to be too challenging, Townsend made a sensible
alternative assumption that eased his calculations: that after a large
number <span class="math notranslate nohighlight">\( S \)</span> of periods, firms in industry <span class="math notranslate nohighlight">\( i \)</span> observe the
hidden Markov component of the demand shock <span class="math notranslate nohighlight">\( \theta_{t-S} \)</span>.</p></li>
</ul>
<p>Townsend argued that the more manageable model  could do a good job of
approximating the intractable model in which the Markov component of the demand shock remains unobserved
for ever.</p>
<p>By applying technical machinery of <span id="id18">[<a class="reference internal" href="zreferences.html#id26" title="Joseph Pearlman, David Currie, and Paul Levine. Rational Expectations Models with Private Information. Economic Modelling, 3(2):90–105, 1986.">Pearlman <em>et al.</em>, 1986</a>]</span>, <span id="id19">[<a class="reference internal" href="zreferences.html#id25" title="Joseph G. Pearlman and Thomas J. Sargent. Knowing the Forecasts of Others. Review of Economic Dynamics, 8(2):480-497, April 2005. URL: https://ideas.repec.org/a/red/issued/v8y2005i2p480-497.html, doi:10.1016/j.red.2004.10.011.">Pearlman and Sargent, 2005</a>]</span> showed that there is a recursive
representation of the equilibrium of the perpetually and symmetrically
uninformed model that Townsend wanted to solve
<span id="id20">[<a class="reference internal" href="zreferences.html#id28" title="Robert M. Townsend. Forecasting the forecasts of others. Journal of Political Economy, 91:546–588, 1983.">Townsend, 1983</a>]</span>.</p>
<p>A reader of <span id="id21">[<a class="reference internal" href="zreferences.html#id25" title="Joseph G. Pearlman and Thomas J. Sargent. Knowing the Forecasts of Others. Review of Economic Dynamics, 8(2):480-497, April 2005. URL: https://ideas.repec.org/a/red/issued/v8y2005i2p480-497.html, doi:10.1016/j.red.2004.10.011.">Pearlman and Sargent, 2005</a>]</span> will notice that their representation of the equilibrium of
Townsend’s model exactly matches that of the  <strong>pooling equilibrium</strong> presented here.</p>
<p>We have structured  our notation in  this lecture to faciliate comparison of the <strong>pooling equilibrium</strong>
constructed here with the equilibrium of Townsend’s model reported in <span id="id22">[<a class="reference internal" href="zreferences.html#id25" title="Joseph G. Pearlman and Thomas J. Sargent. Knowing the Forecasts of Others. Review of Economic Dynamics, 8(2):480-497, April 2005. URL: https://ideas.repec.org/a/red/issued/v8y2005i2p480-497.html, doi:10.1016/j.red.2004.10.011.">Pearlman and Sargent, 2005</a>]</span>.</p>
<p>The computational method of <span id="id23">[<a class="reference internal" href="zreferences.html#id25" title="Joseph G. Pearlman and Thomas J. Sargent. Knowing the Forecasts of Others. Review of Economic Dynamics, 8(2):480-497, April 2005. URL: https://ideas.repec.org/a/red/issued/v8y2005i2p480-497.html, doi:10.1016/j.red.2004.10.011.">Pearlman and Sargent, 2005</a>]</span> is recursive:
it enlists the Kalman filter and invariant subspace methods for
solving systems of Euler
equations <a class="footnote-reference brackets" href="#footnote1" id="id24">5</a> .</p>
<p>As <span id="id25">[<a class="reference internal" href="zreferences.html#id30" title="Kenneth J. Singleton. Asset prices in a time-series model with disparately informed competitive traders. In William A. Barnett and Kenneth J. Singleton, editors, New Apprroaches to Monetary Economics. Cambridge University Press, 1987.">Singleton, 1987</a>]</span>, <span id="id26">[<a class="reference internal" href="zreferences.html#id27" title="Kenneth Kasa. Forecasting the forecasts of others in the frequency domain. Review of Economic Dynamics, 3:726–756, 2000.">Kasa, 2000</a>]</span>, and <span id="id27">[<a class="reference internal" href="zreferences.html#id29" title="Thomas J. Sargent. Equilibrium with signal extraction from endogenous variables. Journal of Economic Dynamics and Control, 15:245–273, 1991.">Sargent, 1991</a>]</span> also
found, the equilibrium is fully revealing: observed prices tell
participants in industry <span class="math notranslate nohighlight">\( i \)</span> all of the information held by
participants in market <span class="math notranslate nohighlight">\( -i \)</span> (<span class="math notranslate nohighlight">\( -i \)</span> means not <span class="math notranslate nohighlight">\( i \)</span>).</p>
<p>This
means that higher-order beliefs play no role: observing equilibrium prices
in effect lets decision makers pool their information
sets <a class="footnote-reference brackets" href="#footnote2" id="id28">6</a> .</p>
<p>The disappearance of higher order beliefs means that
decision makers in this model do not really face a problem of
forecasting the forecasts of others.</p>
<p>Because
those forecasts are the same as their own, they know them.</p>
<section id="further-historical-remarks">
<h3><span class="section-number">34.12.1. </span>Further historical remarks<a class="headerlink" href="#further-historical-remarks" title="Permalink to this heading">#</a></h3>
<p>Sargent <span id="id29">[<a class="reference internal" href="zreferences.html#id29" title="Thomas J. Sargent. Equilibrium with signal extraction from endogenous variables. Journal of Economic Dynamics and Control, 15:245–273, 1991.">Sargent, 1991</a>]</span> proposed a way to compute an equilibrium
without making Townsend’s approximation.</p>
<p>Extending the reasoning of <span id="id30">[<a class="reference internal" href="zreferences.html#id113" title="John F Muth. Optimal properties of exponentially weighted forecasts. Journal of the american statistical association, 55(290):299–306, 1960.">Muth, 1960</a>]</span>, Sargent noticed that it is possible to
summarize the relevant history with a low dimensional object, namely, a
small number of current and lagged forecasting errors.</p>
<p>Positing an
equilibrium in a space of perceived laws of motion for endogenous
variables that takes the form of a vector autoregressive, moving
average, Sargent described an equilibrium as a fixed point of a mapping
from the perceived law of motion to the actual law of motion of that
form.</p>
<p>Sargent worked in the time domain and proceeded to guess and verify the
appropriate orders of the autoregressive and moving average pieces of
the equilibrium representation.</p>
<p>By working in the frequency
domain <span id="id31">[<a class="reference internal" href="zreferences.html#id27" title="Kenneth Kasa. Forecasting the forecasts of others in the frequency domain. Review of Economic Dynamics, 3:726–756, 2000.">Kasa, 2000</a>]</span> showed how to discover the appropriate
orders of the autoregressive and moving average parts, and also how to
compute an equilibrium.</p>
<p>The  <span id="id32">[<a class="reference internal" href="zreferences.html#id25" title="Joseph G. Pearlman and Thomas J. Sargent. Knowing the Forecasts of Others. Review of Economic Dynamics, 8(2):480-497, April 2005. URL: https://ideas.repec.org/a/red/issued/v8y2005i2p480-497.html, doi:10.1016/j.red.2004.10.011.">Pearlman and Sargent, 2005</a>]</span> recursive computational method, which stays in the time domain, also
discovered appropriate orders of the autoregressive and moving
average pieces.</p>
<p>In addition, by displaying equilibrium representations
in the form of <span id="id33">[<a class="reference internal" href="zreferences.html#id26" title="Joseph Pearlman, David Currie, and Paul Levine. Rational Expectations Models with Private Information. Economic Modelling, 3(2):90–105, 1986.">Pearlman <em>et al.</em>, 1986</a>]</span>, <span id="id34">[<a class="reference internal" href="zreferences.html#id25" title="Joseph G. Pearlman and Thomas J. Sargent. Knowing the Forecasts of Others. Review of Economic Dynamics, 8(2):480-497, April 2005. URL: https://ideas.repec.org/a/red/issued/v8y2005i2p480-497.html, doi:10.1016/j.red.2004.10.011.">Pearlman and Sargent, 2005</a>]</span>
showed how the moving average piece is linked to the innovation process
of the hidden persistent component of the demand shock.</p>
<p>That scalar
innovation process is the additional state variable contributed by the
problem of extracting a signal from equilibrium prices that decision
makers face in Townsend’s model.</p>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="footnote0"><span class="brackets"><a class="fn-backref" href="#id13">1</a></span></dt>
<dd><p><span id="id35">[<a class="reference internal" href="zreferences.html#id25" title="Joseph G. Pearlman and Thomas J. Sargent. Knowing the Forecasts of Others. Review of Economic Dynamics, 8(2):480-497, April 2005. URL: https://ideas.repec.org/a/red/issued/v8y2005i2p480-497.html, doi:10.1016/j.red.2004.10.011.">Pearlman and Sargent, 2005</a>]</span> verified this assertion using a different tactic, namely, by constructing
analytic formulas for an equilibrium under the incomplete
information structure and confirming that they match the pooling equilibrium formulas derived here.</p>
</dd>
<dt class="label" id="footnote3"><span class="brackets"><a class="fn-backref" href="#id14">2</a></span></dt>
<dd><p>See <span id="id36">[<a class="reference internal" href="zreferences.html#id200" title="Thomas J Sargent. Macroeconomic Theory. Academic Press, New York, 2nd edition, 1987.">Sargent, 1987</a>]</span>, especially
chapters IX and XIV, for  principles  that guide solving some roots backwards and others forwards.</p>
</dd>
<dt class="label" id="footnote4"><span class="brackets"><a class="fn-backref" href="#id15">3</a></span></dt>
<dd><p>As noted by <span id="id37">[<a class="reference internal" href="zreferences.html#id200" title="Thomas J Sargent. Macroeconomic Theory. Academic Press, New York, 2nd edition, 1987.">Sargent, 1987</a>]</span>, this difference equation is the Euler equation for
a planning problem   that maximizes the discounted sum of consumer plus
producer surplus.</p>
</dd>
<dt class="label" id="footnote5"><span class="brackets"><a class="fn-backref" href="#id17">4</a></span></dt>
<dd><p><span id="id38">[<a class="reference internal" href="zreferences.html#id25" title="Joseph G. Pearlman and Thomas J. Sargent. Knowing the Forecasts of Others. Review of Economic Dynamics, 8(2):480-497, April 2005. URL: https://ideas.repec.org/a/red/issued/v8y2005i2p480-497.html, doi:10.1016/j.red.2004.10.011.">Pearlman and Sargent, 2005</a>]</span> verify the same claim by applying   machinery of  <span id="id39">[<a class="reference internal" href="zreferences.html#id26" title="Joseph Pearlman, David Currie, and Paul Levine. Rational Expectations Models with Private Information. Economic Modelling, 3(2):90–105, 1986.">Pearlman <em>et al.</em>, 1986</a>]</span>.</p>
</dd>
<dt class="label" id="footnote1"><span class="brackets"><a class="fn-backref" href="#id24">5</a></span></dt>
<dd><p>See <span id="id40">[<a class="reference internal" href="zreferences.html#id138" title="Evan Anderson, Lars Peter Hansen, Ellen R. McGrattan, and Thomas J. Sargent. Mechanics of forming and estimating dynamic linear economies. In Hans M. Amman, David A. Kendrick, and John Rust, editors, Handbook of computational economics, 171–252. Elsevier Science, North-Holland, 1996.">Anderson <em>et al.</em>, 1996</a>]</span> for an account of invariant subspace methods.</p>
</dd>
<dt class="label" id="footnote2"><span class="brackets"><a class="fn-backref" href="#id28">6</a></span></dt>
<dd><p>See <span id="id41">[<a class="reference internal" href="zreferences.html#id31" title="Franklin Allen, Stephen Morris, and Hyun Song Shin. Beauty contests, bubbles, and iterated expectations in asset markets. mimeo, 2002.">Allen <em>et al.</em>, 2002</a>]</span> for a discussion
of  information assumptions needed to create a situation
in which higher order beliefs appear in equilibrium decision rules.  A way
to read our findings in light of <span id="id42">[<a class="reference internal" href="zreferences.html#id31" title="Franklin Allen, Stephen Morris, and Hyun Song Shin. Beauty contests, bubbles, and iterated expectations in asset markets. mimeo, 2002.">Allen <em>et al.</em>, 2002</a>]</span> is that, relative
to the number of signals agents observe,  Townsend’s
section 8 model  has too few  random shocks  to get higher order beliefs to
play a role.</p>
</dd>
</dl>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tools and Techniques
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="orth_proj.html">
   1. Orthogonal Projections and Their Applications
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stationary_densities.html">
   2. Continuous State Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="muth_kalman.html">
   3. Reverse Engineering a la Muth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="discrete_dp.html">
   4. Discrete State Dynamic Programming
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  LQ Control
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="cons_news.html">
   5. Information and Consumption Smoothing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="smoothing.html">
   6. Consumption Smoothing with Complete and Incomplete Markets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="smoothing_tax.html">
   7. Tax Smoothing with Complete and Incomplete Markets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_jump_lq.html">
   8. Markov Jump Linear Quadratic Dynamic Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tax_smoothing_1.html">
   9. How to Pay for a War: Part 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tax_smoothing_2.html">
   10. How to Pay for a War: Part 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tax_smoothing_3.html">
   11. How to Pay for a War: Part 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lqramsey.html">
   12. Optimal Taxation in an LQ Economy
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Multiple Agent Models
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="arellano.html">
   13. Default Risk and Income Fluctuations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="matsuyama.html">
   14. Globalization and Cycles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coase.html">
   15. Coase’s Theory of the Firm
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="match_transport.html">
   16. Composite Sorting
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Dynamic Linear Economies
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="hs_recursive_models.html">
   17. Recursive Models of Dynamic Linear Economies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="growth_in_dles.html">
   18. Growth in Dynamic Linear Economies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lucas_asset_pricing_dles.html">
   19. Lucas Asset Pricing Using DLE
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="irfs_in_hall_model.html">
   20. IRFs in Hall Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="permanent_income_dles.html">
   21. Permanent Income Model using the DLE Class
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rosen_schooling_model.html">
   22. Rosen Schooling Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cattle_cycles.html">
   23. Cattle Cycles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hs_invertibility_example.html">
   24. Shock Non Invertibility
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Risk, Model Uncertainty, and Robustness
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="five_preferences.html">
   25. Risk and Model Uncertainty
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="entropy.html">
   26. Etymology of Entropy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="robustness.html">
   27. Robustness
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rob_markov_perf.html">
   28. Robust Markov Perfect Equilibrium
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Time Series Models
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="arma.html">
   29. Covariance Stationary Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="estspec.html">
   30. Estimation of Spectra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="additive_functionals.html">
   31. Additive and Multiplicative Functionals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lu_tricks.html">
   32. Classical Control with Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="classical_filtering.html">
   33. Classical Prediction and Filtering With Linear Algebra
  </a>
 </li>
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   34. Knowing the Forecasts of Others
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Asset Pricing and Finance
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lucas_model.html">
   35. Asset Pricing II: The Lucas Asset Pricing Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="asset_pricing_lph.html">
   36. Elementary Asset Pricing Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="black_litterman.html">
   37. Two Modifications of Mean-Variance Portfolio Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="BCG_complete_mkts.html">
   38. Irrelevance of Capital Structures with Complete Markets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="BCG_incomplete_mkts.html">
   39. Equilibrium Capital Structures with Incomplete Markets
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Dynamic Programming Squared
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="un_insure.html">
   40. Optimal Unemployment Insurance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dyn_stack.html">
   41. Stackelberg Plans
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="calvo_machine_learn.html">
   42. Machine Learning a Ramsey Plan
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="calvo.html">
   43. Time Inconsistency of Ramsey Plans
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="calvo_abreu.html">
   44. Sustainable Plans for a Calvo Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="opt_tax_recur.html">
   45. Optimal Taxation with State-Contingent Debt
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="amss.html">
   46. Optimal Taxation without State-Contingent Debt
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="amss2.html">
   47. Fluctuating Interest Rates Deliver Fiscal Insurance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="amss3.html">
   48. Fiscal Risk and Government Debt
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chang_ramsey.html">
   49. Competitive Equilibria of a Model of Chang
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chang_credible.html">
   50. Credible Government Policies in a Model of Chang
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Other
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="troubleshooting.html">
   51. Troubleshooting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zreferences.html">
   52. References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="status.html">
   53. Execution Statistics
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="intro.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                </ul>

                <ul class="qe-toolbar__links">
                    <li class="btn__search">
                        <form action="search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off" accesskey="k">
                            <i data-feather="search" id="search-icon"></i>
                        </form>
                    </li>
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li data-tippy-content="Download Notebook"><a href="/_notebooks/knowing_forecasts_of_others.ipynb" download><i data-feather="download-cloud"></i></a></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li class="download-pdf" id="downloadButton"><i data-feather="file"></i></li>
                    <!--
                    # Enable if looking for link to specific document hosted on GitHub
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python-advanced.myst/blob/main/lectures/knowing_forecasts_of_others.md" download><i data-feather="github"></i></a></li>
                    -->
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python-advanced.myst" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="/_pdf/quantecon-python-advanced.pdf" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://colab.research.google.com/github/QuantEcon/lecture-python-advanced.notebooks/blob/main/knowing_forecasts_of_others.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/QuantEcon/lecture-python-advanced.notebooks" data-urlpath="tree/lecture-python-advanced.notebooks/knowing_forecasts_of_others.ipynb" data-branch=main>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://colab.research.google.com/github/QuantEcon/lecture-python-advanced.notebooks/blob/main/knowing_forecasts_of_others.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "knowing_forecasts_of_others";
                const repoURL = "https://github.com/QuantEcon/lecture-python-advanced.notebooks";
                const urlPath = "tree/lecture-python-advanced.notebooks/knowing_forecasts_of_others.ipynb";
                const branch = "main"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/jupyter/hub/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
  </body>
</html>