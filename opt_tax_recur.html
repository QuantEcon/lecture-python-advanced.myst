

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>42. Optimal Taxation with State-Contingent Debt &#8212; Advanced Quantitative Economics with Python</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/quantecon-book-theme.css?digest=b09b2da44b9015b4fa76ea072fa2d8f7faee5492" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>


    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/scripts/quantecon-book-theme.js?digest=eed9c059a3ee152aae2353ec732f0a6d12e6aa07"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-KZLV7PM9LL"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-KZLV7PM9LL');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"argmax": "arg\\,max", "argmin": "arg\\,min", "col": "col", "Span": "span", "epsilon": "\\varepsilon", "EE": "\\mathbb{E}", "PP": "\\mathbb{P}", "RR": "\\mathbb{R}", "NN": "\\mathbb{N}", "ZZ": "\\mathbb{Z}", "aA": "\\mathcal{A}", "bB": "\\mathcal{B}", "cC": "\\mathcal{C}", "dD": "\\mathcal{D}", "eE": "\\mathcal{E}", "fF": "\\mathcal{F}", "gG": "\\mathcal{G}", "hH": "\\mathcal{H}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'opt_tax_recur';</script>
    <link rel="canonical" href="https://python-advanced.quantecon.org/opt_tax_recur.html" />
    <link rel="shortcut icon" href="_static/lectures-favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="43. Optimal Taxation without State-Contingent Debt" href="amss.html" />
    <link rel="prev" title="41. Ramsey Plans, Time Inconsistency, Sustainable Plans" href="calvo.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Thomas J. Sargent &amp; John Stachurski" />
<meta name="keywords" content="Python, QuantEcon, Quantitative Economics, Economics, Sloan, Alfred P. Sloan Foundation, Tom J. Sargent, John Stachurski" />
<meta name="description" content=This website presents a set of lectures on advanced quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski. />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="Optimal Taxation with State-Contingent Debt"/>
<meta name="twitter:description" content="This website presents a set of lectures on advanced quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski.">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="Optimal Taxation with State-Contingent Debt" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://python-advanced.quantecon.org/opt_tax_recur.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="This website presents a set of lectures on advanced quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski." />
<meta property="og:site_name" content="Advanced Quantitative Economics with Python" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>


    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=opt_tax_recur>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">42.1. Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-competitive-equilibrium-with-distorting-taxes">42.2. A Competitive Equilibrium with Distorting Taxes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#arrow-debreu-version-of-price-system">42.2.1. Arrow-Debreu Version of Price System</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#primal-approach">42.2.2. Primal Approach</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-implementability-constraint">42.2.3. The Implementability Constraint</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-details">42.2.4. Solution Details</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-ramsey-allocation-for-a-given-multiplier">42.2.5. The Ramsey Allocation for a Given Multiplier</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#further-specialization">42.2.6. Further Specialization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#determining-the-lagrange-multiplier">42.2.7. Determining the Lagrange Multiplier</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-inconsistency">42.2.8. Time Inconsistency</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#specification-with-crra-utility">42.2.9. Specification with CRRA Utility</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sequence-implementation">42.2.10. Sequence Implementation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recursive-formulation-of-the-ramsey-problem">42.3. Recursive Formulation of the Ramsey Problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#intertemporal-delegation">42.3.1. Intertemporal Delegation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#two-bellman-equations">42.3.2. Two Bellman Equations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-continuation-ramsey-problem">42.3.3. The Continuation Ramsey Problem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-ramsey-problem">42.3.4. The Ramsey Problem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#first-order-conditions">42.3.5. First-Order Conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#state-variable-degeneracy">42.3.6. State Variable Degeneracy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#manifestations-of-time-inconsistency">42.3.7. Manifestations of Time Inconsistency</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recursive-implementation">42.3.8. Recursive Implementation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">42.4. Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#anticipated-one-period-war">42.4.1. Anticipated One-Period War</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#government-saving">42.4.2. Government Saving</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-0-manipulation-of-interest-rate">42.4.3. Time 0 Manipulation of Interest Rate</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-0-and-time-inconsistency">42.4.4. Time 0 and Time-Inconsistency</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tax-smoothing-and-non-crra-preferences">42.4.5. Tax Smoothing and non-CRRA Preferences</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#further-comments">42.4.6. Further Comments</a></li>
</ul>
</li>
</ul>
                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="_static/qe-logo-large.png" class="logo logo-img" alt="logo"></a>
                                    
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="intro.html">Advanced Quantitative Economics with Python</a></p>

                        <p class="qe-page__header-subheading">Optimal Taxation with State-Contingent Debt</p>

                    </div>
                    <!-- length 2, since its a string and empty dict has length 2 - {} -->
                        <p class="qe-page__header-authors" font-size="18">
                            
                                
                                    <a href="http://www.tomsargent.com/" target="_blank"><span>Thomas J. Sargent</span></a>
                                
                            
                                
                                    and <a href="https://johnstachurski.net/" target="_blank"><span>John Stachurski</span></a>
                                
                            
                        </p>


                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <div id="qe-notebook-header" align="right" style="text-align:right;">
        <a href="https://quantecon.org/" title="quantecon.org">
                <img style="width:250px;display:inline;" width="250px" src="https://assets.quantecon.org/img/qe-menubar-logo.svg" alt="QuantEcon">
        </a>
</div><section class="tex2jax_ignore mathjax_ignore" id="optimal-taxation-with-state-contingent-debt">
<h1><a class="toc-backref" href="#id5"><span class="section-number">42. </span>Optimal Taxation with State-Contingent Debt</a><a class="headerlink" href="#optimal-taxation-with-state-contingent-debt" title="Permalink to this heading">#</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#optimal-taxation-with-state-contingent-debt" id="id5">Optimal Taxation with State-Contingent Debt</a></p>
<ul>
<li><p><a class="reference internal" href="#overview" id="id6">Overview</a></p></li>
<li><p><a class="reference internal" href="#a-competitive-equilibrium-with-distorting-taxes" id="id7">A Competitive Equilibrium with Distorting Taxes</a></p></li>
<li><p><a class="reference internal" href="#recursive-formulation-of-the-ramsey-problem" id="id8">Recursive Formulation of the Ramsey Problem</a></p></li>
<li><p><a class="reference internal" href="#examples" id="id9">Examples</a></p></li>
</ul>
</li>
</ul>
</div>
<p>In addition to what’s in Anaconda, this lecture will need the following libraries:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>quantecon
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>interpolation
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: quantecon in /usr/share/miniconda3/envs/quantecon/lib/python3.11/site-packages (0.7.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: numba&gt;=0.49.0 in /usr/share/miniconda3/envs/quantecon/lib/python3.11/site-packages (from quantecon) (0.57.1)
Requirement already satisfied: numpy&gt;=1.17.0 in /usr/share/miniconda3/envs/quantecon/lib/python3.11/site-packages (from quantecon) (1.24.3)
Requirement already satisfied: requests in /usr/share/miniconda3/envs/quantecon/lib/python3.11/site-packages (from quantecon) (2.31.0)
Requirement already satisfied: scipy&gt;=1.5.0 in /usr/share/miniconda3/envs/quantecon/lib/python3.11/site-packages (from quantecon) (1.11.1)
Requirement already satisfied: sympy in /usr/share/miniconda3/envs/quantecon/lib/python3.11/site-packages (from quantecon) (1.11.1)
Requirement already satisfied: llvmlite&lt;0.41,&gt;=0.40.0dev0 in /usr/share/miniconda3/envs/quantecon/lib/python3.11/site-packages (from numba&gt;=0.49.0-&gt;quantecon) (0.40.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /usr/share/miniconda3/envs/quantecon/lib/python3.11/site-packages (from requests-&gt;quantecon) (2.0.4)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/share/miniconda3/envs/quantecon/lib/python3.11/site-packages (from requests-&gt;quantecon) (3.4)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/share/miniconda3/envs/quantecon/lib/python3.11/site-packages (from requests-&gt;quantecon) (1.26.16)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/share/miniconda3/envs/quantecon/lib/python3.11/site-packages (from requests-&gt;quantecon) (2023.7.22)
Requirement already satisfied: mpmath&gt;=0.19 in /usr/share/miniconda3/envs/quantecon/lib/python3.11/site-packages (from sympy-&gt;quantecon) (1.3.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: interpolation in /usr/share/miniconda3/envs/quantecon/lib/python3.11/site-packages (2.2.1)
Requirement already satisfied: numba&gt;=0.47 in /usr/share/miniconda3/envs/quantecon/lib/python3.11/site-packages (from interpolation) (0.57.1)
Requirement already satisfied: numpy&gt;=1.18.1 in /usr/share/miniconda3/envs/quantecon/lib/python3.11/site-packages (from interpolation) (1.24.3)
Requirement already satisfied: scipy&gt;=1.4.1 in /usr/share/miniconda3/envs/quantecon/lib/python3.11/site-packages (from interpolation) (1.11.1)
Requirement already satisfied: tempita&gt;=0.5.2 in /usr/share/miniconda3/envs/quantecon/lib/python3.11/site-packages (from interpolation) (0.5.2)
Requirement already satisfied: llvmlite&lt;0.41,&gt;=0.40.0dev0 in /usr/share/miniconda3/envs/quantecon/lib/python3.11/site-packages (from numba&gt;=0.47-&gt;interpolation) (0.40.0)
</pre></div>
</div>
</div>
</details>
</div>
<section id="overview">
<h2><a class="toc-backref" href="#id6"><span class="section-number">42.1. </span>Overview</a><a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h2>
<p>This lecture describes a celebrated model of optimal fiscal policy by Robert E.
Lucas, Jr., and Nancy Stokey  <span id="id1">[<a class="reference internal" href="zreferences.html#id176" title="Robert E Lucas, Jr. and Nancy L Stokey. Optimal Fiscal and Monetary Policy in an Economy without Capital. Journal of monetary Economics, 12(3):55–93, 1983.">LS83</a>]</span>.</p>
<p>The model revisits classic issues about how to pay for a war.</p>
<p>Here a <em>war</em> means a more  or less temporary surge in an exogenous government expenditure process.</p>
<p>The model features</p>
<ul class="simple">
<li><p>a government that must finance an exogenous stream of government expenditures with  either</p>
<ul>
<li><p>a flat rate tax on labor, or</p></li>
<li><p>purchases and sales from a full array of Arrow state-contingent securities</p></li>
</ul>
</li>
<li><p>a representative household that values consumption and leisure</p></li>
<li><p>a linear production function mapping labor into a single good</p></li>
<li><p>a Ramsey planner who at time <span class="math notranslate nohighlight">\(t=0\)</span> chooses a plan for taxes and
trades of <a class="reference external" href="https://en.wikipedia.org/wiki/Arrow_security">Arrow securities</a> for all <span class="math notranslate nohighlight">\(t \geq 0\)</span></p></li>
</ul>
<p>After first presenting the model in a space of sequences, we shall represent it
recursively in terms of two Bellman equations formulated along lines that we
encountered in <a class="reference internal" href="dyn_stack.html"><span class="doc">Dynamic Stackelberg models</span></a>.</p>
<p>As in <a class="reference internal" href="dyn_stack.html"><span class="doc">Dynamic Stackelberg models</span></a>, to apply dynamic programming
we shall define the state vector artfully.</p>
<p>In particular, we shall include forward-looking variables that summarize  optimal
responses of private agents to a Ramsey plan.</p>
<p>See <a class="reference internal" href="lqramsey.html"><span class="doc">Optimal taxation</span></a> for analysis within a linear-quadratic setting.</p>
<p>Let’s start with some standard imports:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">root</span>
<span class="kn">from</span> <span class="nn">quantecon</span> <span class="kn">import</span> <span class="n">MarkovChain</span>
<span class="kn">from</span> <span class="nn">quantecon.optimize.nelder_mead</span> <span class="kn">import</span> <span class="n">nelder_mead</span>
<span class="kn">from</span> <span class="nn">interpolation</span> <span class="kn">import</span> <span class="n">interp</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">njit</span><span class="p">,</span> <span class="n">prange</span><span class="p">,</span> <span class="n">float64</span>
<span class="kn">from</span> <span class="nn">numba.experimental</span> <span class="kn">import</span> <span class="n">jitclass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda3/envs/quantecon/lib/python3.11/site-packages/numba/core/decorators.py:262: NumbaDeprecationWarning: <span class=" -Color -Color-Bold">numba.generated_jit is deprecated. Please see the documentation at: https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-generated-jit for more information and advice on a suitable replacement.</span>
  warnings.warn(msg, NumbaDeprecationWarning)
</pre></div>
</div>
</div>
</div>
</section>
<section id="a-competitive-equilibrium-with-distorting-taxes">
<h2><a class="toc-backref" href="#id7"><span class="section-number">42.2. </span>A Competitive Equilibrium with Distorting Taxes</a><a class="headerlink" href="#a-competitive-equilibrium-with-distorting-taxes" title="Permalink to this heading">#</a></h2>
<p>At time <span class="math notranslate nohighlight">\(t \geq 0\)</span> a random variable <span class="math notranslate nohighlight">\(s_t\)</span> belongs to a time-invariant
set <span class="math notranslate nohighlight">\({\cal S} = [1, 2, \ldots, S]\)</span>.</p>
<p>For <span class="math notranslate nohighlight">\(t \geq 0\)</span>, a history <span class="math notranslate nohighlight">\(s^t = [s_t, s_{t-1}, \ldots, s_0]\)</span> of an
exogenous state <span class="math notranslate nohighlight">\(s_t\)</span> has joint probability density <span class="math notranslate nohighlight">\(\pi_t(s^t)\)</span>.</p>
<p>We begin by assuming that government purchases <span class="math notranslate nohighlight">\(g_t(s^t)\)</span> at time <span class="math notranslate nohighlight">\(t \geq 0\)</span> depend on <span class="math notranslate nohighlight">\(s^t\)</span>.</p>
<p>Let <span class="math notranslate nohighlight">\(c_t(s^t)\)</span>,  <span class="math notranslate nohighlight">\(\ell_t(s^t)\)</span>, and <span class="math notranslate nohighlight">\(n_t(s^t)\)</span> denote consumption,
leisure, and labor supply, respectively, at history <span class="math notranslate nohighlight">\(s^t\)</span> and date <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>A representative  household is endowed with one unit of time that can be divided
between leisure <span class="math notranslate nohighlight">\(\ell_t\)</span> and labor <span class="math notranslate nohighlight">\(n_t\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-feas1-opt-tax">
<span class="eqno">(42.1)<a class="headerlink" href="#equation-feas1-opt-tax" title="Permalink to this equation">#</a></span>\[n_t(s^t) + \ell_t(s^t) = 1\]</div>
<p>Output equals <span class="math notranslate nohighlight">\(n_t(s^t)\)</span> and can be divided between <span class="math notranslate nohighlight">\(c_t(s^t)\)</span> and <span class="math notranslate nohighlight">\(g_t(s^t)\)</span></p>
<div class="math notranslate nohighlight" id="equation-tss-techr-opt-tax">
<span class="eqno">(42.2)<a class="headerlink" href="#equation-tss-techr-opt-tax" title="Permalink to this equation">#</a></span>\[c_t(s^t) + g_t(s^t) = n_t(s^t)\]</div>
<p>A representative household’s preferences over <span class="math notranslate nohighlight">\(\{c_t(s^t), \ell_t(s^t)\}_{t=0}^\infty\)</span> are ordered by</p>
<div class="math notranslate nohighlight" id="equation-ts-prefr-opt-tax">
<span class="eqno">(42.3)<a class="headerlink" href="#equation-ts-prefr-opt-tax" title="Permalink to this equation">#</a></span>\[\sum_{t=0}^\infty \sum_{s^t} \beta^t \pi_t(s^t) u[c_t(s^t), \ell_t(s^t)]\]</div>
<p>where the utility function <span class="math notranslate nohighlight">\(u\)</span> is  increasing, strictly concave, and three
times continuously differentiable in both arguments.</p>
<p>The technology pins down a pre-tax wage rate to unity for all <span class="math notranslate nohighlight">\(t, s^t\)</span>.</p>
<p>The government imposes a flat-rate tax <span class="math notranslate nohighlight">\(\tau_t(s^t)\)</span> on labor income at
time <span class="math notranslate nohighlight">\(t\)</span>, history <span class="math notranslate nohighlight">\(s^t\)</span>.</p>
<p>There are complete markets in one-period Arrow securities.</p>
<p>One unit of an Arrow security  issued at time <span class="math notranslate nohighlight">\(t\)</span> at history <span class="math notranslate nohighlight">\(s^t\)</span>
and promising to pay one unit of time <span class="math notranslate nohighlight">\(t+1\)</span> consumption in state <span class="math notranslate nohighlight">\(s_{t+1}\)</span>
costs <span class="math notranslate nohighlight">\(p_{t+1}(s_{t+1}|s^t)\)</span>.</p>
<p>The government issues one-period Arrow securities each period.</p>
<p>The government has a sequence of budget constraints whose time <span class="math notranslate nohighlight">\(t \geq 0\)</span> component is</p>
<div class="math notranslate nohighlight" id="equation-ts-govr">
<span class="eqno">(42.4)<a class="headerlink" href="#equation-ts-govr" title="Permalink to this equation">#</a></span>\[g_t(s^t) =   \tau_t(s^t)  n_t(s^t) + \sum_{s_{t+1}} p_{t+1}(s_{t+1} | s^t) b_{t+1}(s_{t+1} | s^t) -
b_t(s_t | s^{t-1})\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p_{t+1}(s_{t+1}|s^t)\)</span> is a competitive equilibrium price of one unit of
consumption at date <span class="math notranslate nohighlight">\(t+1\)</span> in state <span class="math notranslate nohighlight">\(s_{t+1}\)</span> at date <span class="math notranslate nohighlight">\(t\)</span> and history <span class="math notranslate nohighlight">\(s^t\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(b_t(s_t|s^{t-1})\)</span> is government debt falling due at time <span class="math notranslate nohighlight">\(t\)</span>, history <span class="math notranslate nohighlight">\(s^t\)</span>.</p></li>
</ul>
<p>Government debt <span class="math notranslate nohighlight">\(b_0(s_0)\)</span> is an exogenous initial condition.</p>
<p>The representative household has a sequence of budget constraints whose time <span class="math notranslate nohighlight">\(t\geq 0\)</span> component is</p>
<div class="math notranslate nohighlight" id="equation-ts-bcr">
<span class="eqno">(42.5)<a class="headerlink" href="#equation-ts-bcr" title="Permalink to this equation">#</a></span>\[c_t(s^t) + \sum_{s_{t+1}} p_t(s_{t+1} | s^t) b_{t+1}(s_{t+1} | s^t)
=  \left[1-\tau_t(s^t)\right]  n_t(s^t) + b_t(s_t | s^{t-1}) \quad \forall t \geq 0\]</div>
<p>A  <strong>government policy</strong> is an exogenous sequence <span class="math notranslate nohighlight">\(\{g(s_t)\}_{t=0}^\infty\)</span>,
a tax rate sequence <span class="math notranslate nohighlight">\(\{\tau_t(s^t)\}_{t=0}^\infty\)</span>, and a government debt sequence <span class="math notranslate nohighlight">\(\{b_{t+1}(s^{t+1})\}_{t=0}^\infty\)</span>.</p>
<p>A <strong>feasible allocation</strong> is a consumption-labor supply plan <span class="math notranslate nohighlight">\(\{c_t(s^t), n_t(s^t)\}_{t=0}^\infty\)</span>
that satisfies <a class="reference internal" href="#equation-tss-techr-opt-tax">(42.2)</a> at all <span class="math notranslate nohighlight">\(t, s^t\)</span>.</p>
<p>A <strong>price system</strong> is a sequence of Arrow security prices <span class="math notranslate nohighlight">\(\{p_{t+1}(s_{t+1} | s^t) \}_{t=0}^\infty\)</span>.</p>
<p>The household faces the price system as a price-taker and takes the government policy as given.</p>
<p>The household chooses <span class="math notranslate nohighlight">\(\{c_t(s^t), \ell_t(s^t)\}_{t=0}^\infty\)</span> to maximize <a class="reference internal" href="#equation-ts-prefr-opt-tax">(42.3)</a> subject to <a class="reference internal" href="#equation-ts-bcr">(42.5)</a> and <a class="reference internal" href="#equation-feas1-opt-tax">(42.1)</a> for all <span class="math notranslate nohighlight">\(t, s^t\)</span>.</p>
<p>A <strong>competitive equilibrium with distorting taxes</strong> is a feasible allocation,
a price system, and a government policy such that</p>
<ul class="simple">
<li><p>Given the price system and the government policy, the allocation solves the
household’s optimization problem.</p></li>
<li><p>Given the allocation, government policy, and  price system, the government’s
budget constraint is satisfied for all <span class="math notranslate nohighlight">\(t, s^t\)</span>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are many competitive equilibria with distorting taxes.</p>
</div>
<p>They are indexed by different government policies.</p>
<p>The <strong>Ramsey problem</strong> or <strong>optimal taxation problem</strong> is to choose a competitive
equilibrium with distorting taxes that maximizes <a class="reference internal" href="#equation-ts-prefr-opt-tax">(42.3)</a>.</p>
<section id="arrow-debreu-version-of-price-system">
<h3><span class="section-number">42.2.1. </span>Arrow-Debreu Version of Price System<a class="headerlink" href="#arrow-debreu-version-of-price-system" title="Permalink to this heading">#</a></h3>
<p>We find it convenient sometimes to work with the Arrow-Debreu price system that is
implied by a sequence of Arrow securities prices.</p>
<p>Let <span class="math notranslate nohighlight">\(q_t^0(s^t)\)</span> be the price at time <span class="math notranslate nohighlight">\(0\)</span>, measured in time <span class="math notranslate nohighlight">\(0\)</span>
consumption goods, of one unit of consumption at time <span class="math notranslate nohighlight">\(t\)</span>,
history <span class="math notranslate nohighlight">\(s^t\)</span>.</p>
<p>The following recursion relates Arrow-Debreu prices <span class="math notranslate nohighlight">\(\{q_t^0(s^t)\}_{t=0}^\infty\)</span>
to Arrow securities prices <span class="math notranslate nohighlight">\(\{p_{t+1}(s_{t+1}|s^t)\}_{t=0}^\infty\)</span></p>
<div class="math notranslate nohighlight" id="equation-ts-foc">
<span class="eqno">(42.6)<a class="headerlink" href="#equation-ts-foc" title="Permalink to this equation">#</a></span>\[q^0_{t+1}(s^{t+1}) = p_{t+1}(s_{t+1}|s^t) q^0_t(s^t) \quad s.t. \quad q_0^0(s^0) = 1\]</div>
<p>Arrow-Debreu prices are useful when we want to compress a sequence of budget
constraints into a single intertemporal budget constraint, as we shall find it
convenient to do below.</p>
</section>
<section id="primal-approach">
<h3><span class="section-number">42.2.2. </span>Primal Approach<a class="headerlink" href="#primal-approach" title="Permalink to this heading">#</a></h3>
<p>We apply a popular approach to solving a Ramsey problem, called the <em>primal approach</em>.</p>
<p>The idea is to use first-order conditions for household optimization to
eliminate taxes and prices in favor of quantities, then pose an optimization problem
cast entirely in terms of quantities.</p>
<p>After Ramsey quantities have been found, taxes and prices can then be unwound
from the allocation.</p>
<p>The primal approach uses four steps:</p>
<ol class="arabic simple">
<li><p>Obtain  first-order conditions of the household’s problem and solve them for <span class="math notranslate nohighlight">\(\{q^0_t(s^t), \tau_t(s^t)\}_{t=0}^\infty\)</span> as functions of
the allocation <span class="math notranslate nohighlight">\(\{c_t(s^t), n_t(s^t)\}_{t=0}^\infty\)</span>.</p></li>
<li><p>Substitute these expressions for taxes and prices in terms of the allocation
into the household’s present-value budget constraint.</p>
<ul class="simple">
<li><p>This intertemporal constraint involves only the allocation and is regarded
as an <em>implementability constraint</em>.</p></li>
</ul>
</li>
<li><p>Find the allocation that maximizes the utility of the representative household
<a class="reference internal" href="#equation-ts-prefr-opt-tax">(42.3)</a> subject to  the feasibility constraints <a class="reference internal" href="#equation-feas1-opt-tax">(42.1)</a>
and <a class="reference internal" href="#equation-tss-techr-opt-tax">(42.2)</a>  and the implementability condition derived in step 2.</p>
<ul class="simple">
<li><p>This optimal allocation is called the <strong>Ramsey allocation</strong>.</p></li>
</ul>
</li>
<li><p>Use the Ramsey  allocation together with the formulas from step 1 to find
taxes and prices.</p></li>
</ol>
</section>
<section id="the-implementability-constraint">
<h3><span class="section-number">42.2.3. </span>The Implementability Constraint<a class="headerlink" href="#the-implementability-constraint" title="Permalink to this heading">#</a></h3>
<p>By sequential substitution of one one-period budget constraint <a class="reference internal" href="#equation-ts-bcr">(42.5)</a> into
another, we can obtain the household’s present-value budget constraint:</p>
<div class="math notranslate nohighlight" id="equation-ts-bcpv2">
<span class="eqno">(42.7)<a class="headerlink" href="#equation-ts-bcpv2" title="Permalink to this equation">#</a></span>\[\sum_{t=0}^\infty \sum_{s^t} q^0_t(s^t) c_t(s^t) =
\sum_{t=0}^\infty \sum_{s^t} q^0_t(s^t) [1-\tau_t(s^t)] n_t(s^t) +
b_0\]</div>
<p><span class="math notranslate nohighlight">\(\{q^0_t(s^t)\}_{t=1}^\infty\)</span> can be interpreted as a time <span class="math notranslate nohighlight">\(0\)</span>
Arrow-Debreu price system.</p>
<p>To approach the Ramsey problem, we study the household’s optimization problem.</p>
<p>First-order conditions for the household’s problem for <span class="math notranslate nohighlight">\(\ell_t(s^t)\)</span>
and <span class="math notranslate nohighlight">\(b_t(s_{t+1}| s^t)\)</span>, respectively, imply</p>
<div class="math notranslate nohighlight" id="equation-lsa-taxr">
<span class="eqno">(42.8)<a class="headerlink" href="#equation-lsa-taxr" title="Permalink to this equation">#</a></span>\[(1 - \tau_t(s^t)) = {\frac{u_l(s^t)}{u_c(s^t)}}\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-ls101">
<span class="eqno">(42.9)<a class="headerlink" href="#equation-ls101" title="Permalink to this equation">#</a></span>\[p_{t+1}(s_{t+1}| s^t) = \beta \pi(s_{t+1} | s^t) \left({\frac{u_c(s^{t+1})}{u_c({s^t})}} \right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\pi(s_{t+1} | s^t)\)</span> is the probability distribution of <span class="math notranslate nohighlight">\(s_{t+1}\)</span>
conditional on history <span class="math notranslate nohighlight">\(s^t\)</span>.</p>
<p>Equation <a class="reference internal" href="#equation-ls101">(42.9)</a> implies that the Arrow-Debreu price system satisfies</p>
<div class="math notranslate nohighlight" id="equation-ls102">
<span class="eqno">(42.10)<a class="headerlink" href="#equation-ls102" title="Permalink to this equation">#</a></span>\[q_t^0(s^t) = \beta^{t} \pi_{t}(s^{t})
                            {u_c(s^{t})  \over u_c(s^0)}\]</div>
<p>(The stochastic process <span class="math notranslate nohighlight">\(\{q_t^0(s^t)\}\)</span> is an instance of what finance economists call a <em>stochastic discount factor</em> process.)</p>
<p>Using the first-order conditions <a class="reference internal" href="#equation-lsa-taxr">(42.8)</a> and <a class="reference internal" href="#equation-ls101">(42.9)</a> to eliminate
taxes and prices from <a class="reference internal" href="#equation-ts-bcpv2">(42.7)</a>, we derive the <em>implementability condition</em></p>
<div class="math notranslate nohighlight" id="equation-tss-cham1">
<span class="eqno">(42.11)<a class="headerlink" href="#equation-tss-cham1" title="Permalink to this equation">#</a></span>\[\sum_{t=0}^\infty  \sum_{s^t} \beta^t \pi_t(s^t)
         [u_c(s^t) c_t(s^t) - u_\ell(s^t) n_t(s^t)] -
         u_c(s^0) b_0 = 0\]</div>
<p>The <strong>Ramsey problem</strong> is to choose a feasible  allocation  that maximizes</p>
<div class="math notranslate nohighlight" id="equation-ts-prefr2">
<span class="eqno">(42.12)<a class="headerlink" href="#equation-ts-prefr2" title="Permalink to this equation">#</a></span>\[\sum_{t=0}^\infty \sum_{s^t} \beta^t \pi_t(s^t) u[c_t(s^t), 1 - n_t(s^t)]\]</div>
<p>subject to  <a class="reference internal" href="#equation-tss-cham1">(42.11)</a>.</p>
</section>
<section id="solution-details">
<h3><span class="section-number">42.2.4. </span>Solution Details<a class="headerlink" href="#solution-details" title="Permalink to this heading">#</a></h3>
<p>First, define a “pseudo utility function”</p>
<div class="math notranslate nohighlight" id="equation-ts-cham17">
<span class="eqno">(42.13)<a class="headerlink" href="#equation-ts-cham17" title="Permalink to this equation">#</a></span>\[V\left[c_t(s^t), n_t(s^t), \Phi\right] =
u[c_t(s^t),1-n_t(s^t)] +
\Phi \left[ u_c(s^t) c_t(s^t) -
u_\ell(s^t) n_t(s^t) \right]\]</div>
<p>where <span class="math notranslate nohighlight">\(\Phi\)</span> is a Lagrange multiplier on the implementability condition <a class="reference internal" href="#equation-ts-bcpv2">(42.7)</a>.</p>
<p>Next form the Lagrangian</p>
<div class="math notranslate nohighlight" id="equation-ts-chamlag">
<span class="eqno">(42.14)<a class="headerlink" href="#equation-ts-chamlag" title="Permalink to this equation">#</a></span>\[J  = \sum_{t=0}^\infty
\sum_{s^t} \beta^t \pi_t(s^t)
\Bigl\{
    V[c_t(s^t), n_t(s^t), \Phi]   + \theta_t(s^t)
   \Bigl[ n_t(s^t) - c_t(s^t) - g_t(s_t) \Bigr]
\Bigr\} - \Phi u_c(0) b_0\]</div>
<p>where  <span class="math notranslate nohighlight">\(\{\theta_t(s^t); \forall s^t\}_{t\geq0}\)</span> is a sequence of Lagrange
multipliers on the feasible conditions <a class="reference internal" href="#equation-tss-techr-opt-tax">(42.2)</a>.</p>
<p>Given an initial government debt <span class="math notranslate nohighlight">\(b_0\)</span>,  we want to maximize <span class="math notranslate nohighlight">\(J\)</span>
with respect to <span class="math notranslate nohighlight">\(\{c_t(s^t), n_t(s^t); \forall s^t \}_{t\geq0}\)</span>   and to minimize with respect
to <span class="math notranslate nohighlight">\(\Phi\)</span> and with respect to <span class="math notranslate nohighlight">\(\{\theta(s^t); \forall s^t \}_{t\geq0}\)</span>.</p>
<p>The first-order conditions for the Ramsey problem for periods <span class="math notranslate nohighlight">\(t \geq 1\)</span> and <span class="math notranslate nohighlight">\(t=0\)</span>, respectively, are</p>
<div class="math notranslate nohighlight" id="equation-eqfoncramsey1">
<span class="eqno">(42.15)<a class="headerlink" href="#equation-eqfoncramsey1" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{aligned}
    c_t(s^t)\rm{:} &amp;
    \; (1+\Phi) u_c(s^t) + \Phi \left[u_{cc}(s^t) c_t(s^t) -
    u_{\ell c}(s^t) n_t(s^t) \right]  - \theta_t(s^t) = 0, \quad t \geq 1
    \\
    n_t(s^t)\rm{:} &amp;
    \; -(1+\Phi) u_{\ell}(s^t) - \Phi \left[u_{c\ell}(s^t) c_t(s^t) -
    u_{\ell \ell}(s^t) n_t(s^t) \right] + \theta_t(s^t) = 0, \quad t \geq 1
\end{aligned}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-eqfoncramsey0">
<span class="eqno">(42.16)<a class="headerlink" href="#equation-eqfoncramsey0" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{aligned}
    c_0(s^0, b_0)\rm{:} &amp;
    \; (1+\Phi) u_c(s^0, b_0) + \Phi \left[u_{cc}(s^0, b_0) c_0(s^0, b_0) -
    u_{\ell c}(s^0, b_0) n_0(s^0, b_0) \right]  - \theta_0(s^0, b_0)   \\
       &amp; \quad \quad \quad \quad \quad \quad  - \Phi u_{cc}(s^0, b_0) b_0 = 0
    \\
    n_0(s^0, b_0)\rm{:} &amp;
    \; -(1+\Phi) u_{\ell}(s^0, b_0) - \Phi \left[u_{c\ell}(s^0, b_0) c_0(s^0, b_0) -
    u_{\ell \ell}(s^0, b_0) n_0(s^0, b_0) \right] + \theta_0(s^0, b_0) \\
      &amp; \quad \quad \quad \quad \quad \quad + \Phi u_{c \ell}(s^0, b_0) b_0 = 0
\end{aligned}\end{split}\]</div>
<p>Please note how these first-order conditions differ between <span class="math notranslate nohighlight">\(t=0\)</span> and <span class="math notranslate nohighlight">\(t \geq 1\)</span>.</p>
<p>It is instructive to use first-order conditions <a class="reference internal" href="#equation-eqfoncramsey1">(42.15)</a> for
<span class="math notranslate nohighlight">\(t \geq 1\)</span> to eliminate the multipliers <span class="math notranslate nohighlight">\(\theta_t(s^t)\)</span>.</p>
<p>For convenience, we suppress the time subscript and the index <span class="math notranslate nohighlight">\(s^t\)</span> and obtain</p>
<div class="math notranslate nohighlight" id="equation-ts-barg">
<span class="eqno">(42.17)<a class="headerlink" href="#equation-ts-barg" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{aligned}
  (1+\Phi) &amp;u_c(c,1-c-g) + \Phi \bigl[c u_{cc}(c,1-c-g) -
  (c+g) u_{\ell c}(c,1-c-g) \bigr]
    \\
    &amp;= (1+\Phi) u_{\ell}(c,1-c-g) + \Phi \bigl[c u_{c\ell}(c,1-c-g) -
    (c+g) u_{\ell \ell}(c,1-c-g)  \bigr]
\end{aligned}\end{split}\]</div>
<p>where we have imposed conditions <a class="reference internal" href="#equation-feas1-opt-tax">(42.1)</a> and <a class="reference internal" href="#equation-tss-techr-opt-tax">(42.2)</a>.</p>
<p>Equation <a class="reference internal" href="#equation-ts-barg">(42.17)</a> is one equation that can be solved to express the
unknown <span class="math notranslate nohighlight">\(c\)</span> as a function of the  exogenous variable <span class="math notranslate nohighlight">\(g\)</span> and the Lagrange multiplier <span class="math notranslate nohighlight">\(\Phi\)</span>.</p>
<p>We also know that  time <span class="math notranslate nohighlight">\(t=0\)</span> quantities <span class="math notranslate nohighlight">\(c_0\)</span> and <span class="math notranslate nohighlight">\(n_0\)</span> satisfy</p>
<div class="math notranslate nohighlight" id="equation-ts-barg-aust">
<span class="eqno">(42.18)<a class="headerlink" href="#equation-ts-barg-aust" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{aligned}
      (1+\Phi) &amp;u_c(c,1-c-g) + \Phi \bigl[c u_{cc}(c,1-c-g) -
      (c+g) u_{\ell c}(c,1-c-g) \bigr]
        \\
        &amp;= (1+\Phi) u_{\ell}(c,1-c-g) + \Phi \bigl[c u_{c\ell}(c,1-c-g) -
        (c+g) u_{\ell \ell}(c,1-c-g)  \bigr] + \Phi (u_{cc} - u_{c,\ell}) b_0
\end{aligned}\end{split}\]</div>
<p>Notice that a counterpart to <span class="math notranslate nohighlight">\(b_0\)</span> does <em>not</em> appear
in <a class="reference internal" href="#equation-ts-barg">(42.17)</a>, so <span class="math notranslate nohighlight">\(c\)</span> does not <em>directly</em> depend on it for <span class="math notranslate nohighlight">\(t \geq 1\)</span>.</p>
<p>But things are different for time <span class="math notranslate nohighlight">\(t=0\)</span>.</p>
<p>An analogous argument for the <span class="math notranslate nohighlight">\(t=0\)</span> equations <a class="reference internal" href="#equation-eqfoncramsey0">(42.16)</a> leads
to one equation that can be solved for <span class="math notranslate nohighlight">\(c_0\)</span> as a function of the
pair <span class="math notranslate nohighlight">\((g(s_0), b_0)\)</span> and the Lagrange multiplier <span class="math notranslate nohighlight">\(\Phi\)</span>.</p>
<p>These outcomes mean that the following statement would be  true even when
government purchases are history-dependent functions <span class="math notranslate nohighlight">\(g_t(s^t)\)</span> of the
history of <span class="math notranslate nohighlight">\(s^t\)</span>.</p>
<p><strong>Proposition:</strong>
If government purchases are equal after two histories
<span class="math notranslate nohighlight">\(s^t\)</span> and <span class="math notranslate nohighlight">\(\tilde s^\tau\)</span> for <span class="math notranslate nohighlight">\(t,\tau\geq0\)</span>, i.e., if</p>
<div class="math notranslate nohighlight">
\[
g_t(s^t) = g^\tau(\tilde s^\tau) = g
\]</div>
<p>then it follows from <a class="reference internal" href="#equation-ts-barg">(42.17)</a> that the Ramsey  choices of consumption and leisure,
<span class="math notranslate nohighlight">\((c_t(s^t),\ell_t(s^t))\)</span> and <span class="math notranslate nohighlight">\((c_j(\tilde s^\tau),\ell_j(\tilde
s^\tau))\)</span>, are identical.</p>
<p>The proposition asserts that the optimal allocation is a function of the
currently realized quantity of government purchases <span class="math notranslate nohighlight">\(g\)</span> only and does
<em>not</em> depend on the specific history that preceded that realization of <span class="math notranslate nohighlight">\(g\)</span>.</p>
</section>
<section id="the-ramsey-allocation-for-a-given-multiplier">
<h3><span class="section-number">42.2.5. </span>The Ramsey Allocation for a Given Multiplier<a class="headerlink" href="#the-ramsey-allocation-for-a-given-multiplier" title="Permalink to this heading">#</a></h3>
<p>Temporarily take  <span class="math notranslate nohighlight">\(\Phi\)</span> as given.</p>
<p>We shall compute <span class="math notranslate nohighlight">\(c_0(s^0, b_0)\)</span> and <span class="math notranslate nohighlight">\(n_0(s^0, b_0)\)</span> from the first-order
conditions <a class="reference internal" href="#equation-eqfoncramsey0">(42.16)</a>.</p>
<p>Evidently, for <span class="math notranslate nohighlight">\(t \geq 1\)</span>, <span class="math notranslate nohighlight">\(c\)</span> and
<span class="math notranslate nohighlight">\(n\)</span> depend on the time <span class="math notranslate nohighlight">\(t\)</span> realization of <span class="math notranslate nohighlight">\(g\)</span> only.</p>
<p>But for <span class="math notranslate nohighlight">\(t=0\)</span>, <span class="math notranslate nohighlight">\(c\)</span> and <span class="math notranslate nohighlight">\(n\)</span>  depend on both <span class="math notranslate nohighlight">\(g_0\)</span> and the
government’s initial debt <span class="math notranslate nohighlight">\(b_0\)</span>.</p>
<p>Thus, while <span class="math notranslate nohighlight">\(b_0\)</span>
influences <span class="math notranslate nohighlight">\(c_0\)</span> and <span class="math notranslate nohighlight">\(n_0\)</span>, there appears no analogous
variable <span class="math notranslate nohighlight">\(b_t\)</span> that influences <span class="math notranslate nohighlight">\(c_t\)</span> and <span class="math notranslate nohighlight">\(n_t\)</span> for
<span class="math notranslate nohighlight">\(t \geq 1\)</span>.</p>
<p>The absence of <span class="math notranslate nohighlight">\(b_t\)</span> as a direct determinant of the  Ramsey allocation for
<span class="math notranslate nohighlight">\(t \geq 1\)</span> and its presence for <span class="math notranslate nohighlight">\(t=0\)</span> is a symptom of the
<em>time-inconsistency</em> of a Ramsey plan.</p>
<p>Of course, <span class="math notranslate nohighlight">\(b_0\)</span> affects the Ramsey allocation for <span class="math notranslate nohighlight">\(t \geq 1\)</span> <em>indirectly</em> through
its effect on <span class="math notranslate nohighlight">\(\Phi\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\Phi\)</span> has to take a value that assures that
the household and the government’s budget constraints are both
satisfied at a candidate Ramsey allocation and price system associated
with that <span class="math notranslate nohighlight">\(\Phi\)</span>.</p>
</section>
<section id="further-specialization">
<h3><span class="section-number">42.2.6. </span>Further Specialization<a class="headerlink" href="#further-specialization" title="Permalink to this heading">#</a></h3>
<p>At this point, it is useful to specialize the model in the following ways.</p>
<p>We assume that <span class="math notranslate nohighlight">\(s\)</span> is governed by a finite state Markov chain with states
<span class="math notranslate nohighlight">\(s\in [1, \ldots, S]\)</span> and transition matrix <span class="math notranslate nohighlight">\(\Pi\)</span>, where</p>
<div class="math notranslate nohighlight">
\[
\Pi(s'|s) = {\rm Prob}(s_{t+1} = s'| s_t =s)
\]</div>
<p>Also, assume that government purchases <span class="math notranslate nohighlight">\(g\)</span> are an exact time-invariant function
<span class="math notranslate nohighlight">\(g(s)\)</span> of <span class="math notranslate nohighlight">\(s\)</span>.</p>
<p>We maintain these assumptions throughout the remainder of this lecture.</p>
</section>
<section id="determining-the-lagrange-multiplier">
<h3><span class="section-number">42.2.7. </span>Determining the Lagrange Multiplier<a class="headerlink" href="#determining-the-lagrange-multiplier" title="Permalink to this heading">#</a></h3>
<p>We complete the Ramsey plan by computing the Lagrange multiplier <span class="math notranslate nohighlight">\(\Phi\)</span>
on the implementability constraint <a class="reference internal" href="#equation-tss-cham1">(42.11)</a>.</p>
<p>Government budget balance restricts <span class="math notranslate nohighlight">\(\Phi\)</span> via the following line of reasoning.</p>
<p>The household’s first-order conditions imply</p>
<div class="math notranslate nohighlight" id="equation-lsa-ta">
<span class="eqno">(42.19)<a class="headerlink" href="#equation-lsa-ta" title="Permalink to this equation">#</a></span>\[(1 - \tau_t(s^t)) = {\frac{u_l(s^t)}{u_c(s^t)} }\]</div>
<p>and the  implied one-period Arrow securities prices</p>
<div class="math notranslate nohighlight" id="equation-lsa-arro">
<span class="eqno">(42.20)<a class="headerlink" href="#equation-lsa-arro" title="Permalink to this equation">#</a></span>\[p_{t+1}(s_{t+1}| s^t) = \beta \Pi(s_{t+1} | s_t) {\frac{u_c(s^{t+1})}{u_c({s^t})}}\]</div>
<p>Substituting from  <a class="reference internal" href="#equation-lsa-ta">(42.19)</a>, <a class="reference internal" href="#equation-lsa-arro">(42.20)</a>, and the feasibility
condition <a class="reference internal" href="#equation-tss-techr-opt-tax">(42.2)</a>  into the recursive version <a class="reference internal" href="#equation-ts-bcr">(42.5)</a> of
the household budget constraint gives</p>
<div class="math notranslate nohighlight" id="equation-lsa-budget">
<span class="eqno">(42.21)<a class="headerlink" href="#equation-lsa-budget" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{aligned}
    u_c(s^t) [ n_t(s^t) - g_t(s^t)] +
    \beta \sum_{s_{t+1}} \Pi (s_{t+1}| s_t) u_c(s^{t+1}) b_{t+1}(s_{t+1} | s^t) \\ =
    u_l (s^t) n_t(s^t) + u_c(s^t) b_t(s_t | s^{t-1})
\end{aligned}\end{split}\]</div>
<p>Define <span class="math notranslate nohighlight">\(x_t(s^t) = u_c(s^t) b_t(s_t | s^{t-1})\)</span>.</p>
<p>Notice that <span class="math notranslate nohighlight">\(x_t(s^t)\)</span> appears on the right side of <a class="reference internal" href="#equation-lsa-budget">(42.21)</a> while
<span class="math notranslate nohighlight">\(\beta\)</span> times the conditional expectation of
<span class="math notranslate nohighlight">\(x_{t+1}(s^{t+1})\)</span> appears on the left side.</p>
<p>Hence the equation shares much of the structure of a simple asset pricing equation with
<span class="math notranslate nohighlight">\(x_t\)</span> being analogous to the price of the asset at time <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>We learned earlier that for a Ramsey allocation
<span class="math notranslate nohighlight">\(c_t(s^t), n_t(s^t)\)</span>, and <span class="math notranslate nohighlight">\(b_t(s_t|s^{t-1})\)</span>, and therefore
also <span class="math notranslate nohighlight">\(x_t(s^t)\)</span>, are each functions of <span class="math notranslate nohighlight">\(s_t\)</span> only,  being
independent of the history <span class="math notranslate nohighlight">\(s^{t-1}\)</span> for <span class="math notranslate nohighlight">\(t \geq 1\)</span>.</p>
<p>That means that we can express equation <a class="reference internal" href="#equation-lsa-budget">(42.21)</a> as</p>
<div class="math notranslate nohighlight" id="equation-lsa-budget2">
<span class="eqno">(42.22)<a class="headerlink" href="#equation-lsa-budget2" title="Permalink to this equation">#</a></span>\[u_c(s)
[ n(s) - g(s)]  + \beta
\sum_{s'} \Pi(s' | s) x'(s')  = u_l(s) n(s) + x(s)\]</div>
<p>where <span class="math notranslate nohighlight">\(s'\)</span> denotes a next period value of <span class="math notranslate nohighlight">\(s\)</span> and
<span class="math notranslate nohighlight">\(x'(s')\)</span> denotes a next period value of <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>Given <span class="math notranslate nohighlight">\(n(s)\)</span> for <span class="math notranslate nohighlight">\(s = 1, \ldots , S\)</span>, equation <a class="reference internal" href="#equation-lsa-budget2">(42.22)</a> is easy to solve for <span class="math notranslate nohighlight">\(x(s)\)</span> for
<span class="math notranslate nohighlight">\(s = 1, \ldots , S\)</span>.</p>
<p>If we let <span class="math notranslate nohighlight">\(\vec n, \vec g, \vec x\)</span>
denote <span class="math notranslate nohighlight">\(S \times 1\)</span> vectors whose <span class="math notranslate nohighlight">\(i\)</span>th elements are the
respective <span class="math notranslate nohighlight">\(n, g\)</span>, and <span class="math notranslate nohighlight">\(x\)</span> values when <span class="math notranslate nohighlight">\(s=i\)</span>, and let
<span class="math notranslate nohighlight">\(\Pi\)</span> be the transition matrix for the Markov state <span class="math notranslate nohighlight">\(s\)</span>,
then we can express <a class="reference internal" href="#equation-lsa-budget2">(42.22)</a> as the matrix equation</p>
<div class="math notranslate nohighlight" id="equation-lsa-budget20">
<span class="eqno">(42.23)<a class="headerlink" href="#equation-lsa-budget20" title="Permalink to this equation">#</a></span>\[\vec u_c(\vec n - \vec g) + \beta \Pi \vec x = \vec u_l \vec n + \vec x\]</div>
<p>This is a system of <span class="math notranslate nohighlight">\(S\)</span> linear equations in the <span class="math notranslate nohighlight">\(S \times 1\)</span>
vector <span class="math notranslate nohighlight">\(x\)</span>, whose solution is</p>
<div class="math notranslate nohighlight" id="equation-lsa-xsol">
<span class="eqno">(42.24)<a class="headerlink" href="#equation-lsa-xsol" title="Permalink to this equation">#</a></span>\[\vec x= (I - \beta \Pi )^{-1} [ \vec u_c (\vec n-\vec g) - \vec u_l \vec n]\]</div>
<p>In these equations, by <span class="math notranslate nohighlight">\(\vec u_c \vec n\)</span>, for example, we mean
element-by-element multiplication of the two vectors.</p>
<p>After solving for <span class="math notranslate nohighlight">\(\vec x\)</span>, we can find <span class="math notranslate nohighlight">\(b(s_t|s^{t-1})\)</span> in Markov
state <span class="math notranslate nohighlight">\(s_t=s\)</span> from <span class="math notranslate nohighlight">\(b(s) = {\frac{x(s)}{u_c(s)}}\)</span> or the matrix equation</p>
<div class="math notranslate nohighlight" id="equation-lsa-bsol">
<span class="eqno">(42.25)<a class="headerlink" href="#equation-lsa-bsol" title="Permalink to this equation">#</a></span>\[\vec b = {\frac{ \vec x }{\vec u_c}}\]</div>
<p>where division here means an element-by-element division of the respective
components of the <span class="math notranslate nohighlight">\(S \times 1\)</span> vectors <span class="math notranslate nohighlight">\(\vec x\)</span> and
<span class="math notranslate nohighlight">\(\vec u_c\)</span>.</p>
<p>Here is a computational algorithm:</p>
<ol class="arabic">
<li><p>Start with a guess for the value for <span class="math notranslate nohighlight">\(\Phi\)</span>, then use the
first-order conditions and the feasibility conditions to compute
<span class="math notranslate nohighlight">\(c(s_t), n(s_t)\)</span> for <span class="math notranslate nohighlight">\(s \in [1,\ldots, S]\)</span> and
<span class="math notranslate nohighlight">\(c_0(s_0,b_0)\)</span> and <span class="math notranslate nohighlight">\(n_0(s_0, b_0)\)</span>, given <span class="math notranslate nohighlight">\(\Phi\)</span>.</p>
<ul class="simple">
<li><p>these are <span class="math notranslate nohighlight">\(2  (S+1)\)</span> equations in <span class="math notranslate nohighlight">\(2  (S+1)\)</span> unknowns.</p></li>
</ul>
</li>
<li><p>Solve the <span class="math notranslate nohighlight">\(S\)</span> equations <a class="reference internal" href="#equation-lsa-xsol">(42.24)</a> for the <span class="math notranslate nohighlight">\(S\)</span> elements
of <span class="math notranslate nohighlight">\(\vec x\)</span>.</p>
<ul class="simple">
<li><p>these depend on <span class="math notranslate nohighlight">\(\Phi\)</span>.</p></li>
</ul>
</li>
<li><p>Find a <span class="math notranslate nohighlight">\(\Phi\)</span> that satisfies</p>
<div class="math notranslate nohighlight" id="equation-bellman2cons">
<span class="eqno">(42.26)<a class="headerlink" href="#equation-bellman2cons" title="Permalink to this equation">#</a></span>\[u_{c,0} b_0 = u_{c,0} (n_0 - g_0) - u_{l,0} n_0  + \beta \sum_{s=1}^S \Pi(s | s_0) x(s)\]</div>
<p>by gradually raising <span class="math notranslate nohighlight">\(\Phi\)</span> if the left side of <a class="reference internal" href="#equation-bellman2cons">(42.26)</a>
exceeds the right side and lowering <span class="math notranslate nohighlight">\(\Phi\)</span> if the left side is less than the right side.</p>
</li>
<li><p>After computing a Ramsey allocation,  recover the flat tax rate on
labor from <a class="reference internal" href="#equation-lsa-taxr">(42.8)</a> and the implied one-period Arrow securities
prices from <a class="reference internal" href="#equation-ls101">(42.9)</a>.</p></li>
</ol>
<p>In summary, when <span class="math notranslate nohighlight">\(g_t\)</span> is a time-invariant function of a Markov state
<span class="math notranslate nohighlight">\(s_t\)</span>, a Ramsey plan can be constructed by solving <span class="math notranslate nohighlight">\(3S +3\)</span>
equations for <span class="math notranslate nohighlight">\(S\)</span> components each of <span class="math notranslate nohighlight">\(\vec c\)</span>, <span class="math notranslate nohighlight">\(\vec n\)</span>, and
<span class="math notranslate nohighlight">\(\vec x\)</span> together with <span class="math notranslate nohighlight">\(n_0, c_0\)</span>, and <span class="math notranslate nohighlight">\(\Phi\)</span>.</p>
</section>
<section id="time-inconsistency">
<h3><span class="section-number">42.2.8. </span>Time Inconsistency<a class="headerlink" href="#time-inconsistency" title="Permalink to this heading">#</a></h3>
<p>Let <span class="math notranslate nohighlight">\(\{\tau_t(s^t)\}_{t=0}^\infty, \{b_{t+1}(s_{t+1}| s^t)\}_{t=0}^\infty\)</span>
be a time <span class="math notranslate nohighlight">\(0\)</span>, state <span class="math notranslate nohighlight">\(s_0\)</span> Ramsey plan.</p>
<p>Then <span class="math notranslate nohighlight">\(\{\tau_j(s^j)\}_{j=t}^\infty, \{b_{j+1}(s_{j+1}| s^j)\}_{j=t}^\infty\)</span>
is a time <span class="math notranslate nohighlight">\(t\)</span>, history <span class="math notranslate nohighlight">\(s^t\)</span> continuation of a time
<span class="math notranslate nohighlight">\(0\)</span>, state <span class="math notranslate nohighlight">\(s_0\)</span> Ramsey plan.</p>
<p>A time <span class="math notranslate nohighlight">\(t\)</span>, history <span class="math notranslate nohighlight">\(s^t\)</span> Ramsey plan is a Ramsey plan that
starts from initial conditions <span class="math notranslate nohighlight">\(s^t, b_t(s_t|s^{t-1})\)</span>.</p>
<p>A time <span class="math notranslate nohighlight">\(t\)</span>, history <span class="math notranslate nohighlight">\(s^t\)</span>
continuation of a time <span class="math notranslate nohighlight">\(0\)</span>, state <span class="math notranslate nohighlight">\(0\)</span> Ramsey plan is
<em>not</em> a time <span class="math notranslate nohighlight">\(t\)</span>, history <span class="math notranslate nohighlight">\(s^t\)</span> Ramsey plan.</p>
<p>The means that a Ramsey plan is <em>not time consistent</em>.</p>
<p>Another way to say the same thing is that a Ramsey plan is <em>time inconsistent</em>.</p>
<p>The reason is that a continuation Ramsey plan takes <span class="math notranslate nohighlight">\(u_{ct} b_t(s_t|s^{t-1})\)</span> as given, not
<span class="math notranslate nohighlight">\(b_t(s_t|s^{t-1})\)</span>.</p>
<p>We shall discuss this more below.</p>
</section>
<section id="specification-with-crra-utility">
<h3><span class="section-number">42.2.9. </span>Specification with CRRA Utility<a class="headerlink" href="#specification-with-crra-utility" title="Permalink to this heading">#</a></h3>
<p>In our calculations below and in a <a class="reference internal" href="amss.html"><span class="doc">subsequent lecture</span></a> based on an <em>extension</em> of the Lucas-Stokey model
by  Aiyagari, Marcet, Sargent, and Seppälä (2002) <span id="id2">[<a class="reference internal" href="zreferences.html#id130" title="S Rao Aiyagari, Albert Marcet, Thomas J Sargent, and Juha Seppälä. Optimal taxation without state-contingent debt. Journal of Political Economy, 110(6):1220–1254, 2002.">AMSSeppala02</a>]</span>, we shall modify the one-period utility function assumed above.</p>
<p>(We adopted the preceding utility specification because it was the one used in  the original Lucas-Stokey paper <span id="id3">[<a class="reference internal" href="zreferences.html#id176" title="Robert E Lucas, Jr. and Nancy L Stokey. Optimal Fiscal and Monetary Policy in an Economy without Capital. Journal of monetary Economics, 12(3):55–93, 1983.">LS83</a>]</span>. We shall soon  revert to that specification in a subsequent section.)</p>
<p>We will  modify their specification by instead assuming that the  representative agent has  utility function</p>
<div class="math notranslate nohighlight">
\[
u(c,n) = {\frac{c^{1-\sigma}}{1-\sigma}} - {\frac{n^{1+\gamma}}{1+\gamma}}
\]</div>
<p>where  <span class="math notranslate nohighlight">\(\sigma &gt; 0\)</span>, <span class="math notranslate nohighlight">\(\gamma &gt;0\)</span>.</p>
<p>We continue to assume that</p>
<div class="math notranslate nohighlight">
\[
c_t + g_t = n_t
\]</div>
<p>We eliminate leisure from the model.</p>
<p>We also eliminate Lucas and Stokey’s restriction that <span class="math notranslate nohighlight">\(\ell_t + n_t \leq 1\)</span>.</p>
<p>We replace these two things with the assumption that
labor <span class="math notranslate nohighlight">\(n_t \in [0, +\infty]\)</span>.</p>
<p>With these adjustments, the analysis of Lucas and Stokey prevails once we make the following replacements</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
u_\ell(c, \ell) &amp;\sim - u_n(c, n) \\
u_c(c,\ell) &amp;\sim u_c(c,n) \\
u_{\ell,\ell}(c,\ell) &amp;\sim u_{nn}(c,n) \\
u_{c,c}(c,\ell)&amp; \sim u_{c,c}(c,n) \\
u_{c,\ell} (c,\ell) &amp;\sim 0
\end{aligned}
\end{split}\]</div>
<p>With these understandings, equations <a class="reference internal" href="#equation-ts-barg">(42.17)</a> and <a class="reference internal" href="#equation-ts-barg-aust">(42.18)</a> simplify in the case of the CRRA utility function.</p>
<p>They become</p>
<div class="math notranslate nohighlight" id="equation-ts-barg10">
<span class="eqno">(42.27)<a class="headerlink" href="#equation-ts-barg10" title="Permalink to this equation">#</a></span>\[(1+\Phi) [u_c(c) + u_n(c+g)] + \Phi[c u_{cc}(c) + (c+g) u_{nn}(c+g)] = 0\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-ts-barg11">
<span class="eqno">(42.28)<a class="headerlink" href="#equation-ts-barg11" title="Permalink to this equation">#</a></span>\[(1+\Phi) [u_c(c_0) + u_n(c_0+g_0)] + \Phi[c_0 u_{cc}(c_0) + (c_0+g_0) u_{nn}(c_0+g_0)] - \Phi u_{cc}(c_0) b_0 = 0\]</div>
<p>In equation <a class="reference internal" href="#equation-ts-barg10">(42.27)</a>, it is understood that <span class="math notranslate nohighlight">\(c\)</span> and <span class="math notranslate nohighlight">\(g\)</span> are each functions of the Markov state <span class="math notranslate nohighlight">\(s\)</span>.</p>
<p>In addition, the time <span class="math notranslate nohighlight">\(t=0\)</span> budget constraint is satisfied at <span class="math notranslate nohighlight">\(c_0\)</span> and initial government debt
<span class="math notranslate nohighlight">\(b_0\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-opt-tax-eqn-10">
<span class="eqno">(42.29)<a class="headerlink" href="#equation-opt-tax-eqn-10" title="Permalink to this equation">#</a></span>\[b_0 + g_0 = \tau_0 (c_0 + g_0) + \beta  \sum_{s=1}^S \Pi(s | s_0) \frac{u_c(s)}{u_{c,0}} b_1(s)\]</div>
<p>where <span class="math notranslate nohighlight">\(\tau_0\)</span> is the time <span class="math notranslate nohighlight">\(t=0\)</span> tax rate.</p>
<p>In equation <a class="reference internal" href="#equation-opt-tax-eqn-10">(42.29)</a>, it is understood that</p>
<div class="math notranslate nohighlight">
\[
\begin{aligned}
\tau_0 = 1 - \frac{u_{l,0}}{u_{c,0}}
\end{aligned}
\]</div>
</section>
<section id="sequence-implementation">
<h3><span class="section-number">42.2.10. </span>Sequence Implementation<a class="headerlink" href="#sequence-implementation" title="Permalink to this heading">#</a></h3>
<p>The above steps are implemented in a class called SequentialLS</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SequentialLS</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Class that takes a preference object, state transition matrix,</span>
<span class="sd">    and state contingent government expenditure plan as inputs, and</span>
<span class="sd">    solves the sequential allocation problem described above.</span>
<span class="sd">    It returns optimal allocations about consumption and labor supply,</span>
<span class="sd">    as well as the multiplier on the implementability constraint Φ.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">pref</span><span class="p">,</span>
                 <span class="n">π</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">),</span>
                 <span class="n">g</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])):</span>

        <span class="c1"># Initialize from pref object attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">β</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">π</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="n">pref</span><span class="o">.</span><span class="n">β</span><span class="p">,</span> <span class="n">π</span><span class="p">,</span> <span class="n">g</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mc</span> <span class="o">=</span> <span class="n">MarkovChain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">π</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">S</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">π</span><span class="p">)</span>  <span class="c1"># Number of states</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pref</span> <span class="o">=</span> <span class="n">pref</span>

        <span class="c1"># Find the first best allocation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_first_best</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">FOC_first_best</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        First order conditions that characterize</span>
<span class="sd">        the first best allocation.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">pref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref</span>
        <span class="n">Uc</span><span class="p">,</span> <span class="n">Ul</span> <span class="o">=</span> <span class="n">pref</span><span class="o">.</span><span class="n">Uc</span><span class="p">,</span> <span class="n">pref</span><span class="o">.</span><span class="n">Ul</span>

        <span class="n">n</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">g</span>
        <span class="n">l</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">n</span>

        <span class="k">return</span> <span class="n">Uc</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="o">-</span> <span class="n">Ul</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">find_first_best</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Find the first best allocation</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">S</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">root</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOC_first_best</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">g</span><span class="p">,))</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">fun</span> <span class="o">&gt;</span> <span class="mf">1e-10</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Could not find first best&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cFB</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nFB</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cFB</span> <span class="o">+</span> <span class="n">g</span>

    <span class="k">def</span> <span class="nf">FOC_time1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">Φ</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        First order conditions that characterize</span>
<span class="sd">        optimal time 1 allocation problems.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">pref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref</span>
        <span class="n">Uc</span><span class="p">,</span> <span class="n">Ucc</span><span class="p">,</span> <span class="n">Ul</span><span class="p">,</span> <span class="n">Ull</span><span class="p">,</span> <span class="n">Ulc</span> <span class="o">=</span> <span class="n">pref</span><span class="o">.</span><span class="n">Uc</span><span class="p">,</span> <span class="n">pref</span><span class="o">.</span><span class="n">Ucc</span><span class="p">,</span> <span class="n">pref</span><span class="o">.</span><span class="n">Ul</span><span class="p">,</span> <span class="n">pref</span><span class="o">.</span><span class="n">Ull</span><span class="p">,</span> <span class="n">pref</span><span class="o">.</span><span class="n">Ulc</span>

        <span class="n">n</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">g</span>
        <span class="n">l</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">n</span>

        <span class="n">LHS</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Φ</span><span class="p">)</span> <span class="o">*</span> <span class="n">Uc</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="n">Φ</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">Ucc</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span> <span class="o">*</span> <span class="n">Ulc</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">))</span>
        <span class="n">RHS</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Φ</span><span class="p">)</span> <span class="o">*</span> <span class="n">Ul</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="n">Φ</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">Ulc</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span> <span class="o">*</span> <span class="n">Ull</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">))</span>

        <span class="n">diff</span> <span class="o">=</span> <span class="n">LHS</span> <span class="o">-</span> <span class="n">RHS</span>

        <span class="k">return</span> <span class="n">diff</span>

    <span class="k">def</span> <span class="nf">time1_allocation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Φ</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes optimal allocation for time t &gt;= 1 for a given Φ</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">pref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref</span>
        <span class="n">S</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span>

        <span class="c1"># use the first best allocation as intial guess</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">root</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOC_time1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cFB</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">Φ</span><span class="p">,</span> <span class="n">g</span><span class="p">))</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">fun</span> <span class="o">&gt;</span> <span class="mf">1e-10</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Could not find LS allocation.&#39;</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">g</span>
        <span class="n">l</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">n</span>

        <span class="c1"># Compute x</span>
        <span class="n">I</span> <span class="o">=</span> <span class="n">pref</span><span class="o">.</span><span class="n">Uc</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">c</span> <span class="o">-</span> <span class="n">pref</span><span class="o">.</span><span class="n">Ul</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="o">*</span> <span class="n">n</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">β</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">π</span><span class="p">,</span> <span class="n">I</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">c</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">x</span>

    <span class="k">def</span> <span class="nf">FOC_time0</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">Φ</span><span class="p">,</span> <span class="n">g0</span><span class="p">,</span> <span class="n">b0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        First order conditions that characterize</span>
<span class="sd">        time 0 allocation problem.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">pref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref</span>
        <span class="n">Ucc</span><span class="p">,</span> <span class="n">Ulc</span> <span class="o">=</span> <span class="n">pref</span><span class="o">.</span><span class="n">Ucc</span><span class="p">,</span> <span class="n">pref</span><span class="o">.</span><span class="n">Ulc</span>

        <span class="n">n0</span> <span class="o">=</span> <span class="n">c0</span> <span class="o">+</span> <span class="n">g0</span>
        <span class="n">l0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">n0</span>

        <span class="n">diff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FOC_time1</span><span class="p">(</span><span class="n">c0</span><span class="p">,</span> <span class="n">Φ</span><span class="p">,</span> <span class="n">g0</span><span class="p">)</span>
        <span class="n">diff</span> <span class="o">-=</span> <span class="n">Φ</span> <span class="o">*</span> <span class="p">(</span><span class="n">Ucc</span><span class="p">(</span><span class="n">c0</span><span class="p">,</span> <span class="n">l0</span><span class="p">)</span> <span class="o">-</span> <span class="n">Ulc</span><span class="p">(</span><span class="n">c0</span><span class="p">,</span> <span class="n">l0</span><span class="p">))</span> <span class="o">*</span> <span class="n">b0</span>

        <span class="k">return</span> <span class="n">diff</span>

    <span class="k">def</span> <span class="nf">implementability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Φ</span><span class="p">,</span> <span class="n">b0</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">cn0_arr</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Compute the differences between the RHS and LHS</span>
<span class="sd">        of the implementability constraint given Φ,</span>
<span class="sd">        initial debt, and initial state.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">pref</span><span class="p">,</span> <span class="n">π</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">β</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">π</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">β</span>
        <span class="n">Uc</span><span class="p">,</span> <span class="n">Ul</span> <span class="o">=</span> <span class="n">pref</span><span class="o">.</span><span class="n">Uc</span><span class="p">,</span> <span class="n">pref</span><span class="o">.</span><span class="n">Ul</span>
        <span class="n">g0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">[</span><span class="n">s0</span><span class="p">]</span>

        <span class="n">c</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time1_allocation</span><span class="p">(</span><span class="n">Φ</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">root</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOC_time0</span><span class="p">,</span> <span class="n">cn0_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">Φ</span><span class="p">,</span> <span class="n">g0</span><span class="p">,</span> <span class="n">b0</span><span class="p">))</span>
        <span class="n">c0</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span>
        <span class="n">n0</span> <span class="o">=</span> <span class="n">c0</span> <span class="o">+</span> <span class="n">g0</span>
        <span class="n">l0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">n0</span>

        <span class="n">cn0_arr</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">c0</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="n">n0</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

        <span class="n">LHS</span> <span class="o">=</span> <span class="n">Uc</span><span class="p">(</span><span class="n">c0</span><span class="p">,</span> <span class="n">l0</span><span class="p">)</span> <span class="o">*</span> <span class="n">b0</span>
        <span class="n">RHS</span> <span class="o">=</span> <span class="n">Uc</span><span class="p">(</span><span class="n">c0</span><span class="p">,</span> <span class="n">l0</span><span class="p">)</span> <span class="o">*</span> <span class="n">c0</span> <span class="o">-</span> <span class="n">Ul</span><span class="p">(</span><span class="n">c0</span><span class="p">,</span> <span class="n">l0</span><span class="p">)</span> <span class="o">*</span> <span class="n">n0</span> <span class="o">+</span> <span class="n">β</span> <span class="o">*</span> <span class="n">π</span><span class="p">[</span><span class="n">s0</span><span class="p">]</span> <span class="o">@</span> <span class="n">x</span>

        <span class="k">return</span> <span class="n">RHS</span> <span class="o">-</span> <span class="n">LHS</span>

    <span class="k">def</span> <span class="nf">time0_allocation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b0</span><span class="p">,</span> <span class="n">s0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Finds the optimal time 0 allocation given</span>
<span class="sd">        initial government debt b0 and state s0</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># use the first best allocation as initial guess</span>
        <span class="n">cn0_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">cFB</span><span class="p">[</span><span class="n">s0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nFB</span><span class="p">[</span><span class="n">s0</span><span class="p">]])</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">root</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">implementability</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">b0</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">cn0_arr</span><span class="p">))</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">fun</span> <span class="o">&gt;</span> <span class="mf">1e-10</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Could not find time 0 LS allocation.&#39;</span><span class="p">)</span>

        <span class="n">Φ</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">c0</span><span class="p">,</span> <span class="n">n0</span> <span class="o">=</span> <span class="n">cn0_arr</span>

        <span class="k">return</span> <span class="n">Φ</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">n0</span>

    <span class="k">def</span> <span class="nf">τ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes τ given c, n</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">pref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref</span>
        <span class="n">Uc</span><span class="p">,</span> <span class="n">Ul</span> <span class="o">=</span> <span class="n">pref</span><span class="o">.</span><span class="n">Uc</span><span class="p">,</span> <span class="n">pref</span><span class="o">.</span><span class="n">Ul</span>

        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">Ul</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="n">Uc</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">n</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b0</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">sHist</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Simulates planners policies for T periods</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">pref</span><span class="p">,</span> <span class="n">π</span><span class="p">,</span> <span class="n">β</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">π</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">β</span>
        <span class="n">Uc</span> <span class="o">=</span> <span class="n">pref</span><span class="o">.</span><span class="n">Uc</span>

        <span class="k">if</span> <span class="n">sHist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sHist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">s0</span><span class="p">)</span>

        <span class="n">cHist</span><span class="p">,</span> <span class="n">nHist</span><span class="p">,</span> <span class="n">Bhist</span><span class="p">,</span> <span class="n">τHist</span><span class="p">,</span> <span class="n">ΦHist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="n">T</span><span class="p">))</span>
        <span class="n">RHist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Time 0</span>
        <span class="n">Φ</span><span class="p">,</span> <span class="n">cHist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nHist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time0_allocation</span><span class="p">(</span><span class="n">b0</span><span class="p">,</span> <span class="n">s0</span><span class="p">)</span>
        <span class="n">τHist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">τ</span><span class="p">(</span><span class="n">cHist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nHist</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Bhist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">b0</span>
        <span class="n">ΦHist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Φ</span>

        <span class="c1"># Time 1 onward</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
            <span class="n">c</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time1_allocation</span><span class="p">(</span><span class="n">Φ</span><span class="p">)</span>
            <span class="n">τ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">τ</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            <span class="n">u_c</span> <span class="o">=</span> <span class="n">Uc</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">n</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">sHist</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
            <span class="n">Eu_c</span> <span class="o">=</span> <span class="n">π</span><span class="p">[</span><span class="n">sHist</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">@</span> <span class="n">u_c</span>
            <span class="n">cHist</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">nHist</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">Bhist</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">τHist</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="n">s</span><span class="p">],</span> <span class="n">n</span><span class="p">[</span><span class="n">s</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">/</span> <span class="n">u_c</span><span class="p">[</span><span class="n">s</span><span class="p">],</span> <span class="n">τ</span><span class="p">[</span><span class="n">s</span><span class="p">]</span>
            <span class="n">RHist</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Uc</span><span class="p">(</span><span class="n">cHist</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="o">-</span><span class="n">nHist</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">β</span> <span class="o">*</span> <span class="n">Eu_c</span><span class="p">)</span>
            <span class="n">ΦHist</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">Φ</span>

        <span class="n">gHist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">[</span><span class="n">sHist</span><span class="p">]</span>
        <span class="n">yHist</span> <span class="o">=</span> <span class="n">nHist</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">cHist</span><span class="p">,</span> <span class="n">nHist</span><span class="p">,</span> <span class="n">Bhist</span><span class="p">,</span> <span class="n">τHist</span><span class="p">,</span> <span class="n">gHist</span><span class="p">,</span> <span class="n">yHist</span><span class="p">,</span> <span class="n">sHist</span><span class="p">,</span> <span class="n">ΦHist</span><span class="p">,</span> <span class="n">RHist</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="recursive-formulation-of-the-ramsey-problem">
<h2><a class="toc-backref" href="#id8"><span class="section-number">42.3. </span>Recursive Formulation of the Ramsey Problem</a><a class="headerlink" href="#recursive-formulation-of-the-ramsey-problem" title="Permalink to this heading">#</a></h2>
<p>We now temporarily revert to Lucas and Stokey’s specification.</p>
<p>We start by noting that <span class="math notranslate nohighlight">\(x_t(s^t) = u_c(s^t) b_t(s_t | s^{t-1})\)</span> in equation <a class="reference internal" href="#equation-lsa-budget">(42.21)</a>
appears to be a purely “forward-looking” variable.</p>
<p>But <span class="math notranslate nohighlight">\(x_t(s^t)\)</span> is  a  natural candidate for a state variable in
a recursive formulation of the Ramsey problem, one that records history-dependence and so is
<code class="docutils literal notranslate"><span class="pre">backward-looking</span></code>.</p>
<section id="intertemporal-delegation">
<h3><span class="section-number">42.3.1. </span>Intertemporal Delegation<a class="headerlink" href="#intertemporal-delegation" title="Permalink to this heading">#</a></h3>
<p>To express a Ramsey plan recursively, we imagine that a time <span class="math notranslate nohighlight">\(0\)</span>
Ramsey planner is followed by a sequence of continuation Ramsey planners
at times <span class="math notranslate nohighlight">\(t = 1, 2, \ldots\)</span>.</p>
<p>A “continuation Ramsey planner” at time <span class="math notranslate nohighlight">\(t \geq 1\)</span> has a
different objective function and faces different constraints and state variables than does the
Ramsey planner at time <span class="math notranslate nohighlight">\(t =0\)</span>.</p>
<p>A key step in representing a Ramsey plan recursively is
to regard the marginal utility scaled government debts
<span class="math notranslate nohighlight">\(x_t(s^t) = u_c(s^t) b_t(s_t|s^{t-1})\)</span> as predetermined quantities
that continuation Ramsey planners at times <span class="math notranslate nohighlight">\(t \geq 1\)</span> are
obligated to attain.</p>
<p>Continuation Ramsey planners do this by choosing continuation policies that induce the representative
household to make choices that imply that <span class="math notranslate nohighlight">\(u_c(s^t) b_t(s_t|s^{t-1})= x_t(s^t)\)</span>.</p>
<p>A time <span class="math notranslate nohighlight">\(t \geq 1\)</span> continuation Ramsey planner faces <span class="math notranslate nohighlight">\(x_t, s_t\)</span> as
state variables.</p>
<p>A time <span class="math notranslate nohighlight">\(t\geq 1\)</span> continuation Ramsey planner
delivers <span class="math notranslate nohighlight">\(x_t\)</span> by choosing a suitable <span class="math notranslate nohighlight">\(n_t, c_t\)</span> pair and a list of
<span class="math notranslate nohighlight">\(s_{t+1}\)</span>-contingent continuation quantities <span class="math notranslate nohighlight">\(x_{t+1}\)</span> to
bequeath to a time <span class="math notranslate nohighlight">\(t+1\)</span> continuation Ramsey planner.</p>
<p>While a time <span class="math notranslate nohighlight">\(t \geq 1\)</span> continuation Ramsey planner faces <span class="math notranslate nohighlight">\(x_t, s_t\)</span> as
state variables,  the time <span class="math notranslate nohighlight">\(0\)</span> Ramsey planner faces <span class="math notranslate nohighlight">\(b_0\)</span>, not <span class="math notranslate nohighlight">\(x_0\)</span>,
as a state variable.</p>
<p>Furthermore, the Ramsey planner cares about <span class="math notranslate nohighlight">\((c_0(s_0), \ell_0(s_0))\)</span>, while
continuation Ramsey planners do not.</p>
<p>The time <span class="math notranslate nohighlight">\(0\)</span> Ramsey planner
hands a state-contingent function that make <span class="math notranslate nohighlight">\(x_1\)</span> a function of <span class="math notranslate nohighlight">\(s_1\)</span> to a time <span class="math notranslate nohighlight">\(1\)</span>, state <span class="math notranslate nohighlight">\(s_1\)</span>
continuation Ramsey planner.</p>
<p>These lines of delegated authorities and
responsibilities across time express the continuation Ramsey planners’
obligations to implement their parts of an original Ramsey plan that had been
designed once-and-for-all at time <span class="math notranslate nohighlight">\(0\)</span>.</p>
</section>
<section id="two-bellman-equations">
<h3><span class="section-number">42.3.2. </span>Two Bellman Equations<a class="headerlink" href="#two-bellman-equations" title="Permalink to this heading">#</a></h3>
<p>After <span class="math notranslate nohighlight">\(s_t\)</span> has been realized at time <span class="math notranslate nohighlight">\(t \geq 1\)</span>, the state
variables confronting the time <span class="math notranslate nohighlight">\(t\)</span> <strong>continuation Ramsey planner</strong> are
<span class="math notranslate nohighlight">\((x_t, s_t)\)</span>.</p>
<ul class="simple">
<li><p>Let <span class="math notranslate nohighlight">\(V(x, s)\)</span> be the value of a <strong>continuation Ramsey plan</strong> at <span class="math notranslate nohighlight">\(x_t = x, s_t =s\)</span> for <span class="math notranslate nohighlight">\(t \geq 1\)</span>.</p></li>
<li><p>Let <span class="math notranslate nohighlight">\(W(b, s)\)</span> be the value of a <strong>Ramsey plan</strong> at time <span class="math notranslate nohighlight">\(0\)</span> at <span class="math notranslate nohighlight">\(b_0=b\)</span> and <span class="math notranslate nohighlight">\(s_0 = s\)</span>.</p></li>
</ul>
<p>We work backward by preparing a Bellman equation for
<span class="math notranslate nohighlight">\(V(x,s)\)</span> first, then a Bellman equation for <span class="math notranslate nohighlight">\(W(b,s)\)</span>.</p>
</section>
<section id="the-continuation-ramsey-problem">
<h3><span class="section-number">42.3.3. </span>The Continuation Ramsey Problem<a class="headerlink" href="#the-continuation-ramsey-problem" title="Permalink to this heading">#</a></h3>
<p>The Bellman equation for a time <span class="math notranslate nohighlight">\(t \geq 1\)</span> continuation Ramsey
planner is</p>
<div class="math notranslate nohighlight" id="equation-lsa-bellman1">
<span class="eqno">(42.30)<a class="headerlink" href="#equation-lsa-bellman1" title="Permalink to this equation">#</a></span>\[V(x, s) = \max_{n, \{x'(s')\}} u(n-g(s), 1-n) + \beta \sum_{s'\in S} \Pi(s'| s) V(x', s')\]</div>
<p>where maximization over <span class="math notranslate nohighlight">\(n\)</span> and the <span class="math notranslate nohighlight">\(S\)</span> elements of
<span class="math notranslate nohighlight">\(x'(s')\)</span> is subject to the single implementability constraint for
<span class="math notranslate nohighlight">\(t \geq 1\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-lsa-bellman1cons">
<span class="eqno">(42.31)<a class="headerlink" href="#equation-lsa-bellman1cons" title="Permalink to this equation">#</a></span>\[x = u_c(n-g(s)) -  u_l n + \beta \sum_{s' \in {\cal S}} \Pi(s' | s) x'(s')\]</div>
<p>Here <span class="math notranslate nohighlight">\(u_c\)</span> and <span class="math notranslate nohighlight">\(u_l\)</span> are today’s values of the marginal utilities.</p>
<p>For each given value of <span class="math notranslate nohighlight">\(x, s\)</span>, the continuation Ramsey planner chooses <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(x'(s')\)</span>
for each <span class="math notranslate nohighlight">\(s' \in {\cal S}\)</span>.</p>
<p>Associated with a value function <span class="math notranslate nohighlight">\(V(x,s)\)</span> that solves Bellman equation <a class="reference internal" href="#equation-lsa-bellman1">(42.30)</a>
are <span class="math notranslate nohighlight">\(S+1\)</span> time-invariant policy functions</p>
<div class="math notranslate nohighlight" id="equation-rrpolicyt">
<span class="eqno">(42.32)<a class="headerlink" href="#equation-rrpolicyt" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{aligned}
    n_t &amp; = f(x_t, s_t), \quad t \geq 1
    \\
    x_{t+1}(s_{t+1}) &amp; = h(s_{t+1}; x_t, s_t), \, s_{t+1} \in  {\cal S}, \, t \geq 1
\end{aligned}\end{split}\]</div>
</section>
<section id="the-ramsey-problem">
<h3><span class="section-number">42.3.4. </span>The Ramsey Problem<a class="headerlink" href="#the-ramsey-problem" title="Permalink to this heading">#</a></h3>
<p>The Bellman equation of  the time <span class="math notranslate nohighlight">\(0\)</span> Ramsey planner is</p>
<div class="math notranslate nohighlight" id="equation-lsa-bellman2">
<span class="eqno">(42.33)<a class="headerlink" href="#equation-lsa-bellman2" title="Permalink to this equation">#</a></span>\[W(b_0, s_0) = \max_{n_0, \{x'(s_1)\}} u(n_0 - g_0, 1 - n_0) + \beta \sum_{s_1 \in {\cal S}} \Pi(s_1| s_0) V( x'(s_1), s_1)\]</div>
<p>where maximization over <span class="math notranslate nohighlight">\(n_0\)</span> and the <span class="math notranslate nohighlight">\(S\)</span> elements of
<span class="math notranslate nohighlight">\(x'(s_1)\)</span> is subject to the time <span class="math notranslate nohighlight">\(0\)</span> implementability
constraint</p>
<div class="math notranslate nohighlight" id="equation-bellman2cons2">
<span class="eqno">(42.34)<a class="headerlink" href="#equation-bellman2cons2" title="Permalink to this equation">#</a></span>\[u_{c,0} b_0 = u_{c,0} (n_0 - g_0) - u_{l,0} n_0  + \beta \sum_{s_1\in {\cal S}} \Pi(s_1 | s_0) x'(s_1)\]</div>
<p>coming from restriction <a class="reference internal" href="#equation-bellman2cons">(42.26)</a>.</p>
<p>Associated with a value function <span class="math notranslate nohighlight">\(W(b_0, n_0)\)</span> that solves  Bellman equation <a class="reference internal" href="#equation-lsa-bellman2">(42.33)</a> are
<span class="math notranslate nohighlight">\(S +1\)</span> time <span class="math notranslate nohighlight">\(0\)</span> policy functions</p>
<div class="math notranslate nohighlight" id="equation-rrpolicy0">
<span class="eqno">(42.35)<a class="headerlink" href="#equation-rrpolicy0" title="Permalink to this equation">#</a></span>\[\begin{aligned}
    n_0
        &amp; = f_0(b_0, s_0) \cr
    x_1(s_1)
        &amp; = h_0(s_1; b_0, s_0)
\end{aligned}\]</div>
<p>Notice the appearance of state variables <span class="math notranslate nohighlight">\((b_0, s_0)\)</span> in the time
<span class="math notranslate nohighlight">\(0\)</span> policy functions for the Ramsey planner as compared to
<span class="math notranslate nohighlight">\((x_t, s_t)\)</span> in the policy functions <a class="reference internal" href="#equation-rrpolicyt">(42.32)</a> for the time <span class="math notranslate nohighlight">\(t \geq 1\)</span>
continuation Ramsey planners.</p>
<p>The value function <span class="math notranslate nohighlight">\(V(x_t, s_t)\)</span> of the time <span class="math notranslate nohighlight">\(t\)</span>
continuation Ramsey planner equals
<span class="math notranslate nohighlight">\(E_t \sum_{\tau = t}^\infty \beta^{\tau - t} u(c_\tau, l_\tau)\)</span>, where
consumption and leisure processes are evaluated along the original
time <span class="math notranslate nohighlight">\(0\)</span> Ramsey plan.</p>
</section>
<section id="first-order-conditions">
<h3><span class="section-number">42.3.5. </span>First-Order Conditions<a class="headerlink" href="#first-order-conditions" title="Permalink to this heading">#</a></h3>
<p>Attach a Lagrange multiplier <span class="math notranslate nohighlight">\(\Phi_1(x,s)\)</span> to constraint <a class="reference internal" href="#equation-lsa-bellman1cons">(42.31)</a> and a
Lagrange multiplier <span class="math notranslate nohighlight">\(\Phi_0\)</span> to constraint <a class="reference internal" href="#equation-bellman2cons">(42.26)</a>.</p>
<p>Time <span class="math notranslate nohighlight">\(t \geq 1\)</span>: First-order conditions for the time <span class="math notranslate nohighlight">\(t \geq 1\)</span> constrained
maximization problem on the right side of the continuation Ramsey
planner’s Bellman equation <a class="reference internal" href="#equation-lsa-bellman1">(42.30)</a> are</p>
<div class="math notranslate nohighlight" id="equation-lsarxt">
<span class="eqno">(42.36)<a class="headerlink" href="#equation-lsarxt" title="Permalink to this equation">#</a></span>\[\beta \Pi(s' | s) V_x (x', s') - \beta \Pi(s' | s) \Phi_1 = 0\]</div>
<p>for <span class="math notranslate nohighlight">\(x'(s')\)</span> and</p>
<div class="math notranslate nohighlight" id="equation-lsarnt">
<span class="eqno">(42.37)<a class="headerlink" href="#equation-lsarnt" title="Permalink to this equation">#</a></span>\[(1 + \Phi_1) (u_c - u_l ) + \Phi_1 \left[ n (u_{ll} - u_{lc}) + (n-g(s)) (u_{cc} - u_{lc})  \right] = 0\]</div>
<p>for <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>Given <span class="math notranslate nohighlight">\(\Phi_1\)</span>, equation <a class="reference internal" href="#equation-lsarnt">(42.37)</a> is one equation to be
solved for <span class="math notranslate nohighlight">\(n\)</span> as a function of <span class="math notranslate nohighlight">\(s\)</span> (or of <span class="math notranslate nohighlight">\(g(s)\)</span>).</p>
<p>Equation <a class="reference internal" href="#equation-lsarxt">(42.36)</a> implies <span class="math notranslate nohighlight">\(V_x(x', s')= \Phi_1\)</span>, while an envelope
condition is <span class="math notranslate nohighlight">\(V_x(x,s) = \Phi_1\)</span>, so it follows that</p>
<div class="math notranslate nohighlight" id="equation-lsaenv">
<span class="eqno">(42.38)<a class="headerlink" href="#equation-lsaenv" title="Permalink to this equation">#</a></span>\[V_x(x', s') = V_x(x,s) = \Phi_1(x,s)\]</div>
<p>Time <span class="math notranslate nohighlight">\(t=0\)</span>: For the time <span class="math notranslate nohighlight">\(0\)</span> problem on the right side of the Ramsey planner’s
Bellman equation <a class="reference internal" href="#equation-lsa-bellman2">(42.33)</a>,  first-order conditions are</p>
<div class="math notranslate nohighlight" id="equation-lsax0">
<span class="eqno">(42.39)<a class="headerlink" href="#equation-lsax0" title="Permalink to this equation">#</a></span>\[V_x(x(s_1), s_1) = \Phi_0\]</div>
<p>for <span class="math notranslate nohighlight">\(x(s_1), s_1 \in  {\cal S}\)</span>, and</p>
<div class="math notranslate nohighlight" id="equation-lsan0">
<span class="eqno">(42.40)<a class="headerlink" href="#equation-lsan0" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{aligned}
    (1 + \Phi_0) (u_{c,0} - u_{n,0})
    &amp; + \Phi_0 \bigl[ n_0 (u_{ll,0} - u_{lc,0} ) +  (n_0 - g(s_0)) (u_{cc,0} - u_{cl,0}) \Bigr]
    \\
    &amp; \quad \quad \quad -  \Phi_0 (u_{cc,0} - u_{cl,0}) b_0  =  0
\end{aligned}\end{split}\]</div>
<p>Notice  similarities and differences between the first-order
conditions for <span class="math notranslate nohighlight">\(t \geq 1\)</span> and for <span class="math notranslate nohighlight">\(t=0\)</span>.</p>
<p>An additional term is present in <a class="reference internal" href="#equation-lsan0">(42.40)</a> except in  three special cases</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(b_0 = 0\)</span>, or</p></li>
<li><p><span class="math notranslate nohighlight">\(u_c\)</span> is constant (i.e., preferences are quasi-linear in consumption), or</p></li>
<li><p>initial government assets are sufficiently large to finance all government
purchases with interest earnings from those assets so that <span class="math notranslate nohighlight">\(\Phi_0= 0\)</span></p></li>
</ul>
<p>Except in these special cases, the allocation and the labor tax rate as
functions of <span class="math notranslate nohighlight">\(s_t\)</span> differ between dates <span class="math notranslate nohighlight">\(t=0\)</span> and subsequent
dates <span class="math notranslate nohighlight">\(t \geq 1\)</span>.</p>
<p>Naturally, the first-order conditions in this recursive formulation of the
Ramsey problem agree with the first-order conditions derived when we first
formulated the Ramsey plan in the space of sequences.</p>
</section>
<section id="state-variable-degeneracy">
<h3><span class="section-number">42.3.6. </span>State Variable Degeneracy<a class="headerlink" href="#state-variable-degeneracy" title="Permalink to this heading">#</a></h3>
<p>Equations <a class="reference internal" href="#equation-lsaenv">(42.38)</a> and <a class="reference internal" href="#equation-lsax0">(42.39)</a> imply that <span class="math notranslate nohighlight">\(\Phi_0 = \Phi_1\)</span>
and that</p>
<div class="math notranslate nohighlight" id="equation-foncx">
<span class="eqno">(42.41)<a class="headerlink" href="#equation-foncx" title="Permalink to this equation">#</a></span>\[V_x(x_t, s_t) = \Phi_0\]</div>
<p>for all <span class="math notranslate nohighlight">\(t \geq 1\)</span>.</p>
<p>When <span class="math notranslate nohighlight">\(V\)</span> is concave in <span class="math notranslate nohighlight">\(x\)</span>, this implies <em>state-variable degeneracy</em>
along a Ramsey plan in the sense that for <span class="math notranslate nohighlight">\(t \geq 1\)</span>, <span class="math notranslate nohighlight">\(x_t\)</span> will be
a time-invariant function of <span class="math notranslate nohighlight">\(s_t\)</span>.</p>
<p>Given <span class="math notranslate nohighlight">\(\Phi_0\)</span>, this function mapping <span class="math notranslate nohighlight">\(s_t\)</span> into <span class="math notranslate nohighlight">\(x_t\)</span>
can be expressed as a vector <span class="math notranslate nohighlight">\(\vec x\)</span> that solves equation <a class="reference internal" href="#equation-bellman2cons2">(42.34)</a>
for <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(c\)</span> as functions of <span class="math notranslate nohighlight">\(g\)</span> that are associated
with <span class="math notranslate nohighlight">\(\Phi = \Phi_0\)</span>.</p>
</section>
<section id="manifestations-of-time-inconsistency">
<h3><span class="section-number">42.3.7. </span>Manifestations of Time Inconsistency<a class="headerlink" href="#manifestations-of-time-inconsistency" title="Permalink to this heading">#</a></h3>
<p>While the marginal utility adjusted level of government debt <span class="math notranslate nohighlight">\(x_t\)</span>
is a key state variable for the continuation Ramsey planners at
<span class="math notranslate nohighlight">\(t \geq 1\)</span>, it is not a state variable at time <span class="math notranslate nohighlight">\(0\)</span>.</p>
<p>The time <span class="math notranslate nohighlight">\(0\)</span> Ramsey planner faces <span class="math notranslate nohighlight">\(b_0\)</span>, not <span class="math notranslate nohighlight">\(x_0 = u_{c,0} b_0\)</span>, as a state variable.</p>
<p>The discrepancy in state variables faced by the time <span class="math notranslate nohighlight">\(0\)</span> Ramsey planner and the time
<span class="math notranslate nohighlight">\(t \geq 1\)</span> continuation Ramsey planners captures the differing
obligations and incentives faced by the time <span class="math notranslate nohighlight">\(0\)</span> Ramsey planner
and the time <span class="math notranslate nohighlight">\(t \geq 1\)</span> continuation Ramsey planners.</p>
<ul class="simple">
<li><p>The time <span class="math notranslate nohighlight">\(0\)</span> Ramsey planner is obligated to honor government
debt <span class="math notranslate nohighlight">\(b_0\)</span> measured in time <span class="math notranslate nohighlight">\(0\)</span> consumption goods.</p></li>
<li><p>The time <span class="math notranslate nohighlight">\(0\)</span> Ramsey planner can manipulate the <em>value</em> of government
debt as measured by <span class="math notranslate nohighlight">\(u_{c,0} b_0\)</span>.</p></li>
<li><p>In contrast, time <span class="math notranslate nohighlight">\(t \geq 1\)</span> continuation Ramsey planners are
obligated <em>not</em> to alter values of debt, as measured by
<span class="math notranslate nohighlight">\(u_{c,t} b_t\)</span>, that they inherit from a preceding Ramsey planner or
continuation Ramsey planner.</p></li>
</ul>
<p>When government expenditures <span class="math notranslate nohighlight">\(g_t\)</span> are a time-invariant function
of a Markov state <span class="math notranslate nohighlight">\(s_t\)</span>, a Ramsey plan and associated Ramsey
allocation feature marginal utilities of consumption <span class="math notranslate nohighlight">\(u_c(s_t)\)</span>
that, given <span class="math notranslate nohighlight">\(\Phi\)</span>, for <span class="math notranslate nohighlight">\(t \geq 1\)</span> depend only on
<span class="math notranslate nohighlight">\(s_t\)</span>, but that for <span class="math notranslate nohighlight">\(t=0\)</span> depend on <span class="math notranslate nohighlight">\(b_0\)</span> as well.</p>
<p>This means that <span class="math notranslate nohighlight">\(u_c(s_t)\)</span> will be a time-invariant function of
<span class="math notranslate nohighlight">\(s_t\)</span> for <span class="math notranslate nohighlight">\(t \geq 1\)</span>, but except when <span class="math notranslate nohighlight">\(b_0 = 0\)</span>, a
different function for <span class="math notranslate nohighlight">\(t=0\)</span>.</p>
<p>This in turn means that prices of
one-period Arrow securities <span class="math notranslate nohighlight">\(p_{t+1}(s_{t+1} | s_t) = p(s_{t+1}|s_t)\)</span>
will be the <em>same</em> time-invariant functions of <span class="math notranslate nohighlight">\((s_{t+1}, s_t)\)</span>
for <span class="math notranslate nohighlight">\(t \geq 1\)</span>, but a different function <span class="math notranslate nohighlight">\(p_0(s_1|s_0)\)</span> for
<span class="math notranslate nohighlight">\(t=0\)</span>, except when <span class="math notranslate nohighlight">\(b_0=0\)</span>.</p>
<p>The differences between these
time <span class="math notranslate nohighlight">\(0\)</span> and time <span class="math notranslate nohighlight">\(t \geq 1\)</span> objects reflect
the Ramsey planner’s incentive to manipulate Arrow security prices and,
through them, the value of initial government debt <span class="math notranslate nohighlight">\(b_0\)</span>.</p>
</section>
<section id="recursive-implementation">
<h3><span class="section-number">42.3.8. </span>Recursive Implementation<a class="headerlink" href="#recursive-implementation" title="Permalink to this heading">#</a></h3>
<p>The above steps are implemented in a class called <code class="docutils literal notranslate"><span class="pre">RecursiveLS</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">RecursiveLS</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Compute the planner&#39;s allocation by solving Bellman</span>
<span class="sd">    equation.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">pref</span><span class="p">,</span>
                 <span class="n">x_grid</span><span class="p">,</span>
                 <span class="n">π</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">),</span>
                 <span class="n">g</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">π</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span> <span class="o">=</span> <span class="n">π</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">π</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pref</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_grid</span> <span class="o">=</span> <span class="n">pref</span><span class="p">,</span> <span class="n">x_grid</span>

        <span class="n">bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

        <span class="c1"># bound for n</span>
        <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>

        <span class="c1"># bound for xprime</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">bounds</span><span class="p">[</span><span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_grid</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">x_grid</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="n">bounds</span>

        <span class="c1"># initialization of time 1 value function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">time1_allocation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Solve the optimal time 1 allocation problem</span>
<span class="sd">        by iterating Bellman value function.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">π</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">π</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span>
        <span class="n">pref</span><span class="p">,</span> <span class="n">x_grid</span><span class="p">,</span> <span class="n">bounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_grid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span>

        <span class="c1"># initial guess of value function</span>
        <span class="k">if</span> <span class="n">V</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x_grid</span><span class="p">),</span> <span class="n">S</span><span class="p">))</span>

        <span class="c1"># initial guess of policy</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x_grid</span><span class="p">),</span> <span class="n">S</span><span class="p">,</span> <span class="n">S</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>

        <span class="c1"># guess of n</span>
        <span class="n">z</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>

        <span class="c1"># guess of xprime</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">S</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">S</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">z</span><span class="p">[:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_grid</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="c1"># value function iteration</span>
            <span class="n">V_new</span><span class="p">,</span> <span class="n">z_new</span> <span class="o">=</span> <span class="n">T</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">pref</span><span class="p">,</span> <span class="n">π</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">x_grid</span><span class="p">,</span> <span class="n">bounds</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">V_new</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
                <span class="k">break</span>

            <span class="n">V</span> <span class="o">=</span> <span class="n">V_new</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">z_new</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="o">=</span> <span class="n">V_new</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z1</span> <span class="o">=</span> <span class="n">z_new</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c1</span> <span class="o">=</span> <span class="n">z_new</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n1</span> <span class="o">=</span> <span class="n">z_new</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xprime1</span> <span class="o">=</span> <span class="n">z_new</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">:]</span>

        <span class="k">return</span> <span class="n">V_new</span><span class="p">,</span> <span class="n">z_new</span>

    <span class="k">def</span> <span class="nf">time0_allocation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b0</span><span class="p">,</span> <span class="n">s0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Find the optimal time 0 allocation by maximization.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time1_allocation</span><span class="p">()</span>

        <span class="n">π</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">π</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span>
        <span class="n">pref</span><span class="p">,</span> <span class="n">x_grid</span><span class="p">,</span> <span class="n">bounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_grid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span>
        <span class="n">V</span><span class="p">,</span> <span class="n">z1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">V</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z1</span>

        <span class="n">x</span> <span class="o">=</span> <span class="mf">1.</span> <span class="c1"># x is arbitrary</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">nelder_mead</span><span class="p">(</span><span class="n">obj_V</span><span class="p">,</span>
                          <span class="n">z1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                          <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">pref</span><span class="p">,</span> <span class="n">π</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">x_grid</span><span class="p">,</span> <span class="n">b0</span><span class="p">),</span>
                          <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
                          <span class="n">tol_f</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>

        <span class="n">n0</span><span class="p">,</span> <span class="n">xprime0</span> <span class="o">=</span> <span class="n">IC</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">b0</span><span class="p">,</span> <span class="n">pref</span><span class="p">,</span> <span class="n">π</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
        <span class="n">c0</span> <span class="o">=</span> <span class="n">n0</span> <span class="o">-</span> <span class="n">g</span><span class="p">[</span><span class="n">s0</span><span class="p">]</span>
        <span class="n">z0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">c0</span><span class="p">,</span> <span class="n">n0</span><span class="p">,</span> <span class="o">*</span><span class="n">xprime0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">z0</span> <span class="o">=</span> <span class="n">z0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n0</span> <span class="o">=</span> <span class="n">n0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c0</span> <span class="o">=</span> <span class="n">n0</span> <span class="o">-</span> <span class="n">g</span><span class="p">[</span><span class="n">s0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xprime0</span> <span class="o">=</span> <span class="n">xprime0</span>

        <span class="k">return</span> <span class="n">z0</span>

    <span class="k">def</span> <span class="nf">τ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes τ given c, n</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">pref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref</span>
        <span class="n">uc</span><span class="p">,</span> <span class="n">ul</span> <span class="o">=</span> <span class="n">pref</span><span class="o">.</span><span class="n">Uc</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">n</span><span class="p">),</span> <span class="n">pref</span><span class="o">.</span><span class="n">Ul</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">n</span><span class="p">)</span>

        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">ul</span> <span class="o">/</span> <span class="n">uc</span>

    <span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b0</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">sHist</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Simulates Ramsey plan for T periods</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">pref</span><span class="p">,</span> <span class="n">π</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">π</span>
        <span class="n">Uc</span> <span class="o">=</span> <span class="n">pref</span><span class="o">.</span><span class="n">Uc</span>

        <span class="k">if</span> <span class="n">sHist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sHist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">s0</span><span class="p">)</span>

        <span class="n">cHist</span><span class="p">,</span> <span class="n">nHist</span><span class="p">,</span> <span class="n">Bhist</span><span class="p">,</span> <span class="n">τHist</span><span class="p">,</span> <span class="n">xHist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="n">T</span><span class="p">))</span>
        <span class="n">RHist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Time 0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time0_allocation</span><span class="p">(</span><span class="n">b0</span><span class="p">,</span> <span class="n">s0</span><span class="p">)</span>
        <span class="n">cHist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nHist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xHist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xprime0</span><span class="p">[</span><span class="n">s0</span><span class="p">]</span>
        <span class="n">τHist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">τ</span><span class="p">(</span><span class="n">cHist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nHist</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Bhist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">b0</span>

        <span class="c1"># Time 1 onward</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
            <span class="n">s</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">sHist</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">xHist</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">cHist</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_grid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c1</span><span class="p">[:,</span> <span class="n">s</span><span class="p">],</span> <span class="n">x</span><span class="p">)</span>
            <span class="n">nHist</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_grid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n1</span><span class="p">[:,</span> <span class="n">s</span><span class="p">],</span> <span class="n">x</span><span class="p">)</span>

            <span class="n">τHist</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">τ</span><span class="p">(</span><span class="n">cHist</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">nHist</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

            <span class="n">Bhist</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">Uc</span><span class="p">(</span><span class="n">cHist</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="mi">1</span><span class="o">-</span><span class="n">nHist</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

            <span class="n">c</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">sprime</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">):</span>
                <span class="n">c</span><span class="p">[</span><span class="n">sprime</span><span class="p">]</span> <span class="o">=</span> <span class="n">interp</span><span class="p">(</span><span class="n">x_grid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c1</span><span class="p">[:,</span> <span class="n">sprime</span><span class="p">],</span> <span class="n">x</span><span class="p">)</span>
                <span class="n">n</span><span class="p">[</span><span class="n">sprime</span><span class="p">]</span> <span class="o">=</span> <span class="n">interp</span><span class="p">(</span><span class="n">x_grid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n1</span><span class="p">[:,</span> <span class="n">sprime</span><span class="p">],</span> <span class="n">x</span><span class="p">)</span>
            <span class="n">Euc</span> <span class="o">=</span> <span class="n">π</span><span class="p">[</span><span class="n">sHist</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">@</span> <span class="n">Uc</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">n</span><span class="p">)</span>
            <span class="n">RHist</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Uc</span><span class="p">(</span><span class="n">cHist</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="o">-</span><span class="n">nHist</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pref</span><span class="o">.</span><span class="n">β</span> <span class="o">*</span> <span class="n">Euc</span><span class="p">)</span>

            <span class="n">gHist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">[</span><span class="n">sHist</span><span class="p">]</span>
            <span class="n">yHist</span> <span class="o">=</span> <span class="n">nHist</span>
            
            <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">sprime</span> <span class="o">=</span> <span class="n">sHist</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">xHist</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_grid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xprime1</span><span class="p">[:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">sprime</span><span class="p">],</span> <span class="n">x</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">cHist</span><span class="p">,</span> <span class="n">nHist</span><span class="p">,</span> <span class="n">Bhist</span><span class="p">,</span> <span class="n">τHist</span><span class="p">,</span> <span class="n">gHist</span><span class="p">,</span> <span class="n">yHist</span><span class="p">,</span> <span class="n">xHist</span><span class="p">,</span> <span class="n">RHist</span><span class="p">]</span>

<span class="c1"># Helper functions</span>

<span class="nd">@njit</span><span class="p">(</span><span class="n">parallel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">T</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">pref</span><span class="p">,</span> <span class="n">π</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">x_grid</span><span class="p">,</span> <span class="n">bounds</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    One step iteration of Bellman value function.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">S</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">π</span><span class="p">)</span>

    <span class="n">V_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
    <span class="n">z_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_grid</span><span class="p">)):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x_grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">S</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">nelder_mead</span><span class="p">(</span><span class="n">obj_V</span><span class="p">,</span>
                              <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                              <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">pref</span><span class="p">,</span> <span class="n">π</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">x_grid</span><span class="p">),</span>
                              <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
                              <span class="n">tol_f</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>

            <span class="c1"># optimal policy</span>
            <span class="n">n</span><span class="p">,</span> <span class="n">xprime</span> <span class="o">=</span> <span class="n">IC</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">pref</span><span class="p">,</span> <span class="n">π</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
            <span class="n">z_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">g</span><span class="p">[</span><span class="n">s</span><span class="p">]</span>        <span class="c1"># c</span>
            <span class="n">z_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>               <span class="c1"># n</span>
            <span class="n">z_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="n">xprime</span>         <span class="c1"># xprime</span>
            
            <span class="n">V_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">fun</span>

    <span class="k">return</span> <span class="n">V_new</span><span class="p">,</span> <span class="n">z_new</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">obj_V</span><span class="p">(</span><span class="n">z_sub</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">pref</span><span class="p">,</span> <span class="n">π</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">x_grid</span><span class="p">,</span> <span class="n">b0</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    The objective on the right hand side of the Bellman equation.</span>
<span class="sd">    z_sub contains guesses of n and xprime[:-1].</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">S</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">π</span><span class="p">)</span>
    <span class="n">β</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">pref</span><span class="o">.</span><span class="n">β</span><span class="p">,</span> <span class="n">pref</span><span class="o">.</span><span class="n">U</span>

    <span class="c1"># find (n, xprime) that satisfies implementability constraint</span>
    <span class="n">n</span><span class="p">,</span> <span class="n">xprime</span> <span class="o">=</span> <span class="n">IC</span><span class="p">(</span><span class="n">z_sub</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">b0</span><span class="p">,</span> <span class="n">pref</span><span class="p">,</span> <span class="n">π</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
    <span class="n">c</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">n</span><span class="o">-</span><span class="n">g</span><span class="p">[</span><span class="n">s</span><span class="p">],</span> <span class="mi">1</span><span class="o">-</span><span class="n">n</span>

    <span class="c1"># if xprime[-1] violates bound, return large penalty</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">xprime</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">x_grid</span><span class="o">.</span><span class="n">min</span><span class="p">()):</span>
        <span class="k">return</span> <span class="o">-</span><span class="mf">1e9</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xprime</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_grid</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">xprime</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">x_grid</span><span class="o">.</span><span class="n">max</span><span class="p">()):</span>
        <span class="k">return</span> <span class="o">-</span><span class="mf">1e9</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xprime</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_grid</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>

    <span class="c1"># prepare Vprime vector</span>
    <span class="n">Vprime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">sprime</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">S</span><span class="p">):</span>
        <span class="n">Vprime</span><span class="p">[</span><span class="n">sprime</span><span class="p">]</span> <span class="o">=</span> <span class="n">interp</span><span class="p">(</span><span class="n">x_grid</span><span class="p">,</span> <span class="n">V</span><span class="p">[:,</span> <span class="n">sprime</span><span class="p">],</span> <span class="n">xprime</span><span class="p">[</span><span class="n">sprime</span><span class="p">])</span>

    <span class="c1"># compute the objective value</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">U</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="n">β</span> <span class="o">*</span> <span class="n">π</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">@</span> <span class="n">Vprime</span>

    <span class="k">return</span> <span class="n">obj</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">IC</span><span class="p">(</span><span class="n">z_sub</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">b0</span><span class="p">,</span> <span class="n">pref</span><span class="p">,</span> <span class="n">π</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Find xprime[-1] that satisfies the implementability condition</span>
<span class="sd">    given the guesses of n and xprime[:-1].</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">β</span><span class="p">,</span> <span class="n">Uc</span><span class="p">,</span> <span class="n">Ul</span> <span class="o">=</span> <span class="n">pref</span><span class="o">.</span><span class="n">β</span><span class="p">,</span> <span class="n">pref</span><span class="o">.</span><span class="n">Uc</span><span class="p">,</span> <span class="n">pref</span><span class="o">.</span><span class="n">Ul</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">z_sub</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">xprime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">π</span><span class="p">))</span>
    <span class="n">xprime</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">z_sub</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="n">c</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">n</span><span class="o">-</span><span class="n">g</span><span class="p">[</span><span class="n">s</span><span class="p">],</span> <span class="mi">1</span><span class="o">-</span><span class="n">n</span>
    <span class="n">uc</span> <span class="o">=</span> <span class="n">Uc</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
    <span class="n">ul</span> <span class="o">=</span> <span class="n">Ul</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">b0</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">x</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">uc</span> <span class="o">*</span> <span class="n">b0</span>

    <span class="n">diff</span> <span class="o">-=</span> <span class="n">uc</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">g</span><span class="p">[</span><span class="n">s</span><span class="p">])</span> <span class="o">-</span> <span class="n">ul</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="n">β</span> <span class="o">*</span> <span class="n">π</span><span class="p">[</span><span class="n">s</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">@</span> <span class="n">xprime</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">xprime</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">diff</span> <span class="o">/</span> <span class="p">(</span><span class="n">β</span> <span class="o">*</span> <span class="n">π</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">n</span><span class="p">,</span> <span class="n">xprime</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="examples">
<h2><a class="toc-backref" href="#id9"><span class="section-number">42.4. </span>Examples</a><a class="headerlink" href="#examples" title="Permalink to this heading">#</a></h2>
<p>We return to the setup with CRRA preferences described above.</p>
<section id="anticipated-one-period-war">
<h3><span class="section-number">42.4.1. </span>Anticipated One-Period War<a class="headerlink" href="#anticipated-one-period-war" title="Permalink to this heading">#</a></h3>
<p>This example illustrates in a simple setting how a Ramsey planner manages risk.</p>
<p>Government expenditures are known for sure in all periods except one</p>
<ul class="simple">
<li><p>For <span class="math notranslate nohighlight">\(t&lt;3\)</span> and <span class="math notranslate nohighlight">\(t &gt; 3\)</span> we assume that <span class="math notranslate nohighlight">\(g_t = g_l = 0.1\)</span>.</p></li>
<li><p>At <span class="math notranslate nohighlight">\(t = 3\)</span> a war occurs with probability 0.5.</p>
<ul>
<li><p>If there is war, <span class="math notranslate nohighlight">\(g_3 = g_h = 0.2\)</span></p></li>
<li><p>If there is no war <span class="math notranslate nohighlight">\(g_3 = g_l = 0.1\)</span></p></li>
</ul>
</li>
</ul>
<p>We define the components of the state vector as the following six  <span class="math notranslate nohighlight">\((t,g)\)</span>
pairs: <span class="math notranslate nohighlight">\((0,g_l),(1,g_l),(2,g_l),(3,g_l),(3,g_h), (t\geq 4,g_l)\)</span>.</p>
<p>We think of these  6 states as corresponding to <span class="math notranslate nohighlight">\(s=1,2,3,4,5,6\)</span>.</p>
<p>The transition matrix is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\Pi = \left(\begin{matrix}0 &amp; 1 &amp; 0 &amp; 0   &amp; 0   &amp; 0\\
                          0 &amp; 0 &amp; 1 &amp; 0   &amp; 0   &amp; 0\\
                          0 &amp; 0 &amp; 0 &amp; 0.5 &amp; 0.5 &amp; 0\\
                          0 &amp; 0 &amp; 0 &amp; 0   &amp; 0   &amp; 1\\
                          0 &amp; 0 &amp; 0 &amp; 0   &amp; 0   &amp; 1\\
                          0 &amp; 0 &amp; 0 &amp; 0   &amp; 0   &amp; 1\end{matrix}\right)
\end{split}\]</div>
<p>Government expenditures at  each state are</p>
<div class="math notranslate nohighlight">
\[\begin{split}
g = \left(\begin{matrix} 0.1\\0.1\\0.1\\0.1\\0.2\\0.1 \end{matrix}\right)
\end{split}\]</div>
<p>We assume that the  representative agent has  utility function</p>
<div class="math notranslate nohighlight">
\[
u(c,n) = {\frac{c^{1-\sigma}}{1-\sigma}} - {\frac{n^{1+\gamma}}{1+\gamma}}
\]</div>
<p>and set  <span class="math notranslate nohighlight">\(\sigma = 2\)</span>, <span class="math notranslate nohighlight">\(\gamma = 2\)</span>, and the  discount factor <span class="math notranslate nohighlight">\(\beta = 0.9\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For convenience in terms of matching our code, we have expressed
utility as a function of <span class="math notranslate nohighlight">\(n\)</span> rather than leisure <span class="math notranslate nohighlight">\(l\)</span>.</p>
</div>
<p>This utility function is implemented in the class <code class="docutils literal notranslate"><span class="pre">CRRAutility</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crra_util_data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;β&#39;</span><span class="p">,</span> <span class="n">float64</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;σ&#39;</span><span class="p">,</span> <span class="n">float64</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;γ&#39;</span><span class="p">,</span> <span class="n">float64</span><span class="p">)</span>
<span class="p">]</span>

<span class="nd">@jitclass</span><span class="p">(</span><span class="n">crra_util_data</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">CRRAutility</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">β</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
                 <span class="n">σ</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                 <span class="n">γ</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">β</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">σ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">γ</span> <span class="o">=</span> <span class="n">β</span><span class="p">,</span> <span class="n">σ</span><span class="p">,</span> <span class="n">γ</span>

    <span class="c1"># Utility function</span>
    <span class="k">def</span> <span class="nf">U</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="c1"># Note: `l` should not be interpreted as labor, it is an auxiliary</span>
        <span class="c1"># variable used to conveniently match the code and the equations</span>
        <span class="c1"># in the lecture</span>
        <span class="n">σ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">σ</span>
        <span class="k">if</span> <span class="n">σ</span> <span class="o">==</span> <span class="mf">1.</span><span class="p">:</span>
            <span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">U</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">σ</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">σ</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">U</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">l</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">γ</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">γ</span><span class="p">)</span>

    <span class="c1"># Derivatives of utility function</span>
    <span class="k">def</span> <span class="nf">Uc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">c</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">σ</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">Ucc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">σ</span> <span class="o">*</span> <span class="n">c</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">σ</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">Ul</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">l</span><span class="p">)</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">γ</span>

    <span class="k">def</span> <span class="nf">Ull</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">γ</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">l</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">γ</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">Ucl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">Ulc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<p>We set initial government debt <span class="math notranslate nohighlight">\(b_0 = 1\)</span>.</p>
<p>We can now plot the Ramsey tax  under both realizations of time <span class="math notranslate nohighlight">\(t = 3\)</span> government expenditures</p>
<ul class="simple">
<li><p>black when <span class="math notranslate nohighlight">\(g_3 = .1\)</span>, and</p></li>
<li><p>red when <span class="math notranslate nohighlight">\(g_3 = .2\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">π</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">]])</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
<span class="n">crra_pref</span> <span class="o">=</span> <span class="n">CRRAutility</span><span class="p">()</span>

<span class="c1"># Solve sequential problem</span>
<span class="n">seq</span> <span class="o">=</span> <span class="n">SequentialLS</span><span class="p">(</span><span class="n">crra_pref</span><span class="p">,</span> <span class="n">π</span><span class="o">=</span><span class="n">π</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>
<span class="n">sHist_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">sHist_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">sim_seq_h</span> <span class="o">=</span> <span class="n">seq</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">sHist_h</span><span class="p">)</span>
<span class="n">sim_seq_l</span> <span class="o">=</span> <span class="n">seq</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">sHist_l</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Consumption&#39;</span><span class="p">,</span> <span class="s1">&#39;Labor Supply&#39;</span><span class="p">,</span> <span class="s1">&#39;Government Debt&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Tax Rate&#39;</span><span class="p">,</span> <span class="s1">&#39;Government Spending&#39;</span><span class="p">,</span> <span class="s1">&#39;Output&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">sim_l</span><span class="p">,</span> <span class="n">sim_h</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                                   <span class="n">titles</span><span class="p">,</span>
                                   <span class="n">sim_seq_l</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span>
                                   <span class="n">sim_seq_h</span><span class="p">[:</span><span class="mi">6</span><span class="p">]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim_l</span><span class="p">,</span> <span class="s1">&#39;-ok&#39;</span><span class="p">,</span> <span class="n">sim_h</span><span class="p">,</span> <span class="s1">&#39;-or&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5b62264a5c4bc01c47074abeecf8e567bd2107f7d716a0d5938745bda9e05777.png" src="_images/5b62264a5c4bc01c47074abeecf8e567bd2107f7d716a0d5938745bda9e05777.png" />
</div>
</div>
<p><strong>Tax smoothing</strong></p>
<ul class="simple">
<li><p>the tax rate is constant for all  <span class="math notranslate nohighlight">\(t\geq 1\)</span></p>
<ul>
<li><p>For <span class="math notranslate nohighlight">\(t \geq 1, t \neq 3\)</span>, this is a consequence of <span class="math notranslate nohighlight">\(g_t\)</span>
being the same at all those dates.</p></li>
<li><p>For <span class="math notranslate nohighlight">\(t = 3\)</span>, it is a consequence of the special one-period utility
function that we have assumed.</p></li>
<li><p>Under  other one-period utility functions, the time <span class="math notranslate nohighlight">\(t=3\)</span> tax rate
could be either higher or lower than for dates <span class="math notranslate nohighlight">\(t \geq 1, t \neq 3\)</span>.</p></li>
</ul>
</li>
<li><p>the tax rate is the same at <span class="math notranslate nohighlight">\(t=3\)</span> for both the high <span class="math notranslate nohighlight">\(g_t\)</span> outcome and the low <span class="math notranslate nohighlight">\(g_t\)</span> outcome</p></li>
</ul>
<p>We have assumed that at <span class="math notranslate nohighlight">\(t=0\)</span>, the government owes positive debt <span class="math notranslate nohighlight">\(b_0\)</span>.</p>
<p>It sets the time <span class="math notranslate nohighlight">\(t=0\)</span> tax rate partly with an eye to reducing the value <span class="math notranslate nohighlight">\(u_{c,0} b_0\)</span> of <span class="math notranslate nohighlight">\(b_0\)</span>.</p>
<p>It does this by increasing consumption at time <span class="math notranslate nohighlight">\(t=0\)</span> relative to
consumption in later periods.</p>
<p>This has the consequence of <em>lowering</em> the time <span class="math notranslate nohighlight">\(t=0\)</span> value of the  gross
interest  rate for risk-free loans between periods <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(t+1\)</span>, which  equals</p>
<div class="math notranslate nohighlight">
\[
R_t = \frac{u_{c,t}}{\beta\mathbb E_{t}[u_{c,t+1}]}
\]</div>
<p>A tax policy that makes  time <span class="math notranslate nohighlight">\(t=0\)</span> consumption be  higher than time <span class="math notranslate nohighlight">\(t=1\)</span> consumption evidently decreases the
risk-free rate one-period interest rate, <span class="math notranslate nohighlight">\(R_t\)</span>, at <span class="math notranslate nohighlight">\(t=0\)</span>.</p>
<p>Lowering the time <span class="math notranslate nohighlight">\(t=0\)</span> risk-free interest rate makes time <span class="math notranslate nohighlight">\(t=0\)</span>
consumption goods cheaper relative to consumption goods at later dates, thereby
lowering the value <span class="math notranslate nohighlight">\(u_{c,0} b_0\)</span> of initial government debt <span class="math notranslate nohighlight">\(b_0\)</span>.</p>
<p>We see this in a figure below that plots the time path for the risk-free interest
rate under both realizations of the time <span class="math notranslate nohighlight">\(t=3\)</span> government expenditure shock.</p>
<p>The following plot illustrates how the government lowers the interest rate at
time 0 by raising consumption</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fix</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gross Interest Rate&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim_seq_l</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;-ok&#39;</span><span class="p">,</span> <span class="n">sim_seq_h</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;-or&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/848c3d3b228c978386a91f03b9c162de614de8aabb81d5f160ca3275573c5c50.png" src="_images/848c3d3b228c978386a91f03b9c162de614de8aabb81d5f160ca3275573c5c50.png" />
</div>
</div>
</section>
<section id="government-saving">
<h3><span class="section-number">42.4.2. </span>Government Saving<a class="headerlink" href="#government-saving" title="Permalink to this heading">#</a></h3>
<p>At time  <span class="math notranslate nohighlight">\(t=0\)</span> the government evidently <em>dissaves</em> since <span class="math notranslate nohighlight">\(b_1&gt; b_0\)</span>.</p>
<ul class="simple">
<li><p>This is a consequence of it setting a <em>lower</em> tax rate at <span class="math notranslate nohighlight">\(t=0\)</span>,
implying more consumption at <span class="math notranslate nohighlight">\(t=0\)</span>.</p></li>
</ul>
<p>At time <span class="math notranslate nohighlight">\(t=1\)</span>, the government evidently <em>saves</em> since it has set the tax
rate sufficiently high to allow it to set <span class="math notranslate nohighlight">\(b_2 &lt; b_1\)</span>.</p>
<ul class="simple">
<li><p>Its motive for doing this is that it anticipates a likely war at <span class="math notranslate nohighlight">\(t=3\)</span>.</p></li>
</ul>
<p>At time <span class="math notranslate nohighlight">\(t=2\)</span> the government trades state-contingent Arrow securities
to hedge against  war at <span class="math notranslate nohighlight">\(t=3\)</span>.</p>
<ul class="simple">
<li><p>It purchases a security that pays off when <span class="math notranslate nohighlight">\(g_3 = g_h\)</span>.</p></li>
<li><p>It sells a security that  pays off when <span class="math notranslate nohighlight">\(g_3 = g_l\)</span>.</p></li>
<li><p>These purchases are designed in such a way that regardless of whether or
not there is a war at <span class="math notranslate nohighlight">\(t=3\)</span>, the government will begin  period
<span class="math notranslate nohighlight">\(t=4\)</span> with the <em>same</em> government debt.</p></li>
<li><p>The time <span class="math notranslate nohighlight">\(t=4\)</span> debt level can be serviced with revenues from the
constant tax rate set at times <span class="math notranslate nohighlight">\(t\geq 1\)</span>.</p></li>
</ul>
<p>At times <span class="math notranslate nohighlight">\(t \geq 4\)</span> the government rolls over its debt, knowing that the
tax rate is set at a level that raises enough revenue to pay for government purchases and interest payments
on its debt.</p>
</section>
<section id="time-0-manipulation-of-interest-rate">
<h3><span class="section-number">42.4.3. </span>Time 0 Manipulation of Interest Rate<a class="headerlink" href="#time-0-manipulation-of-interest-rate" title="Permalink to this heading">#</a></h3>
<p>We have seen that when <span class="math notranslate nohighlight">\(b_0&gt;0\)</span>, the Ramsey plan sets the time <span class="math notranslate nohighlight">\(t=0\)</span>
tax rate partly with an eye toward lowering a risk-free interest
rate for one-period loans between times <span class="math notranslate nohighlight">\(t=0\)</span> and <span class="math notranslate nohighlight">\(t=1\)</span>.</p>
<p>By lowering this interest rate, the plan makes time <span class="math notranslate nohighlight">\(t=0\)</span> goods cheap
relative to consumption goods at later times.</p>
<p>By doing this, it lowers the value of time <span class="math notranslate nohighlight">\(t=0\)</span> debt that it has inherited
and must finance.</p>
</section>
<section id="time-0-and-time-inconsistency">
<h3><span class="section-number">42.4.4. </span>Time 0 and Time-Inconsistency<a class="headerlink" href="#time-0-and-time-inconsistency" title="Permalink to this heading">#</a></h3>
<p>In the  preceding  example,  the Ramsey tax rate at time 0 differs from its value  at time 1.</p>
<p>To explore what is going on here, let’s simplify things by removing  the possibility of war at time <span class="math notranslate nohighlight">\(t=3\)</span>.</p>
<p>The Ramsey problem then includes no randomness because  <span class="math notranslate nohighlight">\(g_t = g_l\)</span> for all <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>The figure below plots the Ramsey tax rates and gross interest rates at time
<span class="math notranslate nohighlight">\(t=0\)</span> and time <span class="math notranslate nohighlight">\(t\geq1\)</span> as functions of the initial government debt
(using the sequential allocation solution and a CRRA utility function defined
above)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tax_seq</span> <span class="o">=</span> <span class="n">SequentialLS</span><span class="p">(</span><span class="n">CRRAutility</span><span class="p">(),</span> <span class="n">g</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.15</span><span class="p">]),</span> <span class="n">π</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">tax_policy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">interest_rate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">gov_debt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">tax_policy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tax_seq</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">gov_debt</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">interest_rate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tax_seq</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">gov_debt</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Tax Rate&#39;</span><span class="p">,</span> <span class="s1">&#39;Gross Interest Rate&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">plot</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">titles</span><span class="p">,</span> <span class="p">[</span><span class="n">tax_policy</span><span class="p">,</span> <span class="n">interest_rate</span><span class="p">]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gov_debt</span><span class="p">,</span> <span class="n">plot</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">gov_debt</span><span class="p">,</span> <span class="n">plot</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">gov_debt</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">gov_debt</span><span class="p">)))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;Time $t=0$&#39;</span><span class="p">,</span> <span class="s1">&#39;Time $t \geq 1$&#39;</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Initial Government Debt&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/97aa54288737a3fac88402f2e4e4108183a91fdfe3ca513ca9ee071dd885caec.png" src="_images/97aa54288737a3fac88402f2e4e4108183a91fdfe3ca513ca9ee071dd885caec.png" />
</div>
</div>
<p>The figure indicates  that if the government enters with  positive debt, it sets
a tax rate at <span class="math notranslate nohighlight">\(t=0\)</span> that is less than all later tax rates.</p>
<p>By setting  a lower tax rate at <span class="math notranslate nohighlight">\(t = 0\)</span>, the government raises consumption,
which reduces the <em>value</em> <span class="math notranslate nohighlight">\(u_{c,0} b_0\)</span> of its  initial debt.</p>
<p>It does this by increasing <span class="math notranslate nohighlight">\(c_0\)</span> and thereby lowering <span class="math notranslate nohighlight">\(u_{c,0}\)</span>.</p>
<p>Conversely, if  <span class="math notranslate nohighlight">\(b_{0} &lt; 0\)</span>, the Ramsey planner sets the tax rate at <span class="math notranslate nohighlight">\(t=0\)</span>
higher than in  subsequent periods.</p>
<p>A side effect of lowering time <span class="math notranslate nohighlight">\(t=0\)</span> consumption  is that it lowers  the
one-period  interest rate at time <span class="math notranslate nohighlight">\(t=0\)</span> below  that of subsequent periods.</p>
<p>There are only two values of initial government debt at which  the tax rate is
constant for all <span class="math notranslate nohighlight">\(t \geq 0\)</span>.</p>
<p>The first is <span class="math notranslate nohighlight">\(b_{0} = 0\)</span></p>
<ul class="simple">
<li><p>Here the government can’t use the <span class="math notranslate nohighlight">\(t=0\)</span> tax rate  to alter  the
value of the initial debt.</p></li>
</ul>
<p>The second occurs when the government enters with sufficiently large  assets
that the Ramsey planner can achieve first best and sets <span class="math notranslate nohighlight">\(\tau_t = 0\)</span>
for all <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>It is only for these two values of initial government debt that the Ramsey
plan is time-consistent.</p>
<p>Another way of saying this is that, except for these two values of initial
government debt, a continuation of a Ramsey plan is not a Ramsey plan.</p>
<p>To illustrate this, consider a Ramsey planner who starts with an initial
government debt  <span class="math notranslate nohighlight">\(b_1\)</span> associated with one of the Ramsey plans computed above.</p>
<p>Call <span class="math notranslate nohighlight">\(\tau_1^R\)</span> the time <span class="math notranslate nohighlight">\(t=0\)</span> tax rate chosen by the Ramsey planner
confronting this value for initial government debt government.</p>
<p>The figure below shows both  the tax rate  at time 1 chosen by our original
Ramsey planner and what a new Ramsey planner would choose for its
time <span class="math notranslate nohighlight">\(t=0\)</span> tax rate</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tax_seq</span> <span class="o">=</span> <span class="n">SequentialLS</span><span class="p">(</span><span class="n">CRRAutility</span><span class="p">(),</span> <span class="n">g</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.15</span><span class="p">]),</span> <span class="n">π</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">tax_policy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">τ_reset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">gov_debt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">tax_policy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tax_seq</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">gov_debt</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">τ_reset</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tax_seq</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">gov_debt</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gov_debt</span><span class="p">,</span> <span class="n">tax_policy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">gov_debt</span><span class="p">,</span> <span class="n">τ_reset</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Initial Government Debt&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Tax Rate&#39;</span><span class="p">,</span>
       <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">gov_debt</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">gov_debt</span><span class="p">)))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="sa">r</span><span class="s1">&#39;$\tau_1$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\tau_1^R$&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/40a237222e3ae51d95d7916451b442f664750d7a2f2682bc0564cb65e5f62f1e.png" src="_images/40a237222e3ae51d95d7916451b442f664750d7a2f2682bc0564cb65e5f62f1e.png" />
</div>
</div>
<p>The tax rates in the figure are equal  for only two values of initial government debt.</p>
</section>
<section id="tax-smoothing-and-non-crra-preferences">
<h3><span class="section-number">42.4.5. </span>Tax Smoothing and non-CRRA Preferences<a class="headerlink" href="#tax-smoothing-and-non-crra-preferences" title="Permalink to this heading">#</a></h3>
<p>The complete tax smoothing for <span class="math notranslate nohighlight">\(t \geq 1\)</span> in the preceding example is a
consequence of our having assumed CRRA preferences.</p>
<p>To see what is driving this outcome, we begin by noting that the Ramsey tax rate for <span class="math notranslate nohighlight">\(t\geq 1\)</span> is
a time-invariant function <span class="math notranslate nohighlight">\(\tau(\Phi,g)\)</span> of the Lagrange multiplier on
the implementability constraint and government expenditures.</p>
<p>For CRRA preferences, we can exploit the relations <span class="math notranslate nohighlight">\(U_{cc}c = -\sigma U_c\)</span>
and <span class="math notranslate nohighlight">\(U_{nn} n = \gamma U_n\)</span> to derive</p>
<div class="math notranslate nohighlight">
\[
\frac{(1+(1-\sigma)\Phi)U_c}{(1+(1-\gamma)\Phi)U_n} = 1
\]</div>
<p>from the first-order conditions.</p>
<p>This equation immediately implies that the tax rate is constant.</p>
<p>For other  preferences, the tax rate may not be constant.</p>
<p>For example, let the period utility function be</p>
<div class="math notranslate nohighlight">
\[
u(c,n) = \log(c) + 0.69 \log(1-n)
\]</div>
<p>We will create a new class LogUtility to represent this utility function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_util_data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;β&#39;</span><span class="p">,</span> <span class="n">float64</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;ψ&#39;</span><span class="p">,</span> <span class="n">float64</span><span class="p">)</span>
<span class="p">]</span>

<span class="nd">@jitclass</span><span class="p">(</span><span class="n">log_util_data</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">LogUtility</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">β</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
                 <span class="n">ψ</span><span class="o">=</span><span class="mf">0.69</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">β</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ψ</span> <span class="o">=</span> <span class="n">β</span><span class="p">,</span> <span class="n">ψ</span>

    <span class="c1"># Utility function</span>
    <span class="k">def</span> <span class="nf">U</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ψ</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>

    <span class="c1"># Derivatives of utility function</span>
    <span class="k">def</span> <span class="nf">Uc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">c</span>

    <span class="k">def</span> <span class="nf">Ucc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">c</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">Ul</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ψ</span> <span class="o">/</span> <span class="n">l</span>

    <span class="k">def</span> <span class="nf">Ull</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">ψ</span> <span class="o">/</span> <span class="n">l</span><span class="o">**</span><span class="mi">2</span>

    <span class="k">def</span> <span class="nf">Ucl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">Ulc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<p>Also, suppose that <span class="math notranslate nohighlight">\(g_t\)</span> follows a two-state IID process with equal
probabilities attached to <span class="math notranslate nohighlight">\(g_l\)</span> and <span class="math notranslate nohighlight">\(g_h\)</span>.</p>
<p>To compute the tax rate, we will use both the sequential and recursive approaches described above.</p>
<p>The figure below plots a sample path of the Ramsey tax rate</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_example</span> <span class="o">=</span> <span class="n">LogUtility</span><span class="p">()</span>
<span class="c1"># Solve sequential problem</span>
<span class="n">seq_log</span> <span class="o">=</span> <span class="n">SequentialLS</span><span class="p">(</span><span class="n">log_example</span><span class="p">)</span>

<span class="c1"># Initialize grid for value function iteration and solve</span>
<span class="n">x_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="c1"># Solve recursive problem</span>
<span class="n">rec_log</span> <span class="o">=</span> <span class="n">RecursiveLS</span><span class="p">(</span><span class="n">log_example</span><span class="p">,</span> <span class="n">x_grid</span><span class="p">)</span>

<span class="n">T_length</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">sHist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                  <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                  <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="c1"># Simulate</span>
<span class="n">sim_seq</span> <span class="o">=</span> <span class="n">seq_log</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">T_length</span><span class="p">,</span> <span class="n">sHist</span><span class="p">)</span>
<span class="n">sim_rec</span> <span class="o">=</span> <span class="n">rec_log</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">T_length</span><span class="p">,</span> <span class="n">sHist</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Consumption&#39;</span><span class="p">,</span> <span class="s1">&#39;Labor Supply&#39;</span><span class="p">,</span> <span class="s1">&#39;Government Debt&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Tax Rate&#39;</span><span class="p">,</span> <span class="s1">&#39;Government Spending&#39;</span><span class="p">,</span> <span class="s1">&#39;Output&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">sim_s</span><span class="p">,</span> <span class="n">sim_b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">titles</span><span class="p">,</span> <span class="n">sim_seq</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">sim_rec</span><span class="p">[:</span><span class="mi">6</span><span class="p">]):</span>
                                   <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim_s</span><span class="p">,</span> <span class="s1">&#39;-ob&#39;</span><span class="p">,</span> <span class="n">sim_b</span><span class="p">,</span> <span class="s1">&#39;-xk&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
                                   <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
                                   <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;Sequential&#39;</span><span class="p">,</span> <span class="s1">&#39;Recursive&#39;</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/384e8269553afbffc40d92100b633c57a37348c534512c9286ce2ae67445e74b.png" src="_images/384e8269553afbffc40d92100b633c57a37348c534512c9286ce2ae67445e74b.png" />
</div>
</div>
<p>As should be expected, the recursive and sequential solutions produce almost
identical allocations.</p>
<p>Unlike outcomes with CRRA preferences, the tax rate is not perfectly smoothed.</p>
<p>Instead, the government raises the tax rate when <span class="math notranslate nohighlight">\(g_t\)</span> is high.</p>
</section>
<section id="further-comments">
<h3><span class="section-number">42.4.6. </span>Further Comments<a class="headerlink" href="#further-comments" title="Permalink to this heading">#</a></h3>
<p>A <a class="reference internal" href="amss.html"><span class="doc">related lecture</span></a> describes an extension of the Lucas-Stokey model
by  Aiyagari, Marcet, Sargent, and Seppälä (2002) <span id="id4">[<a class="reference internal" href="zreferences.html#id130" title="S Rao Aiyagari, Albert Marcet, Thomas J Sargent, and Juha Seppälä. Optimal taxation without state-contingent debt. Journal of Political Economy, 110(6):1220–1254, 2002.">AMSSeppala02</a>]</span>.</p>
<p>In the AMSS economy, only a risk-free bond is traded.</p>
<p>That lecture compares the recursive representation of the Lucas-Stokey model
presented in this lecture with  one for an AMSS economy.</p>
<p>By comparing these recursive formulations, we shall glean a sense in which the
dimension of the state is lower in the Lucas Stokey model.</p>
<p>Accompanying that difference in dimension will be  different dynamics of government debt.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tools and Techniques
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="orth_proj.html">
   1. Orthogonal Projections and Their Applications
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stationary_densities.html">
   2. Continuous State Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="muth_kalman.html">
   3. Reverse Engineering a la Muth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="discrete_dp.html">
   4. Discrete State Dynamic Programming
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  LQ Control
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="cons_news.html">
   5. Information and Consumption Smoothing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="smoothing.html">
   6. Consumption Smoothing with Complete and Incomplete Markets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="smoothing_tax.html">
   7. Tax Smoothing with Complete and Incomplete Markets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_jump_lq.html">
   8. Markov Jump Linear Quadratic Dynamic Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tax_smoothing_1.html">
   9. How to Pay for a War: Part 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tax_smoothing_2.html">
   10. How to Pay for a War: Part 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tax_smoothing_3.html">
   11. How to Pay for a War: Part 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lqramsey.html">
   12. Optimal Taxation in an LQ Economy
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Multiple Agent Models
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="arellano.html">
   13. Default Risk and Income Fluctuations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="matsuyama.html">
   14. Globalization and Cycles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coase.html">
   15. Coase’s Theory of the Firm
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Dynamic Linear Economies
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="hs_recursive_models.html">
   16. Recursive Models of Dynamic Linear Economies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="growth_in_dles.html">
   17. Growth in Dynamic Linear Economies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lucas_asset_pricing_dles.html">
   18. Lucas Asset Pricing Using DLE
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="irfs_in_hall_model.html">
   19. IRFs in Hall Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="permanent_income_dles.html">
   20. Permanent Income Model using the DLE Class
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rosen_schooling_model.html">
   21. Rosen Schooling Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cattle_cycles.html">
   22. Cattle Cycles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hs_invertibility_example.html">
   23. Shock Non Invertibility
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Risk, Model Uncertainty, and Robustness
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="five_preferences.html">
   24. Risk and Model Uncertainty
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="entropy.html">
   25. Etymology of Entropy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="robustness.html">
   26. Robustness
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rob_markov_perf.html">
   27. Robust Markov Perfect Equilibrium
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Time Series Models
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="arma.html">
   28. Covariance Stationary Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="estspec.html">
   29. Estimation of Spectra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="additive_functionals.html">
   30. Additive and Multiplicative Functionals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lu_tricks.html">
   31. Classical Control with Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="classical_filtering.html">
   32. Classical Prediction and Filtering With Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="knowing_forecasts_of_others.html">
   33. Knowing the Forecasts of Others
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Asset Pricing and Finance
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lucas_model.html">
   34. Asset Pricing II: The Lucas Asset Pricing Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="asset_pricing_lph.html">
   35. Elementary Asset Pricing Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="black_litterman.html">
   36. Two Modifications of Mean-Variance Portfolio Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="BCG_complete_mkts.html">
   37. Irrelevance of Capital Structures with Complete Markets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="BCG_incomplete_mkts.html">
   38. Equilibrium Capital Structures with Incomplete Markets
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Dynamic Programming Squared
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="un_insure.html">
   39. Optimal Unemployment Insurance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dyn_stack.html">
   40. Stackelberg Plans
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="calvo.html">
   41. Ramsey Plans, Time Inconsistency, Sustainable Plans
  </a>
 </li>
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   42. Optimal Taxation with State-Contingent Debt
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="amss.html">
   43. Optimal Taxation without State-Contingent Debt
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="amss2.html">
   44. Fluctuating Interest Rates Deliver Fiscal Insurance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="amss3.html">
   45. Fiscal Risk and Government Debt
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chang_ramsey.html">
   46. Competitive Equilibria of a Model of Chang
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chang_credible.html">
   47. Credible Government Policies in a Model of Chang
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Other
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="troubleshooting.html">
   48. Troubleshooting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zreferences.html">
   49. References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="status.html">
   50. Execution Statistics
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="intro.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                </ul>

                <ul class="qe-toolbar__links">
                    <li class="btn__search">
                        <form action="search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off" accesskey="k">
                            <i data-feather="search" id="search-icon"></i>
                        </form>
                    </li>
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li data-tippy-content="Download Notebook"><a href="/_notebooks/opt_tax_recur.ipynb" download><i data-feather="download-cloud"></i></a></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li class="download-pdf" id="downloadButton"><i data-feather="file"></i></li>
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python-advanced.myst/blob/main/lectures/opt_tax_recur.md" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="/_pdf/quantecon-python-advanced.pdf" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://colab.research.google.com/github/QuantEcon/lecture-python-advanced.notebooks/blob/master/opt_tax_recur.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/QuantEcon/lecture-python-advanced.notebooks" data-urlpath="tree/lecture-python-advanced.notebooks/opt_tax_recur.ipynb" data-branch=master>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://colab.research.google.com/github/QuantEcon/lecture-python-advanced.notebooks/blob/master/opt_tax_recur.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "opt_tax_recur";
                const repoURL = "https://github.com/QuantEcon/lecture-python-advanced.notebooks";
                const urlPath = "tree/lecture-python-advanced.notebooks/opt_tax_recur.ipynb";
                const branch = "master"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/jupyter/hub/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
  </body>
</html>