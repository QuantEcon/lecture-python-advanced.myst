

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>15. Coase’s Theory of the Firm &#8212; Advanced Quantitative Economics with Python</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/quantecon-book-theme.css?digest=bd0785fbb14d8d2bd4d9ae501d79ed8d3bc089ec" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>


    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/scripts/quantecon-book-theme.js?digest=d6d86bce9979111653c4c495e33499e1796e172a"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-KZLV7PM9LL"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-KZLV7PM9LL');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"argmax": "arg\\,max", "argmin": "arg\\,min", "col": "col", "Span": "span", "epsilon": "\\varepsilon", "EE": "\\mathbb{E}", "PP": "\\mathbb{P}", "RR": "\\mathbb{R}", "NN": "\\mathbb{N}", "ZZ": "\\mathbb{Z}", "aA": "\\mathcal{A}", "bB": "\\mathcal{B}", "cC": "\\mathcal{C}", "dD": "\\mathcal{D}", "eE": "\\mathcal{E}", "fF": "\\mathcal{F}", "gG": "\\mathcal{G}", "hH": "\\mathcal{H}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'coase';</script>
    <link rel="canonical" href="https://python-advanced.quantecon.org/coase.html" />
    <link rel="shortcut icon" href="_static/lectures-favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="16. Recursive Models of Dynamic Linear Economies" href="hs_recursive_models.html" />
    <link rel="prev" title="14. Globalization and Cycles" href="matsuyama.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Thomas J. Sargent &amp; John Stachurski" />
<meta name="keywords" content="Python, QuantEcon, Quantitative Economics, Economics, Sloan, Alfred P. Sloan Foundation, Tom J. Sargent, John Stachurski" />
<meta name="description" content=This website presents a set of lectures on advanced quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski. />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="Coase’s Theory of the Firm"/>
<meta name="twitter:description" content="This website presents a set of lectures on advanced quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski.">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="Coase’s Theory of the Firm" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://python-advanced.quantecon.org/coase.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="This website presents a set of lectures on advanced quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski." />
<meta property="og:site_name" content="Advanced Quantitative Economics with Python" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>


    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=coase>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">15.1. Overview</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-firms-exist">15.1.1. Why Firms Exist</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-trade-off">15.1.2. A Trade-Off</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">15.1.3. Summary</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-quantitative-interpretation">15.1.4. A Quantitative Interpretation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-model">15.2. The Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#subcontracting">15.2.1. Subcontracting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#costs">15.2.2. Costs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#equilibrium">15.3. Equilibrium</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#informal-definition-of-equilibrium">15.3.1. Informal Definition of Equilibrium</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#formal-definition-of-equilibrium">15.3.2. Formal Definition of Equilibrium</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#existence-uniqueness-and-computation-of-equilibria">15.4. Existence, Uniqueness and Computation of Equilibria</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-fixed-point-method">15.4.1. A Fixed Point Method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#marginal-conditions">15.4.2. Marginal Conditions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation">15.5. Implementation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">15.6. Exercises</a></li>
</ul>
                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="_static/qe-logo-large.png" class="logo logo-img" alt="logo"></a>
                                    
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="intro.html">Advanced Quantitative Economics with Python</a></p>

                        <p class="qe-page__header-subheading">Coase’s Theory of the Firm</p>

                    </div>
                    <!-- length 2, since its a string and empty dict has length 2 - {} -->
                        <p class="qe-page__header-authors" font-size="18">
                            
                                
                                    <a href="http://www.tomsargent.com/" target="_blank"><span>Thomas J. Sargent</span></a>
                                
                            
                                
                                    and <a href="https://johnstachurski.net/" target="_blank"><span>John Stachurski</span></a>
                                
                            
                        </p>


                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <div id="qe-notebook-header" style="text-align:right;">
        <a href="https://quantecon.org/" title="quantecon.org">
                <img style="width:250px;display:inline;" src="https://assets.quantecon.org/img/qe-menubar-logo.svg" alt="QuantEcon">
        </a>
</div><section class="tex2jax_ignore mathjax_ignore" id="coase-s-theory-of-the-firm">
<h1><span class="section-number">15. </span><span class="target" id="index-0"></span>Coase’s Theory of the Firm<a class="headerlink" href="#coase-s-theory-of-the-firm" title="Permalink to this heading">#</a></h1>
<section id="overview">
<h2><span class="section-number">15.1. </span>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h2>
<p>In 1937, Ronald Coase wrote a brilliant essay on the nature of the firm <span id="id1">[<a class="reference internal" href="zreferences.html#id233" title="Ronald Harry Coase. The nature of the firm. economica, 4(16):386–405, 1937.">Coase, 1937</a>]</span>.</p>
<p>Coase was writing at a time when the Soviet Union was rising to become a significant industrial power.</p>
<p>At the same time, many free-market economies were afflicted by a severe and painful depression.</p>
<p>This contrast led to an intensive debate on the relative
merits of decentralized, price-based allocation versus top-down planning.</p>
<p>In the midst of this debate, Coase made an important observation:
even in free-market economies, a great deal of top-down planning does in fact take place.</p>
<p>This is because <em>firms</em> form an integral part of free-market economies and, within firms, allocation is by planning.</p>
<p>In other words, free-market economies blend both planning (within firms) and decentralized production coordinated by prices.</p>
<p>The question Coase asked is this: if prices and free markets are so efficient, then why do firms even exist?</p>
<p>Couldn’t the associated within-firm planning be done more efficiently by the market?</p>
<p>We’ll use the following imports:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fminbound</span>
</pre></div>
</div>
</div>
</div>
<section id="why-firms-exist">
<h3><span class="section-number">15.1.1. </span>Why Firms Exist<a class="headerlink" href="#why-firms-exist" title="Permalink to this heading">#</a></h3>
<p>On top of asking a deep and fascinating question, Coase also supplied an illuminating answer: firms exist because of transaction costs.</p>
<p>Here’s one example of a transaction cost:</p>
<p>Suppose agent A is considering setting up a small business and needs a web developer to construct and help run an online store.</p>
<p>She can use the labor of agent B, a web developer, by writing up a freelance contract for these tasks and agreeing on a suitable price.</p>
<p>But contracts like this can be time-consuming and difficult to verify</p>
<ul class="simple">
<li><p>How will agent A be able to specify exactly what she wants, to the finest detail, when she herself isn’t sure how the business will evolve?</p></li>
<li><p>And what if she isn’t familiar with web technology?  How can she specify all the relevant details?</p></li>
<li><p>And, if things go badly, will failure to comply with the contract be verifiable in court?</p></li>
</ul>
<p>In this situation, perhaps it will be easier to <em>employ</em> agent B under a simple labor contract.</p>
<p>The cost of this contract is far smaller because such contracts are simpler and more standard.</p>
<p>The basic agreement in a labor contract is: B will do what A asks him to do for the term of the contract, in return for a given salary.</p>
<p>Making this agreement is much easier than trying to map every task out in advance in a contract that will hold up in a court of law.</p>
<p>So agent A decides to hire agent B and a firm of nontrivial size appears, due to transaction costs.</p>
</section>
<section id="a-trade-off">
<h3><span class="section-number">15.1.2. </span>A Trade-Off<a class="headerlink" href="#a-trade-off" title="Permalink to this heading">#</a></h3>
<p>Actually, we haven’t yet come to the heart of Coase’s investigation.</p>
<p>The issue of why firms exist is a binary question: should firms have positive size or zero size?</p>
<p>A better and more general question is: <strong>what determines the size of firms</strong>?</p>
<p>The answer Coase came up with was that “a firm will tend to expand until the costs of organizing an extra
transaction within the firm become equal to the costs of carrying out the same
transaction by means of an exchange on the open market…” (<span id="id2">[<a class="reference internal" href="zreferences.html#id233" title="Ronald Harry Coase. The nature of the firm. economica, 4(16):386–405, 1937.">Coase, 1937</a>]</span>, p. 395).</p>
<p>But what are these internal and external costs?</p>
<p>In short, Coase envisaged a trade-off between</p>
<ul class="simple">
<li><p>transaction costs, which add to the expense of operating <em>between</em> firms, and</p></li>
<li><p>diminishing returns to management, which adds to the expense of operating <em>within</em> firms</p></li>
</ul>
<p>We discussed an example of transaction costs above (contracts).</p>
<p>The other cost, diminishing returns to management, is a catch-all for the idea
that big operations are increasingly costly to manage.</p>
<p>For example, you could think of management as a pyramid, so hiring more workers to implement more tasks
requires expansion of the pyramid, and hence labor costs grow at a rate more than
proportional to the range of tasks.</p>
<p>Diminishing returns to management makes in-house production expensive, favoring small firms.</p>
</section>
<section id="summary">
<h3><span class="section-number">15.1.3. </span>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h3>
<p>Here’s a summary of our discussion:</p>
<ul class="simple">
<li><p>Firms grow because transaction costs encourage them to take some operations in house.</p></li>
<li><p>But as they get large, in-house operations become costly due to diminishing returns to management.</p></li>
<li><p>The size of firms is determined by balancing these effects, thereby equalizing the marginal costs of each form of operation.</p></li>
</ul>
</section>
<section id="a-quantitative-interpretation">
<h3><span class="section-number">15.1.4. </span>A Quantitative Interpretation<a class="headerlink" href="#a-quantitative-interpretation" title="Permalink to this heading">#</a></h3>
<p>Coases ideas were expressed verbally, without any mathematics.</p>
<p>In fact, his essay is a wonderful example of how far you can get with clear thinking and plain English.</p>
<p>However, plain English is not good for quantitative analysis, so let’s bring some mathematical and computation tools to bear.</p>
<p>In doing so we’ll add a bit more structure than Coase did, but this price will be worth paying.</p>
<p>Our exposition is based on <span id="id3">[<a class="reference internal" href="zreferences.html#id232" title="Tomoo Kikuchi, Kazuo Nishimura, and John Stachurski. Span of control, transaction costs, and the structure of production chains. Theoretical Economics, 13(2):729–760, 2018.">Kikuchi <em>et al.</em>, 2018</a>]</span>.</p>
</section>
</section>
<section id="the-model">
<h2><span class="section-number">15.2. </span>The Model<a class="headerlink" href="#the-model" title="Permalink to this heading">#</a></h2>
<p>The model we study involves production of a single unit of a final good.</p>
<p>Production requires a linearly ordered chain, requiring sequential completion
of a large number of processing stages.</p>
<p>The stages are indexed by <span class="math notranslate nohighlight">\(t \in [0,1]\)</span>, with <span class="math notranslate nohighlight">\(t=0\)</span> indicating that no tasks
have been undertaken and <span class="math notranslate nohighlight">\(t=1\)</span> indicating that the good is complete.</p>
<section id="subcontracting">
<h3><span class="section-number">15.2.1. </span>Subcontracting<a class="headerlink" href="#subcontracting" title="Permalink to this heading">#</a></h3>
<p>The subcontracting scheme by which tasks are allocated across firms is illustrated in the figure below</p>
<figure class="align-center">
<img alt="_images/subcontracting.png" src="_images/subcontracting.png" />
</figure>
<p>In this example,</p>
<ul class="simple">
<li><p>Firm 1 receives a contract to sell one unit of the completed good to a final buyer.</p></li>
<li><p>Firm 1 then forms a contract with firm 2 to purchase the partially completed good at stage <span class="math notranslate nohighlight">\(t_1\)</span>, with
the intention of implementing the remaining <span class="math notranslate nohighlight">\(1 - t_1\)</span> tasks in-house (i.e., processing from stage <span class="math notranslate nohighlight">\(t_1\)</span> to stage <span class="math notranslate nohighlight">\(1\)</span>).</p></li>
<li><p>Firm 2 repeats this procedure, forming a contract with firm 3 to purchase the good at stage <span class="math notranslate nohighlight">\(t_2\)</span>.</p></li>
<li><p>Firm 3 decides to complete the chain, selecting <span class="math notranslate nohighlight">\(t_3 = 0\)</span>.</p></li>
</ul>
<p>At this point, production unfolds in the opposite direction (i.e., from upstream to downstream).</p>
<ul class="simple">
<li><p>Firm 3 completes processing stages from <span class="math notranslate nohighlight">\(t_3 = 0\)</span> up to <span class="math notranslate nohighlight">\(t_2\)</span> and transfers the good to firm 2.</p></li>
<li><p>Firm 2 then processes from <span class="math notranslate nohighlight">\(t_2\)</span> up to <span class="math notranslate nohighlight">\(t_1\)</span> and transfers the good to firm 1,</p></li>
<li><p>Firm 1 processes from <span class="math notranslate nohighlight">\(t_1\)</span> to <span class="math notranslate nohighlight">\(1\)</span> and delivers the completed good to the final buyer.</p></li>
</ul>
<p>The length of the interval of stages (range of tasks) carried out by firm <span class="math notranslate nohighlight">\(i\)</span> is denoted by <span class="math notranslate nohighlight">\(\ell_i\)</span>.</p>
<figure class="align-center">
<img alt="_images/allocation.png" src="_images/allocation.png" />
</figure>
<p>Each firm chooses only its <em>upstream</em> boundary, treating its downstream boundary as given.</p>
<p>The benefit of this formulation is that it implies a recursive structure for the decision problem for each firm.</p>
<p>In choosing how many processing stages to subcontract, each successive firm faces essentially the same
decision problem as the firm above it in the chain, with the only difference being that the decision space is a subinterval of the decision space for the firm above.</p>
<p>We will exploit this recursive structure in our study of equilibrium.</p>
</section>
<section id="costs">
<h3><span class="section-number">15.2.2. </span>Costs<a class="headerlink" href="#costs" title="Permalink to this heading">#</a></h3>
<p>Recall that we are considering a trade-off between two types of costs.</p>
<p>Let’s discuss these costs and how we represent them mathematically.</p>
<p><strong>Diminishing returns to management</strong> means rising costs per task when a firm expands the range of productive activities coordinated by its managers.</p>
<p>We represent these ideas by taking the cost of carrying out <span class="math notranslate nohighlight">\(\ell\)</span> tasks in-house to be <span class="math notranslate nohighlight">\(c(\ell)\)</span>, where <span class="math notranslate nohighlight">\(c\)</span> is increasing and strictly convex.</p>
<p>Thus, the average cost per task rises with the range of tasks performed in-house.</p>
<p>We also assume that <span class="math notranslate nohighlight">\(c\)</span> is continuously differentiable, with <span class="math notranslate nohighlight">\(c(0)=0\)</span> and <span class="math notranslate nohighlight">\(c'(0) &gt; 0\)</span>.</p>
<p><strong>Transaction costs</strong> are represented as a wedge between the buyer’s and seller’s prices.</p>
<p>It matters little for us whether the transaction cost is borne by the buyer or the seller.</p>
<p>Here we assume that the cost is borne only by the buyer.</p>
<p>In particular, when two firms agree to a trade at face value <span class="math notranslate nohighlight">\(v\)</span>, the buyer’s total outlay is <span class="math notranslate nohighlight">\(\delta v\)</span>, where <span class="math notranslate nohighlight">\(\delta &gt; 1\)</span>.</p>
<p>The seller receives only <span class="math notranslate nohighlight">\(v\)</span>, and the difference is paid to agents outside the model.</p>
</section>
</section>
<section id="equilibrium">
<h2><span class="section-number">15.3. </span>Equilibrium<a class="headerlink" href="#equilibrium" title="Permalink to this heading">#</a></h2>
<p>We assume that all firms are <em>ex-ante</em> identical and act as price takers.</p>
<p>As price takers, they face a price function <span class="math notranslate nohighlight">\(p\)</span>, which is a map from <span class="math notranslate nohighlight">\([0, 1]\)</span> to <span class="math notranslate nohighlight">\(\mathbb R_+\)</span>, with <span class="math notranslate nohighlight">\(p(t)\)</span> interpreted
as the price of the good at processing stage <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>There is a countable infinity of firms indexed by <span class="math notranslate nohighlight">\(i\)</span> and no barriers to entry.</p>
<p>The cost of supplying the initial input (the good processed up to stage zero) is set to zero for simplicity.</p>
<p>Free entry and the infinite fringe of competitors rule out positive profits for incumbents,
since any incumbent could be replaced by a member of the competitive fringe
filling the same role in the production chain.</p>
<p>Profits are never negative in equilibrium because firms can freely exit.</p>
<section id="informal-definition-of-equilibrium">
<h3><span class="section-number">15.3.1. </span>Informal Definition of Equilibrium<a class="headerlink" href="#informal-definition-of-equilibrium" title="Permalink to this heading">#</a></h3>
<p>An equilibrium in this setting is an allocation of firms and a price function such that</p>
<ol class="arabic simple">
<li><p>all active firms in the chain make zero profits, including suppliers of raw materials</p></li>
<li><p>no firm in the production chain has an incentive to deviate, and</p></li>
<li><p>no inactive firms can enter and extract positive profits</p></li>
</ol>
</section>
<section id="formal-definition-of-equilibrium">
<h3><span class="section-number">15.3.2. </span>Formal Definition of Equilibrium<a class="headerlink" href="#formal-definition-of-equilibrium" title="Permalink to this heading">#</a></h3>
<p>Let’s make this definition more formal.</p>
<p>(You might like to skip this section on first reading)</p>
<p>An <strong>allocation</strong> of firms is a nonnegative sequence <span class="math notranslate nohighlight">\(\{\ell_i\}_{i \in \mathbb N}\)</span> such that <span class="math notranslate nohighlight">\(\ell_i=0\)</span> for all sufficiently large <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>Recalling the figures above,</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\ell_i\)</span> represents the range of tasks implemented by the <span class="math notranslate nohighlight">\(i\)</span>-th firm</p></li>
</ul>
<p>As a labeling convention, we assume that firms enter in order, with firm 1 being the furthest downstream.</p>
<p>An allocation <span class="math notranslate nohighlight">\(\{\ell_i\}\)</span> is called <strong>feasible</strong> if <span class="math notranslate nohighlight">\(\sum_{\, i \geq 1} \ell_i = 1\)</span>.</p>
<p>In a feasible allocation, the entire production process is completed by finitely many firms.</p>
<p>Given a feasible allocation, <span class="math notranslate nohighlight">\(\{\ell_i\}\)</span>, let <span class="math notranslate nohighlight">\(\{t_i\}\)</span> represent the corresponding transaction stages, defined by</p>
<div class="math notranslate nohighlight" id="equation-ab">
<span class="eqno">(15.1)<a class="headerlink" href="#equation-ab" title="Permalink to this equation">#</a></span>\[t_0 = s \quad \text{and} \quad t_i = t_{i-1} - \ell_i\]</div>
<p>In particular, <span class="math notranslate nohighlight">\(t_{i-1}\)</span> is the downstream boundary of firm <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(t_i\)</span> is its upstream boundary.</p>
<p>As transaction costs are incurred only by the buyer, its profits are</p>
<div class="math notranslate nohighlight" id="equation-prof">
<span class="eqno">(15.2)<a class="headerlink" href="#equation-prof" title="Permalink to this equation">#</a></span>\[\pi_i = p(t_{i-1}) - c(\ell_i) - \delta p(t_i)\]</div>
<p>Given a price function <span class="math notranslate nohighlight">\(p\)</span> and a feasible allocation <span class="math notranslate nohighlight">\(\{\ell_i\}\)</span>, let</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\{t_i\}\)</span> be the corresponding firm boundaries.</p></li>
<li><p><span class="math notranslate nohighlight">\(\{\pi_i\}\)</span> be corresponding profits, as defined in <a class="reference internal" href="#equation-prof">(15.2)</a>.</p></li>
</ul>
<p>This price-allocation pair is called an <strong>equilibrium</strong> for the production chain if</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\; p(0) = 0\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\; \pi_i = 0\)</span> for all <span class="math notranslate nohighlight">\(i\)</span>, and</p></li>
<li><p><span class="math notranslate nohighlight">\(p(s) - c(s - t) -  \delta p(t) \leq 0\)</span> for any pair <span class="math notranslate nohighlight">\(s, t\)</span> with <span class="math notranslate nohighlight">\(0 \leq s \leq t \leq 1\)</span>.</p></li>
</ol>
<p>The rationale behind these conditions was given in our informal definition of equilibrium above.</p>
</section>
</section>
<section id="existence-uniqueness-and-computation-of-equilibria">
<h2><span class="section-number">15.4. </span>Existence, Uniqueness and Computation of Equilibria<a class="headerlink" href="#existence-uniqueness-and-computation-of-equilibria" title="Permalink to this heading">#</a></h2>
<p>We have defined an equilibrium but does one exist?  Is it unique?  And, if so, how can we compute it?</p>
<section id="a-fixed-point-method">
<h3><span class="section-number">15.4.1. </span>A Fixed Point Method<a class="headerlink" href="#a-fixed-point-method" title="Permalink to this heading">#</a></h3>
<p>To address these questions, we introduce the operator <span class="math notranslate nohighlight">\(T\)</span> mapping a nonnegative function <span class="math notranslate nohighlight">\(p\)</span> on <span class="math notranslate nohighlight">\([0, 1]\)</span> to <span class="math notranslate nohighlight">\(Tp\)</span> via</p>
<div class="math notranslate nohighlight" id="equation-coase-deft">
<span class="eqno">(15.3)<a class="headerlink" href="#equation-coase-deft" title="Permalink to this equation">#</a></span>\[Tp(s) = \min_{t \leq s}  \,
        \{ c(s-t) + \delta p(t) \}
       \quad \text{for all} \quad
       s \in [0,1].\]</div>
<p>Here and below, the restriction <span class="math notranslate nohighlight">\(0 \leq t\)</span> in the minimum is understood.</p>
<p>The operator <span class="math notranslate nohighlight">\(T\)</span> is similar to a Bellman operator.</p>
<p>Under this analogy, <span class="math notranslate nohighlight">\(p\)</span> corresponds to a value function and <span class="math notranslate nohighlight">\(\delta\)</span> to a discount factor.</p>
<p>But <span class="math notranslate nohighlight">\(\delta &gt; 1\)</span>, so <span class="math notranslate nohighlight">\(T\)</span> is not a contraction in any obvious metric, and in fact, <span class="math notranslate nohighlight">\(T^n p\)</span> diverges for many choices of <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>Nevertheless, there exists a domain on which <span class="math notranslate nohighlight">\(T\)</span> is well-behaved:  the set
of convex increasing continuous functions <span class="math notranslate nohighlight">\(p \colon [0,1] \to \mathbb R\)</span> such that <span class="math notranslate nohighlight">\(c'(0) s \leq p(s) \leq c(s)\)</span> for all <span class="math notranslate nohighlight">\(0 \leq s \leq 1\)</span>.</p>
<p>We denote this set of functions by <span class="math notranslate nohighlight">\(\mathcal P\)</span>.</p>
<p>In <span id="id4">[<a class="reference internal" href="zreferences.html#id232" title="Tomoo Kikuchi, Kazuo Nishimura, and John Stachurski. Span of control, transaction costs, and the structure of production chains. Theoretical Economics, 13(2):729–760, 2018.">Kikuchi <em>et al.</em>, 2018</a>]</span> it is shown that the following statements are true:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(T\)</span> maps <span class="math notranslate nohighlight">\(\mathcal P\)</span> into itself.</p></li>
<li><p><span class="math notranslate nohighlight">\(T\)</span> has a unique fixed point in <span class="math notranslate nohighlight">\(\mathcal P\)</span>, denoted below by <span class="math notranslate nohighlight">\(p^*\)</span>.</p></li>
<li><p>For all <span class="math notranslate nohighlight">\(p \in \mathcal P\)</span> we have <span class="math notranslate nohighlight">\(T^k p \to p^*\)</span> uniformly as <span class="math notranslate nohighlight">\(k \to \infty\)</span>.</p></li>
</ol>
<p>Now consider the choice function</p>
<div class="math notranslate nohighlight" id="equation-coase-argmins">
<span class="eqno">(15.4)<a class="headerlink" href="#equation-coase-argmins" title="Permalink to this equation">#</a></span>\[t^*(s) := \text{ the solution to } \min_{ t \leq s} \{c(s - t) + \delta p^*(t) \}\]</div>
<p>By definition, <span class="math notranslate nohighlight">\(t^*(s)\)</span> is the cost-minimizing upstream boundary for a firm that
is contracted to deliver the good at stage <span class="math notranslate nohighlight">\(s\)</span> and faces the price
function <span class="math notranslate nohighlight">\(p^*\)</span>.</p>
<p>Since <span class="math notranslate nohighlight">\(p^*\)</span> lies in <span class="math notranslate nohighlight">\(\mathcal P\)</span> and since <span class="math notranslate nohighlight">\(c\)</span> is strictly convex, it follows that the right-hand side of <a class="reference internal" href="#equation-coase-argmins">(15.4)</a> is continuous and strictly convex in <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>Hence the minimizer <span class="math notranslate nohighlight">\(t^*(s)\)</span> exists and is uniquely defined.</p>
<p>We can use <span class="math notranslate nohighlight">\(t^*\)</span> to construct an equilibrium allocation as follows:</p>
<p>Recall that firm 1 sells the completed good at stage <span class="math notranslate nohighlight">\(s=1\)</span>, its optimal upstream boundary is <span class="math notranslate nohighlight">\(t^*(1)\)</span>.</p>
<p>Hence firm 2’s optimal upstream boundary is <span class="math notranslate nohighlight">\(t^*(t^*(1))\)</span>.</p>
<p>Continuing in this way produces the sequence <span class="math notranslate nohighlight">\(\{t^*_i\}\)</span> defined by</p>
<div class="math notranslate nohighlight" id="equation-coase-ralloc">
<span class="eqno">(15.5)<a class="headerlink" href="#equation-coase-ralloc" title="Permalink to this equation">#</a></span>\[t_0^* = 1 \quad \text{and} \quad t_i^* = t^*(t_{i-1})\]</div>
<p>The sequence ends when a firm chooses to complete all remaining tasks.</p>
<p>We label this firm (and hence the number of firms in the chain) as</p>
<div class="math notranslate nohighlight" id="equation-coase-eqfn">
<span class="eqno">(15.6)<a class="headerlink" href="#equation-coase-eqfn" title="Permalink to this equation">#</a></span>\[n^* := \inf \{i \in \mathbb N \,:\, t^*_i = 0\}\]</div>
<p>The task allocation corresponding to <a class="reference internal" href="#equation-coase-ralloc">(15.5)</a> is given by <span class="math notranslate nohighlight">\(\ell_i^* := t_{i-1}^* - t_i^*\)</span> for all <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>In <span id="id5">[<a class="reference internal" href="zreferences.html#id232" title="Tomoo Kikuchi, Kazuo Nishimura, and John Stachurski. Span of control, transaction costs, and the structure of production chains. Theoretical Economics, 13(2):729–760, 2018.">Kikuchi <em>et al.</em>, 2018</a>]</span> it is shown that</p>
<ol class="arabic simple">
<li><p>The value <span class="math notranslate nohighlight">\(n^*\)</span> in <a class="reference internal" href="#equation-coase-eqfn">(15.6)</a> is well-defined and finite,</p></li>
<li><p>the allocation <span class="math notranslate nohighlight">\(\{\ell^*_i\}\)</span> is feasible, and</p></li>
<li><p>the price function <span class="math notranslate nohighlight">\(p^*\)</span> and this allocation together forms an equilibrium for the production chain.</p></li>
</ol>
<p>While the proofs are too long to repeat here,
much of the insight can be obtained by observing that, as a fixed point of <span class="math notranslate nohighlight">\(T\)</span>, the equilibrium price function must satisfy</p>
<div class="math notranslate nohighlight" id="equation-coase-epe">
<span class="eqno">(15.7)<a class="headerlink" href="#equation-coase-epe" title="Permalink to this equation">#</a></span>\[p^*(s) =
\min_{t \leq s} \, \{ c(s - t) + \delta p^*(t)  \}
\quad \text{for all} \quad s \in [0, 1]\]</div>
<p>From this equation, it is clear that so profits are zero for all incumbent firms.</p>
</section>
<section id="marginal-conditions">
<h3><span class="section-number">15.4.2. </span>Marginal Conditions<a class="headerlink" href="#marginal-conditions" title="Permalink to this heading">#</a></h3>
<p>We can develop some additional insights on the behavior of firms by examining marginal conditions associated with the equilibrium.</p>
<p>As a first step, let <span class="math notranslate nohighlight">\(\ell^*(s) := s - t^*(s)\)</span>.</p>
<p>This is the cost-minimizing range of in-house tasks for a firm with downstream boundary <span class="math notranslate nohighlight">\(s\)</span>.</p>
<p>In <span id="id6">[<a class="reference internal" href="zreferences.html#id232" title="Tomoo Kikuchi, Kazuo Nishimura, and John Stachurski. Span of control, transaction costs, and the structure of production chains. Theoretical Economics, 13(2):729–760, 2018.">Kikuchi <em>et al.</em>, 2018</a>]</span> it is shown that <span class="math notranslate nohighlight">\(t^*\)</span> and <span class="math notranslate nohighlight">\(\ell^*\)</span> are increasing and continuous, while <span class="math notranslate nohighlight">\(p^*\)</span> is continuously differentiable at all <span class="math notranslate nohighlight">\(s \in (0, 1)\)</span> with</p>
<div class="math notranslate nohighlight" id="equation-coase-env">
<span class="eqno">(15.8)<a class="headerlink" href="#equation-coase-env" title="Permalink to this equation">#</a></span>\[(p^*)'(s) = c'(\ell^*(s))\]</div>
<p>Equation <a class="reference internal" href="#equation-coase-env">(15.8)</a> follows from <span class="math notranslate nohighlight">\(p^*(s) = \min_{t \leq s}  \, \{ c(s-t) + \delta p^*(t) \}\)</span> and the envelope theorem for derivatives.</p>
<p>A related equation is the first order condition for <span class="math notranslate nohighlight">\(p^*(s) = \min_{t \leq s} \, \{ c(s-t) + \delta p^*(t) \}\)</span>, the minimization problem for a firm with upstream boundary <span class="math notranslate nohighlight">\(s\)</span>, which is</p>
<div class="math notranslate nohighlight" id="equation-coase-foc">
<span class="eqno">(15.9)<a class="headerlink" href="#equation-coase-foc" title="Permalink to this equation">#</a></span>\[\delta (p^*)'(t^*(s)) = c'(s - t^*(s))\]</div>
<p>This condition matches the marginal condition expressed verbally by
Coase that we stated above:</p>
<blockquote>
<div><p>“A firm will tend to expand until the costs of organizing an extra
transaction within the firm become equal to the costs of carrying
out the same transaction by means of an exchange on the
open market…”</p>
</div></blockquote>
<p>Combining <a class="reference internal" href="#equation-coase-env">(15.8)</a> and <a class="reference internal" href="#equation-coase-foc">(15.9)</a> and evaluating at <span class="math notranslate nohighlight">\(s=t_i\)</span>, we see that active firms that are adjacent satisfy</p>
<div class="math notranslate nohighlight" id="equation-coase-euler">
<span class="eqno">(15.10)<a class="headerlink" href="#equation-coase-euler" title="Permalink to this equation">#</a></span>\[\delta \, c'(\ell^*_{i+1}) = c'(\ell^*_i)\]</div>
<p>In other words, the marginal in-house cost per task at a given firm is equal to that of its upstream partner multiplied by gross transaction cost.</p>
<p>This expression can be thought of as a <strong>Coase–Euler equation,</strong> which determines
inter-firm efficiency by indicating how two costly forms of coordination (markets and management) are jointly minimized in equilibrium.</p>
</section>
</section>
<section id="implementation">
<h2><span class="section-number">15.5. </span>Implementation<a class="headerlink" href="#implementation" title="Permalink to this heading">#</a></h2>
<p>For most specifications of primitives, there is no closed-form solution for the equilibrium as far as we are aware.</p>
<p>However, we know that we can compute the equilibrium corresponding to a given transaction cost parameter <span class="math notranslate nohighlight">\(\delta\)</span>  and a cost function <span class="math notranslate nohighlight">\(c\)</span>
by applying the results stated above.</p>
<p>In particular, we can</p>
<ol class="arabic simple">
<li><p>fix initial condition <span class="math notranslate nohighlight">\(p \in \mathcal P\)</span>,</p></li>
<li><p>iterate with <span class="math notranslate nohighlight">\(T\)</span> until <span class="math notranslate nohighlight">\(T^n p\)</span> has converged to <span class="math notranslate nohighlight">\(p^*\)</span>, and</p></li>
<li><p>recover firm choices via the choice function <a class="reference internal" href="#equation-coase-deft">(15.3)</a></p></li>
</ol>
<p>At each iterate, we will use continuous piecewise linear interpolation of functions.</p>
<p>To begin, here’s a class to store primitives and a grid:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ProductionChain</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
            <span class="n">delta</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span>
            <span class="n">c</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">c</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-04</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s implement and iterate with <span class="math notranslate nohighlight">\(T\)</span> until convergence.</p>
<p>Recalling that our initial condition must lie in <span class="math notranslate nohighlight">\(\mathcal P\)</span>, we set
<span class="math notranslate nohighlight">\(p_0 = c\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_prices</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">5000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute prices by iterating with T</span>

<span class="sd">        * pc is an instance of ProductionChain</span>
<span class="sd">        * The initial condition is p = c</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">delta</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">grid</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">delta</span><span class="p">,</span> <span class="n">pc</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="n">pc</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">pc</span><span class="o">.</span><span class="n">grid</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>  <span class="c1"># Initial condition is c(s), as an array</span>
    <span class="n">new_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">tol</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span> <span class="n">error</span> <span class="o">&gt;</span> <span class="n">tol</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">max_iter</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">grid</span><span class="p">):</span>
            <span class="n">Tp</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">delta</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span><span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span>
            <span class="n">new_p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">(</span><span class="n">fminbound</span><span class="p">(</span><span class="n">Tp</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">new_p</span><span class="p">))</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">new_p</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">max_iter</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteration converged in </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> steps&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: iteration hit upper bound </span><span class="si">{</span><span class="n">max_iter</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">p_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p_func</span>
</pre></div>
</div>
</div>
</div>
<p>The next function computes optimal choice of upstream boundary and range of
task implemented for a firm face price function p_function and with downstream boundary <span class="math notranslate nohighlight">\(s\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">optimal_choices</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span> <span class="n">p_function</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes p_func as the true function, minimizes on [0,s]</span>

<span class="sd">    Returns optimal upstream boundary t_star and optimal size of</span>
<span class="sd">    firm ell_star</span>

<span class="sd">    In fact, the algorithm minimizes on [-1,s] and then takes the</span>
<span class="sd">    max of the minimizer and zero. This results in better results</span>
<span class="sd">    close to zero</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">delta</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">delta</span><span class="p">,</span> <span class="n">pc</span><span class="o">.</span><span class="n">c</span>
    <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">delta</span> <span class="o">*</span> <span class="n">p_function</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span><span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">t_star</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">fminbound</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">ell_star</span> <span class="o">=</span> <span class="n">s</span> <span class="o">-</span> <span class="n">t_star</span>
    <span class="k">return</span> <span class="n">t_star</span><span class="p">,</span> <span class="n">ell_star</span>
</pre></div>
</div>
</div>
</div>
<p>The allocation of firms can be computed by recursively stepping through firms’ choices of
their respective upstream boundary, treating the previous firm’s upstream boundary as their own downstream boundary.</p>
<p>In doing so, we start with firm 1, who has downstream boundary <span class="math notranslate nohighlight">\(s=1\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_stages</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span> <span class="n">p_function</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">transaction_stages</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="p">]</span>
    <span class="k">while</span> <span class="n">s</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">s</span><span class="p">,</span> <span class="n">ell</span> <span class="o">=</span> <span class="n">optimal_choices</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span> <span class="n">p_function</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
        <span class="n">transaction_stages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">transaction_stages</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s try this at the default parameters.</p>
<p>The next figure shows the equilibrium price function, as well as the
boundaries of firms as vertical lines</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pc</span> <span class="o">=</span> <span class="n">ProductionChain</span><span class="p">()</span>
<span class="n">p_star</span> <span class="o">=</span> <span class="n">compute_prices</span><span class="p">(</span><span class="n">pc</span><span class="p">)</span>

<span class="n">transaction_stages</span> <span class="o">=</span> <span class="n">compute_stages</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span> <span class="n">p_star</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">grid</span><span class="p">,</span> <span class="n">p_star</span><span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">grid</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">transaction_stages</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;0.5&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration converged in 2 steps
</pre></div>
</div>
<img alt="_images/97eba0841e6a4696e4a2865c0b0e230281168457f2714fb6e6f4621ea24ef9aa.png" src="_images/97eba0841e6a4696e4a2865c0b0e230281168457f2714fb6e6f4621ea24ef9aa.png" />
</div>
</div>
<p>Here’s the function <span class="math notranslate nohighlight">\(\ell^*\)</span>, which shows how large a firm with
downstream boundary <span class="math notranslate nohighlight">\(s\)</span> chooses to be</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ell_star</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">grid</span><span class="p">):</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">optimal_choices</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span> <span class="n">p_star</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">ell_star</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">grid</span><span class="p">,</span> <span class="n">ell_star</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$\ell^*$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:7: SyntaxWarning: invalid escape sequence &#39;\e&#39;
&lt;&gt;:7: SyntaxWarning: invalid escape sequence &#39;\e&#39;
/tmp/ipykernel_6127/1434438249.py:7: SyntaxWarning: invalid escape sequence &#39;\e&#39;
  ax.plot(pc.grid, ell_star, label=&quot;$\ell^*$&quot;)
</pre></div>
</div>
<img alt="_images/45d0220feb7876f8d431815781de8d35f2953094f13fbb09d9b4fe6f76a4bed5.png" src="_images/45d0220feb7876f8d431815781de8d35f2953094f13fbb09d9b4fe6f76a4bed5.png" />
</div>
</div>
<p>Note that downstream firms choose to be larger, a point we return to below.</p>
</section>
<section id="exercises">
<h2><span class="section-number">15.6. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<div class="exercise admonition" id="coa_ex1">
<span id="lucas-asset-exer1"></span>
<p class="admonition-title"><span class="caption-number">Exercise 15.1 </span></p>
<section id="exercise-content">
<p>The number of firms is endogenously determined by the primitives.</p>
<p>What do you think will happen in terms of the number of firms as <span class="math notranslate nohighlight">\(\delta\)</span> increases?  Why?</p>
<p>Check your intuition by computing the number of firms at delta in (1.01, 1.05, 1.1).</p>
</section>
</div>
<div class="solution dropdown admonition" id="coase-solution-1">

<p class="admonition-title">Solution to<a class="reference internal" href="#coa_ex1"> Exercise 15.1</a></p>
<section id="solution-content">
<p>Here is one solution</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">delta</span> <span class="ow">in</span> <span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">):</span>

   <span class="n">pc</span> <span class="o">=</span> <span class="n">ProductionChain</span><span class="p">(</span><span class="n">delta</span><span class="o">=</span><span class="n">delta</span><span class="p">)</span>
   <span class="n">p_star</span> <span class="o">=</span> <span class="n">compute_prices</span><span class="p">(</span><span class="n">pc</span><span class="p">)</span>
   <span class="n">transaction_stages</span> <span class="o">=</span> <span class="n">compute_stages</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span> <span class="n">p_star</span><span class="p">)</span>
   <span class="n">num_firms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">transaction_stages</span><span class="p">)</span>
   <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;When delta=</span><span class="si">{</span><span class="n">delta</span><span class="si">}</span><span class="s2"> there are </span><span class="si">{</span><span class="n">num_firms</span><span class="si">}</span><span class="s2"> firms&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration converged in 2 steps
When delta=1.01 there are 64 firms
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration converged in 2 steps
When delta=1.05 there are 41 firms
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration converged in 2 steps
When delta=1.1 there are 35 firms
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="exercise admonition" id="coa_ex2">

<p class="admonition-title"><span class="caption-number">Exercise 15.2 </span></p>
<section id="exercise-content">
<p>The <strong>value added</strong> of firm <span class="math notranslate nohighlight">\(i\)</span> is <span class="math notranslate nohighlight">\(v_i := p^*(t_{i-1}) - p^*(t_i)\)</span>.</p>
<p>One of the interesting predictions of the model is that value added is increasing with downstreamness, as are several other measures of firm size.</p>
<p>Can you give any intution?</p>
<p>Try to verify this phenomenon (value added increasing with downstreamness) using the code above.</p>
</section>
</div>
<div class="solution dropdown admonition" id="coase-solution-3">

<p class="admonition-title">Solution to<a class="reference internal" href="#coa_ex2"> Exercise 15.2</a></p>
<section id="solution-content">
<p>Firm size increases with downstreamness because <span class="math notranslate nohighlight">\(p^*\)</span>, the equilibrium price function, is increasing and strictly convex.</p>
<p>This means that, for a given producer, the marginal cost of the input purchased from the producer just upstream from itself in the chain increases as we go further downstream.</p>
<p>Hence downstream firms choose to do more in house than upstream firms — and are therefore larger.</p>
<p>The equilibrium price function is strictly convex due to both transaction
costs and diminishing returns to management.</p>
<p>One way to put this is that firms are prevented from completely mitigating the costs
associated with diminishing returns to management — which induce convexity — by transaction costs.  This is because transaction costs force firms to have nontrivial size.</p>
<p>Here’s one way to compute and graph value added across firms</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pc</span> <span class="o">=</span> <span class="n">ProductionChain</span><span class="p">()</span>
<span class="n">p_star</span> <span class="o">=</span> <span class="n">compute_prices</span><span class="p">(</span><span class="n">pc</span><span class="p">)</span>
<span class="n">stages</span> <span class="o">=</span> <span class="n">compute_stages</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span> <span class="n">p_star</span><span class="p">)</span>

<span class="n">va</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stages</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">va</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_star</span><span class="p">(</span><span class="n">stages</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">p_star</span><span class="p">(</span><span class="n">stages</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">va</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;value added by firm&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">((</span><span class="s2">&quot;downstream firms&quot;</span><span class="p">,</span> <span class="s2">&quot;upstream firms&quot;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration converged in 2 steps
</pre></div>
</div>
<img alt="_images/05af6fa056cff852796b2bdc06cf4978e26550b47d752e0d6a01b29889103174.png" src="_images/05af6fa056cff852796b2bdc06cf4978e26550b47d752e0d6a01b29889103174.png" />
</div>
</div>
</section>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tools and Techniques
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="orth_proj.html">
   1. Orthogonal Projections and Their Applications
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stationary_densities.html">
   2. Continuous State Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="muth_kalman.html">
   3. Reverse Engineering a la Muth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="discrete_dp.html">
   4. Discrete State Dynamic Programming
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  LQ Control
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="cons_news.html">
   5. Information and Consumption Smoothing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="smoothing.html">
   6. Consumption Smoothing with Complete and Incomplete Markets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="smoothing_tax.html">
   7. Tax Smoothing with Complete and Incomplete Markets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_jump_lq.html">
   8. Markov Jump Linear Quadratic Dynamic Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tax_smoothing_1.html">
   9. How to Pay for a War: Part 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tax_smoothing_2.html">
   10. How to Pay for a War: Part 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tax_smoothing_3.html">
   11. How to Pay for a War: Part 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lqramsey.html">
   12. Optimal Taxation in an LQ Economy
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Multiple Agent Models
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="arellano.html">
   13. Default Risk and Income Fluctuations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="matsuyama.html">
   14. Globalization and Cycles
  </a>
 </li>
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   15. Coase’s Theory of the Firm
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Dynamic Linear Economies
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="hs_recursive_models.html">
   16. Recursive Models of Dynamic Linear Economies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="growth_in_dles.html">
   17. Growth in Dynamic Linear Economies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lucas_asset_pricing_dles.html">
   18. Lucas Asset Pricing Using DLE
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="irfs_in_hall_model.html">
   19. IRFs in Hall Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="permanent_income_dles.html">
   20. Permanent Income Model using the DLE Class
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rosen_schooling_model.html">
   21. Rosen Schooling Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cattle_cycles.html">
   22. Cattle Cycles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hs_invertibility_example.html">
   23. Shock Non Invertibility
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Risk, Model Uncertainty, and Robustness
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="five_preferences.html">
   24. Risk and Model Uncertainty
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="entropy.html">
   25. Etymology of Entropy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="robustness.html">
   26. Robustness
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rob_markov_perf.html">
   27. Robust Markov Perfect Equilibrium
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Time Series Models
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="arma.html">
   28. Covariance Stationary Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="estspec.html">
   29. Estimation of Spectra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="additive_functionals.html">
   30. Additive and Multiplicative Functionals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lu_tricks.html">
   31. Classical Control with Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="classical_filtering.html">
   32. Classical Prediction and Filtering With Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="knowing_forecasts_of_others.html">
   33. Knowing the Forecasts of Others
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Asset Pricing and Finance
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lucas_model.html">
   34. Asset Pricing II: The Lucas Asset Pricing Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="asset_pricing_lph.html">
   35. Elementary Asset Pricing Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="black_litterman.html">
   36. Two Modifications of Mean-Variance Portfolio Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="BCG_complete_mkts.html">
   37. Irrelevance of Capital Structures with Complete Markets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="BCG_incomplete_mkts.html">
   38. Equilibrium Capital Structures with Incomplete Markets
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Dynamic Programming Squared
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="un_insure.html">
   39. Optimal Unemployment Insurance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dyn_stack.html">
   40. Stackelberg Plans
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="calvo_machine_learn.html">
   41. Machine Learning a Ramsey Plan
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="calvo.html">
   42. Time Inconsistency of Ramsey Plans
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="calvo_abreu.html">
   43. Sustainable Plans for a Calvo Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="opt_tax_recur.html">
   44. Optimal Taxation with State-Contingent Debt
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="amss.html">
   45. Optimal Taxation without State-Contingent Debt
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="amss2.html">
   46. Fluctuating Interest Rates Deliver Fiscal Insurance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="amss3.html">
   47. Fiscal Risk and Government Debt
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chang_ramsey.html">
   48. Competitive Equilibria of a Model of Chang
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chang_credible.html">
   49. Credible Government Policies in a Model of Chang
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Other
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="troubleshooting.html">
   50. Troubleshooting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zreferences.html">
   51. References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="status.html">
   52. Execution Statistics
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="intro.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                </ul>

                <ul class="qe-toolbar__links">
                    <li class="btn__search">
                        <form action="search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off" accesskey="k">
                            <i data-feather="search" id="search-icon"></i>
                        </form>
                    </li>
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li data-tippy-content="Download Notebook"><a href="/_notebooks/coase.ipynb" download><i data-feather="download-cloud"></i></a></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li class="download-pdf" id="downloadButton"><i data-feather="file"></i></li>
                    <!--
                    # Enable if looking for link to specific document hosted on GitHub
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python-advanced.myst/blob/main/lectures/coase.md" download><i data-feather="github"></i></a></li>
                    -->
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python-advanced.myst" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="/_pdf/quantecon-python-advanced.pdf" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://colab.research.google.com/github/QuantEcon/lecture-python-advanced.notebooks/blob/main/coase.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/QuantEcon/lecture-python-advanced.notebooks" data-urlpath="tree/lecture-python-advanced.notebooks/coase.ipynb" data-branch=main>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://colab.research.google.com/github/QuantEcon/lecture-python-advanced.notebooks/blob/main/coase.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "coase";
                const repoURL = "https://github.com/QuantEcon/lecture-python-advanced.notebooks";
                const urlPath = "tree/lecture-python-advanced.notebooks/coase.ipynb";
                const branch = "main"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/jupyter/hub/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
  </body>
</html>