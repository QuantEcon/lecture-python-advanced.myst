

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>39. Optimal Unemployment Insurance &#8212; Advanced Quantitative Economics with Python</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/quantecon-book-theme.279dae03c5caae754d20501e3fa00bbf.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />


    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script src="_static/quantecon-book-theme.15b0c36fffe88f468997fa7b698991d3.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-KZLV7PM9LL"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-KZLV7PM9LL');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"argmax": "arg\\,max", "argmin": "arg\\,min", "col": "col", "Span": "span", "epsilon": "\\varepsilon", "EE": "\\mathbb{E}", "PP": "\\mathbb{P}", "RR": "\\mathbb{R}", "NN": "\\mathbb{N}", "ZZ": "\\mathbb{Z}", "aA": "\\mathcal{A}", "bB": "\\mathcal{B}", "cC": "\\mathcal{C}", "dD": "\\mathcal{D}", "eE": "\\mathcal{E}", "fF": "\\mathcal{F}", "gG": "\\mathcal{G}", "hH": "\\mathcal{H}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'un_insure';</script>
    <link rel="canonical" href="https://python-advanced.quantecon.org/un_insure.html" />
    <link rel="shortcut icon" href="_static/lectures-favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="40. Stackelberg Plans" href="dyn_stack.html" />
    <link rel="prev" title="38. Equilibrium Capital Structures with Incomplete Markets" href="BCG_incomplete_mkts.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Thomas J. Sargent &amp; John Stachurski" />
<meta name="keywords" content="Python, QuantEcon, Quantitative Economics, Economics, Sloan, Alfred P. Sloan Foundation, Tom J. Sargent, John Stachurski" />
<meta name="description" content=This website presents a set of lectures on advanced quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski. />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="Optimal Unemployment Insurance"/>
<meta name="twitter:description" content="This website presents a set of lectures on advanced quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski.">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="Optimal Unemployment Insurance" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://python-advanced.quantecon.org/un_insure.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="This website presents a set of lectures on advanced quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski." />
<meta property="og:site_name" content="Advanced Quantitative Economics with Python" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>


    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=un_insure>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">39.1. Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shavell-and-weisss-model">39.2. Shavell and Weissâ€™s Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#autarky">39.2.1. Autarky</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#full-information">39.2.2. Full Information</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#incentive-problem">39.2.3. Incentive Problem</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#private-information">39.3. Private Information</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computational-details">39.3.1. Computational Details</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#python-computations">39.3.2. Python Computations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameter-values">39.3.3. Parameter Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computation-under-private-information">39.3.4. Computation under Private Information</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithm">39.3.5. Algorithm</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outcomes">39.4. Outcomes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#replacement-ratios-and-continuation-values">39.4.1. Replacement Ratios and Continuation Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretations">39.4.2. Interpretations</a></li>
</ul>
</li>
</ul>
                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="_static/qe-logo-large.png" class="logo" alt="logo"></a>
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="intro.html">Advanced Quantitative Economics with Python</a></p>

                        <p class="qe-page__header-subheading">Optimal Unemployment Insurance</p>

                    </div>

                    <p class="qe-page__header-authors">Thomas J. Sargent & John Stachurski</p>

                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <section class="tex2jax_ignore mathjax_ignore" id="optimal-unemployment-insurance">
<h1><span class="section-number">39. </span>Optimal Unemployment Insurance<a class="headerlink" href="#optimal-unemployment-insurance" title="Permalink to this heading">#</a></h1>
<section id="overview">
<h2><span class="section-number">39.1. </span>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h2>
<p>This lecture describes a model of optimal unemployment
insurance created by  Shavell and Weiss (1979) <span id="id1">[<a class="reference internal" href="zreferences.html#id6" title="Steven Shavell and Laurence Weiss. The optimal payment of unemployment insurance benefits over time. Journal of political Economy, 87(6):1347-1362, 1979.">SW79</a>]</span>.</p>
<p>We  use recursive techniques of
Hopenhayn and Nicolini (1997) <span id="id2">[<a class="reference internal" href="zreferences.html#id5" title="Hugo A Hopenhayn and Juan Pablo Nicolini. Optimal Unemployment Insurance. Journal of Political Economy, 105(2):412-438, April 1997. URL: https://ideas.repec.org/a/ucp/jpolec/v105y1997i2p412-38.html, doi:10.1086/262078.">HN97</a>]</span> to
compute optimal insurance plans for  Shavell and
Weissâ€™s model.</p>
<p>Hopenhayn and Nicoliniâ€™s model is a generalization of Shavell and Weissâ€™s along dimensions that weâ€™ll soon describe.</p>
</section>
<section id="shavell-and-weisss-model">
<h2><span class="section-number">39.2. </span>Shavell and Weissâ€™s Model<a class="headerlink" href="#shavell-and-weisss-model" title="Permalink to this heading">#</a></h2>
<p>An unemployed worker orders stochastic processes of
consumption and  search effort <span class="math notranslate nohighlight">\(\{c_t , a_t\}_{t=0}^\infty\)</span>
according to</p>
<div class="math notranslate nohighlight" id="equation-eq-hugo1">
<span class="eqno">(39.1)<a class="headerlink" href="#equation-eq-hugo1" title="Permalink to this equation">#</a></span>\[ 
E \sum_{t=0}^\infty \beta^t \left[ u(c_t) - a_t \right]  
\]</div>
<p>where <span class="math notranslate nohighlight">\(\beta \in (0,1)\)</span> and <span class="math notranslate nohighlight">\(u(c)\)</span> is strictly increasing, twice differentiable,
and strictly concave.</p>
<p>We assume that <span class="math notranslate nohighlight">\(u(0)\)</span> is well defined.</p>
<p>We require that <span class="math notranslate nohighlight">\(c_t \geq 0\)</span> and <span class="math notranslate nohighlight">\( a_t \geq 0\)</span>.</p>
<p>All jobs are alike and pay wage
<span class="math notranslate nohighlight">\(w &gt;0\)</span> units of the consumption good each period forever.</p>
<p>An unemployed
worker searches with effort <span class="math notranslate nohighlight">\(a\)</span> and with probability
<span class="math notranslate nohighlight">\(p(a)\)</span> receives a permanent job at the beginning
of the next period.</p>
<p>Furthermore, <span class="math notranslate nohighlight">\(a=0\)</span> when the worker is
employed.</p>
<p>The probability
of finding a job  is <span class="math notranslate nohighlight">\(p(a)\)</span> where <span class="math notranslate nohighlight">\(p\)</span> is an increasing, strictly concave,
and twice differentiable function of <span class="math notranslate nohighlight">\(a\)</span> that satisfies
<span class="math notranslate nohighlight">\(p(a)   \in [0,1]\)</span> for  <span class="math notranslate nohighlight">\(a \geq 0\)</span>, <span class="math notranslate nohighlight">\(p(0)=0\)</span>.</p>
<p>The consumption good is nonstorable.</p>
<p>An unemployed worker has no savings and cannot borrow or lend.</p>
<p>An <strong>insurance agency</strong> or <strong>planner</strong> is the unemployed workerâ€™s only source of consumption
smoothing over time and across states.</p>
<p>Once a worker has found a job, he is beyond the plannerâ€™s grasp.</p>
<ul class="simple">
<li><p>This is Shavell and Weissâ€™s assumption, but not Hopenhayn and Nicoliniâ€™s.</p></li>
<li><p>Hopenhayn and Nicolini allow the unemployment insurance agency to
impose history-dependent taxes on previously unemployed workers.</p></li>
<li><p>Since there is no incentive problem after the worker has found
a job, it is optimal for the agency to provide an employed worker with
a constant level of consumption.</p></li>
<li><p>Hence, Hopenhayn and Nicoliniâ€™s insurance agency imposes
a permanent per-period history-dependent tax on a previously
unemployed but presently employed worker.</p></li>
</ul>
<section id="autarky">
<h3><span class="section-number">39.2.1. </span>Autarky<a class="headerlink" href="#autarky" title="Permalink to this heading">#</a></h3>
<p>As a benchmark, we first study the fate of an unemployed worker
who has no access to unemployment insurance.</p>
<p>Because employment
is an absorbing state for the worker, we work backward from that
state.</p>
<p>Let <span class="math notranslate nohighlight">\(V^e\)</span> be the expected sum of discounted one-period utilities of an employed worker.</p>
<p>Once the worker is employed, <span class="math notranslate nohighlight">\(a=0\)</span>, making  his period utility
be <span class="math notranslate nohighlight">\(u(c)-a = u(w)\)</span> forever.</p>
<p>Therefore,</p>
<div class="math notranslate nohighlight" id="equation-eq-hugo2">
<span class="eqno">(39.2)<a class="headerlink" href="#equation-eq-hugo2" title="Permalink to this equation">#</a></span>\[  
V^e = {u(w) \over (1-\beta)}  . 
\]</div>
<p>Now let <span class="math notranslate nohighlight">\(V^u\)</span> be the expected discounted present value of utility for an
unemployed worker who chooses  consumption, effort  pair <span class="math notranslate nohighlight">\((c,a)\)</span>
optimally.</p>
<p>It satisfies the Bellman equation</p>
<div class="math notranslate nohighlight" id="equation-eq-hugo3">
<span class="eqno">(39.3)<a class="headerlink" href="#equation-eq-hugo3" title="Permalink to this equation">#</a></span>\[ 
V^u = \max_{a \geq 0} \biggl\{ u(0) - a + \beta \left[
   p(a) V^e + (1-p(a)) V^u \right] \biggr\} .  
\]</div>
<p>The first-order condition for a maximum is</p>
<div class="math notranslate nohighlight" id="equation-eq-hugo4">
<span class="eqno">(39.4)<a class="headerlink" href="#equation-eq-hugo4" title="Permalink to this equation">#</a></span>\[ 
\beta p'(a) \left[V^e - V^u \right] \leq 1 , 
\]</div>
<p>with equality if <span class="math notranslate nohighlight">\(a&gt;0\)</span>.</p>
<p>Since there is no state variable in this
infinite horizon problem, there is a time-invariant optimal
search intensity <span class="math notranslate nohighlight">\(a\)</span> and an associated value of being unemployed <span class="math notranslate nohighlight">\(V^u\)</span>.</p>
<p>Let <span class="math notranslate nohighlight">\(V_{\rm aut} = V^u\)</span> solve Bellman equation <a class="reference internal" href="#equation-eq-hugo3">(39.3)</a>.</p>
<p>Equations <a class="reference internal" href="#equation-eq-hugo3">(39.3)</a>
and <a class="reference internal" href="#equation-eq-hugo4">(39.4)</a>
form the basis for
an iterative algorithm for computing <span class="math notranslate nohighlight">\(V^u = V_{\rm aut}\)</span>.</p>
<ul class="simple">
<li><p>Let <span class="math notranslate nohighlight">\(V^u_j\)</span> be
the estimate of <span class="math notranslate nohighlight">\(V_{\rm aut}\)</span> at the <span class="math notranslate nohighlight">\(j\)</span>th iteration.</p></li>
<li><p>Use this value
in equation <a class="reference internal" href="#equation-eq-hugo4">(39.4)</a>  and solve
for an estimate of effort  <span class="math notranslate nohighlight">\(a_j\)</span>.</p></li>
<li><p>Use this value in a version of equation
<a class="reference internal" href="#equation-eq-hugo3">(39.3)</a> with <span class="math notranslate nohighlight">\(V^u_j\)</span> on the right side
to compute <span class="math notranslate nohighlight">\(V^u_{j+1}\)</span>.</p></li>
<li><p>Iterate to convergence.</p></li>
</ul>
</section>
<section id="full-information">
<h3><span class="section-number">39.2.2. </span>Full Information<a class="headerlink" href="#full-information" title="Permalink to this heading">#</a></h3>
<p>Another benchmark model helps set the stage for the model with private information that we ultimately want to study.</p>
<p>In this model, the unemployment agency has full information about the unemployed work.</p>
<p>We study optimal provision of insurance with
full information.</p>
<p>An insurance agency can set both
the  consumption and search effort of an unemployed person.</p>
<p>The
agency wants to design an unemployment insurance contract to give
the unemployed worker expected discounted utility <span class="math notranslate nohighlight">\(V &gt; V_{\rm aut}\)</span>.</p>
<p>The planner wants to deliver value <span class="math notranslate nohighlight">\(V\)</span> efficiently,
meaning in a  way that minimizes expected
discounted cost, using <span class="math notranslate nohighlight">\(\beta\)</span> as the discount factor.</p>
<p>We formulate the optimal insurance problem
recursively.</p>
<p>Let <span class="math notranslate nohighlight">\(C(V)\)</span> be the expected discounted cost of giving
the worker expected discounted utility
<span class="math notranslate nohighlight">\(V\)</span>.</p>
<p>The cost function is strictly convex because
a higher <span class="math notranslate nohighlight">\(V\)</span> implies a lower marginal utility of the worker;
that is, additional expected utils can be awarded to the worker
only at an increasing marginal cost in terms of the consumption good.</p>
<p>Given <span class="math notranslate nohighlight">\(V\)</span>, the planner assigns first-period pair   <span class="math notranslate nohighlight">\((c,a)\)</span> and promised
continuation value <span class="math notranslate nohighlight">\(V^u\)</span>, should  the worker  be unlucky
and not find a job.</p>
<p><span class="math notranslate nohighlight">\((c, a, V^u)\)</span> are chosen to be functions of <span class="math notranslate nohighlight">\(V\)</span> and to
satisfy the Bellman equation</p>
<div class="math notranslate nohighlight" id="equation-eq-hugo5">
<span class="eqno">(39.5)<a class="headerlink" href="#equation-eq-hugo5" title="Permalink to this equation">#</a></span>\[ 
C(V) = \min_{c, a, V^u} \biggl\{ c  + \beta [1 - p(a)] C(V^u) \biggr\} ,
\]</div>
<p>where  minimization is subject to the promise-keeping constraint</p>
<div class="math notranslate nohighlight" id="equation-eq-hugo6">
<span class="eqno">(39.6)<a class="headerlink" href="#equation-eq-hugo6" title="Permalink to this equation">#</a></span>\[
V \leq u(c) - a + \beta
\left\{ p(a) V^e + [1-p(a)] V^u \right\}.
\]</div>
<p>Here <span class="math notranslate nohighlight">\(V^e\)</span> is given by equation <a class="reference internal" href="#equation-eq-hugo2">(39.2)</a>, which reflects the
assumption that once the worker is employed, he is beyond the
reach of the unemployment insurance agency.</p>
<p>The right side of  Bellman equation <a class="reference internal" href="#equation-eq-hugo5">(39.5)</a> is attained by
policy functions <span class="math notranslate nohighlight">\(c=c(V), a=a(V)\)</span>, and <span class="math notranslate nohighlight">\(V^u=V^u(V)\)</span>.</p>
<p>The promise-keeping constraint,
equation  <a class="reference internal" href="#equation-eq-hugo6">(39.6)</a>,
asserts that the 3-tuple <span class="math notranslate nohighlight">\((c, a, V^u)\)</span> attains
at least <span class="math notranslate nohighlight">\(V\)</span>.</p>
<p>Let <span class="math notranslate nohighlight">\(\theta\)</span> be a Lagrange multiplier
on constraint <a class="reference internal" href="#equation-eq-hugo6">(39.6)</a>.</p>
<p>At an interior solution, the first-order
conditions with
respect to <span class="math notranslate nohighlight">\(c, a\)</span>, and <span class="math notranslate nohighlight">\(V^u\)</span>, respectively, are</p>
<div class="math notranslate nohighlight" id="equation-eq-hugo7">
<span class="eqno">(39.7)<a class="headerlink" href="#equation-eq-hugo7" title="Permalink to this equation">#</a></span>\[
\begin{aligned} \theta &amp; = {1 \over u'(c)}\,,   \cr
             C(V^u) &amp; = \theta \left[ {1 \over \beta p'(a)} -
                           (V^e - V^u) \right]\,,    \cr
             C'(V^u) &amp; = \theta\,.   
\end{aligned}
\]</div>
<p>The envelope condition   <span class="math notranslate nohighlight">\(C'(V) = \theta\)</span> and the third equation
of <a class="reference internal" href="#equation-eq-hugo7">(39.7)</a>  imply that <span class="math notranslate nohighlight">\(C'(V^u) =C'(V)\)</span>.</p>
<p>Strict convexity of <span class="math notranslate nohighlight">\(C\)</span> then
implies that <span class="math notranslate nohighlight">\(V^u =V\)</span></p>
<p>Applied repeatedly over time,
<span class="math notranslate nohighlight">\(V^u=V\)</span> makes
the continuation value remain constant during the entire
spell of unemployment.</p>
<p>The first equation of <a class="reference internal" href="#equation-eq-hugo7">(39.7)</a>
determines <span class="math notranslate nohighlight">\(c\)</span>, and the second equation of <a class="reference internal" href="#equation-eq-hugo7">(39.7)</a>  determines
<span class="math notranslate nohighlight">\(a\)</span>, both as functions of promised value <span class="math notranslate nohighlight">\(V\)</span>.</p>
<p>That <span class="math notranslate nohighlight">\(V^u = V\)</span> then
implies that <span class="math notranslate nohighlight">\(c\)</span> and <span class="math notranslate nohighlight">\(a\)</span> are held constant during the unemployment
spell.</p>
<p>Thus, the unemployed workerâ€™s consumption <span class="math notranslate nohighlight">\(c\)</span> and search effort <span class="math notranslate nohighlight">\(a\)</span> are both fully smoothed
during the unemployment spell.</p>
<p>But the workerâ€™s consumption is not  smoothed across states of
employment and unemployment unless <span class="math notranslate nohighlight">\(V=V^e\)</span>.</p>
</section>
<section id="incentive-problem">
<h3><span class="section-number">39.2.3. </span>Incentive Problem<a class="headerlink" href="#incentive-problem" title="Permalink to this heading">#</a></h3>
<p>The preceding efficient insurance scheme requires that the insurance agency
control both <span class="math notranslate nohighlight">\(c\)</span> and <span class="math notranslate nohighlight">\(a\)</span>.</p>
<p>It will not do for the insurance agency
simply to announce <span class="math notranslate nohighlight">\(c\)</span> and then allow the worker to choose <span class="math notranslate nohighlight">\(a\)</span>.</p>
<p>Here is why.</p>
<p>The  agency delivers a value <span class="math notranslate nohighlight">\(V^u\)</span>  higher than
the autarky value <span class="math notranslate nohighlight">\(V_{\rm aut}\)</span> by doing two things.</p>
<p>It <strong>increases</strong> the unemployed workerâ€™s consumption <span class="math notranslate nohighlight">\(c\)</span> and <strong>decreases</strong> his search
effort <span class="math notranslate nohighlight">\(a\)</span>.</p>
<p>But the prescribed
search effort is <strong>higher</strong> than what the worker would choose
if he were to be guaranteed consumption level <span class="math notranslate nohighlight">\(c\)</span> while he
remains unemployed.</p>
<p>This follows from the first two equations of <a class="reference internal" href="#equation-eq-hugo7">(39.7)</a> and the
fact that the insurance scheme is costly, <span class="math notranslate nohighlight">\(C(V^u)&gt;0\)</span>, which imply
<span class="math notranslate nohighlight">\([ \beta p'(a) ]^{-1} &gt; (V^e - V^u)\)</span>.</p>
<p>But look at the workerâ€™s
first-order condition <a class="reference internal" href="#equation-eq-hugo4">(39.4)</a>  under autarky.</p>
<p>It implies that if search effort <span class="math notranslate nohighlight">\(a&gt;0\)</span>, then
<span class="math notranslate nohighlight">\([\beta p'(a)]^{-1} = [V^e - V^u]\)</span>, which is inconsistent
with the preceding inequality
<span class="math notranslate nohighlight">\([ \beta p'(a) ]^{-1} &gt; (V^e - V^u)\)</span> that prevails when <span class="math notranslate nohighlight">\(a &gt;0\)</span> under
the social
insurance arrangement.</p>
<p>If he were free to choose <span class="math notranslate nohighlight">\(a\)</span>, the worker would therefore want to
fulfill <a class="reference internal" href="#equation-eq-hugo4">(39.4)</a>, either at equality so long as <span class="math notranslate nohighlight">\(a &gt;0\)</span>, or by setting
<span class="math notranslate nohighlight">\(a=0\)</span> otherwise.</p>
<p>Starting from the  <span class="math notranslate nohighlight">\(a\)</span> associated with
the social insurance scheme,
he  would establish the desired equality
in <a class="reference internal" href="#equation-eq-hugo4">(39.4)</a> by <em>lowering</em> <span class="math notranslate nohighlight">\(a\)</span>, thereby decreasing
the term <span class="math notranslate nohighlight">\([ \beta p'(a) ]^{-1}\)</span> (which also lowers <span class="math notranslate nohighlight">\((V^e - V^u)\)</span>
when the value of being
unemployed <span class="math notranslate nohighlight">\(V^u\)</span> increases).</p>
<p>If an equality can be established before
<span class="math notranslate nohighlight">\(a\)</span> reaches zero, this would be the workerâ€™s preferred search effort;
otherwise the worker would find it optimal to accept the insurance
payment, set <span class="math notranslate nohighlight">\(a=0\)</span>,  and  never work again.</p>
<p>Thus, since the worker does not take the
cost of the insurance scheme into account, he would choose a search
effort below the socially optimal one.</p>
<p>The efficient contract
relies on  the agencyâ€™s ability to control <em>both</em> the unemployed
workerâ€™s consumption <em>and</em> his search effort.</p>
</section>
</section>
<section id="private-information">
<h2><span class="section-number">39.3. </span>Private Information<a class="headerlink" href="#private-information" title="Permalink to this heading">#</a></h2>
<p>Following Shavell and Weiss (1979) <span id="id3">[<a class="reference internal" href="zreferences.html#id6" title="Steven Shavell and Laurence Weiss. The optimal payment of unemployment insurance benefits over time. Journal of political Economy, 87(6):1347-1362, 1979.">SW79</a>]</span> and
Hopenhayn and Nicolini (1997) <span id="id4">[<a class="reference internal" href="zreferences.html#id5" title="Hugo A Hopenhayn and Juan Pablo Nicolini. Optimal Unemployment Insurance. Journal of Political Economy, 105(2):412-438, April 1997. URL: https://ideas.repec.org/a/ucp/jpolec/v105y1997i2p412-38.html, doi:10.1086/262078.">HN97</a>]</span>, now assume that  the unemployment insurance agency cannot
observe or enforce <span class="math notranslate nohighlight">\(a\)</span>, though it can observe and control <span class="math notranslate nohighlight">\(c\)</span>.</p>
<p>The worker is free to choose <span class="math notranslate nohighlight">\(a\)</span>, which puts expression <a class="reference internal" href="#equation-eq-hugo4">(39.4)</a>, the workerâ€™s first-order condition under autarky,
back in the picture.</p>
<ul class="simple">
<li><p>We are assuming that the workerâ€™s
best response to the unemployment insurance arrangement is
completely characterized by the first-order condition <a class="reference internal" href="#equation-eq-hugo4">(39.4)</a>,
an instance of the so-called first-order approach to incentive problems.</p></li>
</ul>
<p>Given a contract, the individual will choose search effort according to
first-order condition <a class="reference internal" href="#equation-eq-hugo4">(39.4)</a>.</p>
<p>This fact leads the insurance agency
to design the unemployment insurance contract to respect this restriction.</p>
<p>Thus, the recursive contract design problem is now to minimize the right side of equation
<a class="reference internal" href="#equation-eq-hugo5">(39.5)</a> subject to expression <a class="reference internal" href="#equation-eq-hugo6">(39.6)</a> and the incentive constraint <a class="reference internal" href="#equation-eq-hugo4">(39.4)</a>.</p>
<p>Since the restrictions <a class="reference internal" href="#equation-eq-hugo4">(39.4)</a> and <a class="reference internal" href="#equation-eq-hugo6">(39.6)</a> are not linear
and generally do not define a convex set, it becomes difficult
to provide conditions under which the solution to the dynamic
programming problem results in a convex function <span class="math notranslate nohighlight">\(C(V)\)</span>.</p>
<ul class="simple">
<li><p>Sometimes this complication can be handled by convexifying
the constraint set through the introduction of lotteries.</p></li>
<li><p>A common finding is that optimal plans do not involve
lotteries, because convexity of the constraint set is a sufficient
but not necessary condition for convexity of the cost function.</p></li>
<li><p>Following Hopenhayn and Nicolini (1997) <span id="id5">[<a class="reference internal" href="zreferences.html#id5" title="Hugo A Hopenhayn and Juan Pablo Nicolini. Optimal Unemployment Insurance. Journal of Political Economy, 105(2):412-438, April 1997. URL: https://ideas.repec.org/a/ucp/jpolec/v105y1997i2p412-38.html, doi:10.1086/262078.">HN97</a>]</span>, we therefore proceed under the assumption that <span class="math notranslate nohighlight">\(C(V)\)</span> is strictly convex in order to characterize the optimal solution.</p></li>
</ul>
<p>Let <span class="math notranslate nohighlight">\(\eta\)</span> be the multiplier on constraint <a class="reference internal" href="#equation-eq-hugo4">(39.4)</a>, while
<span class="math notranslate nohighlight">\(\theta\)</span> continues to denote the multiplier on constraint <a class="reference internal" href="#equation-eq-hugo6">(39.6)</a>.</p>
<p>But now we replace the weak inequality in <a class="reference internal" href="#equation-eq-hugo6">(39.6)</a> by an equality.</p>
<p>The unemployment insurance agency cannot award a higher utility than
<span class="math notranslate nohighlight">\(V\)</span> because that might violate an incentive-compatibility constraint
for exerting the proper search effort in earlier periods.</p>
<p>At an interior solution,  first-order conditions with
respect to <span class="math notranslate nohighlight">\(c, a\)</span>, and <span class="math notranslate nohighlight">\(V^u\)</span>, respectively, are</p>
<div class="math notranslate nohighlight" id="equation-eq-hugo8">
<span class="eqno">(39.8)<a class="headerlink" href="#equation-eq-hugo8" title="Permalink to this equation">#</a></span>\[
\begin{aligned} \theta &amp; = {1 \over u'(c)}\,,   \cr
 C(V^u)  &amp; = \theta \left[ {1 \over \beta p'(a)} - (V^e - V^u) \right]
            \,-\, \eta {p''(a) \over p'(a)} (V^e - V^u)                  \cr
         &amp; = \,- \eta {p''(a) \over p'(a)} (V^e - V^u) \,,   \cr
 C'(V^u) &amp; = \theta \,-\, \eta {p'(a) \over 1-p(a)}\, ,  
\end{aligned} 
\]</div>
<p>where the second equality in the second equation in <a class="reference internal" href="#equation-eq-hugo8">(39.8)</a>  follows from strict equality
of the incentive constraint <a class="reference internal" href="#equation-eq-hugo4">(39.4)</a> when <span class="math notranslate nohighlight">\(a&gt;0\)</span>.</p>
<p>As long as the
insurance scheme is associated with costs, so that <span class="math notranslate nohighlight">\(C(V^u)&gt;0\)</span>, first-order
condition in the second equation of <a class="reference internal" href="#equation-eq-hugo8">(39.8)</a> implies that the multiplier <span class="math notranslate nohighlight">\(\eta\)</span> is strictly
positive.</p>
<p>The first-order condition in the second equation of the third equality in <a class="reference internal" href="#equation-eq-hugo8">(39.8)</a>  and the
envelope condition <span class="math notranslate nohighlight">\(C'(V) = \theta\)</span> together allow us to conclude that
<span class="math notranslate nohighlight">\(C'(V^u) &lt; C'(V)\)</span>.</p>
<p>Convexity of <span class="math notranslate nohighlight">\(C\)</span> then implies that <span class="math notranslate nohighlight">\(V^u &lt; V\)</span>.</p>
<p>After we have also used  the first equation of <a class="reference internal" href="#equation-eq-hugo8">(39.8)</a>, it follows that
in order to provide  the proper incentives, the consumption
of the unemployed worker must decrease as the duration of the unemployment
spell lengthens.</p>
<p>It also follows from <a class="reference internal" href="#equation-eq-hugo4">(39.4)</a> at equality that
search effort <span class="math notranslate nohighlight">\(a\)</span> rises as <span class="math notranslate nohighlight">\(V^u\)</span> falls, i.e., it rises with the duration
of unemployment.</p>
<p>The duration dependence of benefits is  designed to provide
incentives to search.</p>
<p>To see this, from  the third equation of <a class="reference internal" href="#equation-eq-hugo8">(39.8)</a>, notice how
the conclusion that consumption falls with the duration of
unemployment depends on the assumption that more search effort
raises the prospect of finding a job, i.e., that <span class="math notranslate nohighlight">\(p'(a) &gt; 0\)</span>.</p>
<p>If
<span class="math notranslate nohighlight">\(p'(a) =0\)</span>, then  the third equation of <a class="reference internal" href="#equation-eq-hugo8">(39.8)</a> and the strict convexity of <span class="math notranslate nohighlight">\(C\)</span> imply that
<span class="math notranslate nohighlight">\(V^u =V\)</span>.</p>
<p>Thus, when <span class="math notranslate nohighlight">\(p'(a) =0\)</span>, there is no reason for the
planner to make consumption fall with the duration of
unemployment.</p>
<section id="computational-details">
<h3><span class="section-number">39.3.1. </span>Computational Details<a class="headerlink" href="#computational-details" title="Permalink to this heading">#</a></h3>
<p>It is useful to note that there
are natural lower and upper bounds to the set
of continuation values <span class="math notranslate nohighlight">\(V^u\)</span>.</p>
<p>The lower bound is
the expected lifetime utility in autarky,
<span class="math notranslate nohighlight">\(V_{\rm aut}\)</span>.</p>
<p>To compute the upper bound,
represent condition <a class="reference internal" href="#equation-eq-hugo4">(39.4)</a> as</p>
<div class="math notranslate nohighlight">
\[
V^u \geq V^e  - [\beta  p'(a)]^{-1},
\]</div>
<p>with equality if <span class="math notranslate nohighlight">\( a &gt; 0\)</span>.</p>
<p>If there is zero search effort, then <span class="math notranslate nohighlight">\(V^u \geq V^e -[\beta p'(0)]^{-1}\)</span>.</p>
<p>Therefore, to rule out zero search effort we require</p>
<div class="math notranslate nohighlight">
\[
V^u &lt; V^e - [\beta p'(0)]^{-1} .
\]</div>
<p>(Remember that <span class="math notranslate nohighlight">\(p''(a) &lt; 0\)</span>.)</p>
<p>This step gives  our upper bound
for <span class="math notranslate nohighlight">\(V^u\)</span>.</p>
<p>To formulate the Bellman equation numerically,
we suggest using the constraints to eliminate <span class="math notranslate nohighlight">\(c\)</span> and <span class="math notranslate nohighlight">\(a\)</span> as choice
variables, thereby reducing the Bellman equation to
a minimization over the one choice variable <span class="math notranslate nohighlight">\(V^u\)</span>.</p>
<p>First express the promise-keeping constraint <a class="reference internal" href="#equation-eq-hugo6">(39.6)</a>  at equality as</p>
<div class="math notranslate nohighlight">
\[ 
u(c) = V + a - \beta \{p(a) V^e +[1-p(a)] V^u \} 
\]</div>
<p>so that  consumption is</p>
<div class="math notranslate nohighlight" id="equation-eq-hugo21">
<span class="eqno">(39.9)<a class="headerlink" href="#equation-eq-hugo21" title="Permalink to this equation">#</a></span>\[ 
c = u^{-1}\left(
     V+a -\beta [p(a)V^e + (1-p(a))V^u] \right). 
\]</div>
<p>Similarly, solving the inequality <a class="reference internal" href="#equation-eq-hugo4">(39.4)</a>  for <span class="math notranslate nohighlight">\(a\)</span>  leads to</p>
<div class="math notranslate nohighlight" id="equation-eq-hugo22a">
<span class="eqno">(39.10)<a class="headerlink" href="#equation-eq-hugo22a" title="Permalink to this equation">#</a></span>\[
a = \max\left\{0, p'^{-1} \left({ 1 \over \beta (V^e - V^u)  } \right) \right\}.
\]</div>
<p>When we specialize <a class="reference internal" href="#equation-eq-hugo22a">(39.10)</a> to the   functional
form for <span class="math notranslate nohighlight">\(p(a)\)</span> used by Hopenhayn and Nicolini, we obtain</p>
<div class="math notranslate nohighlight" id="equation-eq-hugo22">
<span class="eqno">(39.11)<a class="headerlink" href="#equation-eq-hugo22" title="Permalink to this equation">#</a></span>\[
a = \max\left\{0, {\log[r \beta (V^e - V^u)] \over r } \right\}.
\]</div>
<p>Formulas <a class="reference internal" href="#equation-eq-hugo21">(39.9)</a>  and <a class="reference internal" href="#equation-eq-hugo22">(39.11)</a>  express <span class="math notranslate nohighlight">\((c,a)\)</span> as functions
of <span class="math notranslate nohighlight">\(V\)</span> and  the continuation value <span class="math notranslate nohighlight">\(V^u\)</span>.</p>
<p>Using these functions
allows us to write the Bellman equation in <span class="math notranslate nohighlight">\(C(V)\)</span> as</p>
<div class="math notranslate nohighlight" id="equation-eq-hugo23">
<span class="eqno">(39.12)<a class="headerlink" href="#equation-eq-hugo23" title="Permalink to this equation">#</a></span>\[ 
C(V)  = \min_{V^u} \left\{ c + \beta [1 - p(a)] C(V^u) \right\} 
\]</div>
<p>where <span class="math notranslate nohighlight">\(c\)</span> and <span class="math notranslate nohighlight">\(a\)</span> are given by equations <a class="reference internal" href="#equation-eq-hugo21">(39.9)</a>  and <a class="reference internal" href="#equation-eq-hugo22">(39.11)</a>.</p>
</section>
<section id="python-computations">
<h3><span class="section-number">39.3.2. </span>Python Computations<a class="headerlink" href="#python-computations" title="Permalink to this heading">#</a></h3>
<p>Weâ€™ll approximate the plannerâ€™s optimal cost function  with cubic splines.</p>
<p>To do this, weâ€™ll load some useful modules</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>
</pre></div>
</div>
</div>
</div>
<p>We first create a class to set up a particular parametrization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">params_instance</span><span class="p">:</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                <span class="n">r</span><span class="p">,</span>
                <span class="n">Î²</span> <span class="o">=</span> <span class="mf">0.999</span><span class="p">,</span>
                <span class="n">Ïƒ</span> <span class="o">=</span> <span class="mf">0.500</span><span class="p">,</span>
                <span class="n">w</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
                <span class="n">n_grid</span> <span class="o">=</span> <span class="mi">50</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Î²</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Ïƒ</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">Î²</span><span class="p">,</span><span class="n">Ïƒ</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">r</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_grid</span> <span class="o">=</span> <span class="n">n_grid</span>
        <span class="n">uw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Ïƒ</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Ïƒ</span><span class="p">)</span>  <span class="c1">#Utility from consuming all wage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ve</span> <span class="o">=</span> <span class="n">uw</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Î²</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="parameter-values">
<h3><span class="section-number">39.3.3. </span>Parameter Values<a class="headerlink" href="#parameter-values" title="Permalink to this heading">#</a></h3>
<p>For  the other parameters we have just loaded in the above Python code, weâ€™ll set brate the net  interest rate <span class="math notranslate nohighlight">\(r\)</span> to match the hazard rate â€“  the probability of finding a job in one period â€“  in US data.</p>
<p>In particular, we seek an <span class="math notranslate nohighlight">\(r\)</span> so that in  autarky <code class="docutils literal notranslate"><span class="pre">p(a(r))</span> <span class="pre">=</span> <span class="pre">0.1</span></code>, where <code class="docutils literal notranslate"><span class="pre">a</span></code> is the optimal search effort.</p>
<p>First, we create some helper functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The probability of finding a job given search effort, a and interest rate r.</span>
<span class="k">def</span> <span class="nf">p</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">r</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">invp_prime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">r</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">r</span>

<span class="k">def</span> <span class="nf">p_prime</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">r</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>

<span class="c1"># The utiliy function</span>
<span class="k">def</span> <span class="nf">u</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>        
    <span class="k">return</span> <span class="p">(</span><span class="n">c</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Ïƒ</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Ïƒ</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">u_inv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Ïƒ</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Ïƒ</span><span class="p">))</span> 
</pre></div>
</div>
</div>
</div>
<p>Recall that under  autarky the value for an unemployed worker
satisfies  the Bellman equation</p>
<div class="math notranslate nohighlight" id="equation-eq-yad1">
<span class="eqno">(39.13)<a class="headerlink" href="#equation-eq-yad1" title="Permalink to this equation">#</a></span>\[
V^u = \max_{a} \{u(0) - a + \beta\left[p_{r}(a)V^e + (1-p_{r}(a))V^u\right]\} 
\]</div>
<p>At the optimal choice of <span class="math notranslate nohighlight">\(a\)</span>, we have the first order condition for this problem as:</p>
<div class="math notranslate nohighlight" id="equation-eq-yad2">
<span class="eqno">(39.14)<a class="headerlink" href="#equation-eq-yad2" title="Permalink to this equation">#</a></span>\[
\beta p_{r}'(a)[V^e - V^u] \leq 1 
\]</div>
<p>with equality when a &gt;0.</p>
<p>Given an interest rate <span class="math notranslate nohighlight">\(\bar{r}\)</span>, we can solve the autarky problem as follows:</p>
<ol class="arabic simple">
<li><p>Guess <span class="math notranslate nohighlight">\(V^u \in \mathbb{R}^{+}\)</span></p></li>
<li><p>Given <span class="math notranslate nohighlight">\(V^u\)</span>, use the FOC <a class="reference internal" href="#equation-eq-yad2">(39.14)</a> to calculate the implied optimal search effort <span class="math notranslate nohighlight">\(a\)</span></p></li>
<li><p>Evaluate the difference between the LHS and RHS of the Bellman equation <a class="reference internal" href="#equation-eq-yad1">(39.13)</a></p></li>
<li><p>Update guess for <span class="math notranslate nohighlight">\(V^u\)</span> accordingly, then return  to 2) and repeat until the Bellman equation is satisfied.</p></li>
</ol>
<p>For a given <span class="math notranslate nohighlight">\(r\)</span> and guess <span class="math notranslate nohighlight">\(V^u\)</span>,
the function <code class="docutils literal notranslate"><span class="pre">Vu_error</span></code> calculates the error in the Bellman equation under the optimal search intensity.</p>
<p>Weâ€™ll  soon use this as an input to computing <span class="math notranslate nohighlight">\(V^u\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The error in the Bellman equation that requires equality at </span>
<span class="c1"># the optimal choices.</span>
<span class="k">def</span> <span class="nf">Vu_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Vu</span><span class="p">,</span><span class="n">r</span><span class="p">):</span>
    <span class="n">Î²</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Î²</span>
    <span class="n">Ve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ve</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">invp_prime</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">Î²</span><span class="o">*</span><span class="p">(</span><span class="n">Ve</span><span class="o">-</span><span class="n">Vu</span><span class="p">)),</span><span class="n">r</span><span class="p">)</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">u</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span><span class="n">a</span> <span class="o">+</span> <span class="n">Î²</span><span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">r</span><span class="p">)</span><span class="o">*</span><span class="n">Ve</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">r</span><span class="p">))</span><span class="o">*</span><span class="n">Vu</span><span class="p">)</span> <span class="o">-</span> <span class="n">Vu</span>
    <span class="k">return</span> <span class="n">error</span>
</pre></div>
</div>
</div>
</div>
<p>Since the calibration exercise is to match the hazard rate under autarky to the data, we must find an interest rate <span class="math notranslate nohighlight">\(r\)</span> to match <code class="docutils literal notranslate"><span class="pre">p(a,r)</span> <span class="pre">=</span> <span class="pre">0.1</span></code>.</p>
<p>The function below <code class="docutils literal notranslate"><span class="pre">r_error</span></code> calculates, for a given guess of <span class="math notranslate nohighlight">\(r\)</span> the difference between the model implied equilibrium hazard rate and 0.1.</p>
<p>This will be used to solve for the a calibrated <span class="math notranslate nohighlight">\(r^*\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The error of our p(a^*) relative to our calibration target</span>
<span class="k">def</span> <span class="nf">r_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">r</span><span class="p">):</span>
    <span class="n">Î²</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Î²</span>
    <span class="n">Ve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ve</span>

    <span class="n">Vu_star</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="n">Vu_error_Î›</span><span class="p">,</span><span class="mi">15000</span><span class="p">,</span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span><span class="p">))</span>
    <span class="n">a_star</span> <span class="o">=</span> <span class="n">invp_prime</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">Î²</span><span class="o">*</span><span class="p">(</span><span class="n">Ve</span><span class="o">-</span><span class="n">Vu_star</span><span class="p">)),</span><span class="n">r</span><span class="p">)</span> <span class="c1"># Assuming a&gt;0</span>
    <span class="k">return</span>    <span class="n">p</span><span class="p">(</span><span class="n">a_star</span><span class="p">,</span><span class="n">r</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.1</span>
</pre></div>
</div>
</div>
</div>
<p>Now, let us create an instance of the model with our parametrization</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="n">params_instance</span><span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="mf">1e-2</span><span class="p">)</span> 
<span class="c1"># Create some lambda functions useful for fsolve function</span>
<span class="n">Vu_error_Î›</span> <span class="o">=</span>  <span class="k">lambda</span> <span class="n">Vu</span><span class="p">,</span><span class="n">r</span><span class="p">:</span> <span class="n">Vu_error</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">Vu</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
<span class="n">r_error_Î›</span> <span class="o">=</span>  <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r_error</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We want to compute an  <span class="math notranslate nohighlight">\(r\)</span> that is consistent with the hazard rate 0.1 in autarky.</p>
<p>To do so, we will use a bisection strategy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r_calibrated</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">brentq</span><span class="p">(</span><span class="n">r_error_Î›</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="mf">1e-10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Interest rate to match 0.1 hazard rate: r = </span><span class="si">{</span><span class="n">r_calibrated</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">Vu_aut</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="n">Vu_error_Î›</span><span class="p">,</span><span class="mi">15000</span><span class="p">,</span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">r_calibrated</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">a_aut</span> <span class="o">=</span> <span class="n">invp_prime</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">Î²</span><span class="o">*</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">Ve</span><span class="o">-</span><span class="n">Vu_aut</span><span class="p">)),</span><span class="n">r_calibrated</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Check p at r: </span><span class="si">{</span><span class="n">p</span><span class="p">(</span><span class="n">a_aut</span><span class="p">,</span><span class="n">r_calibrated</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Interest rate to match 0.1 hazard rate: r = 0.00034314093938667064
Check p at r: 0.10000000000002074
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda3/envs/quantecon/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:178: RuntimeWarning: The iteration is not making good progress, as measured by the 
  improvement from the last five Jacobian evaluations.
  warnings.warn(msg, RuntimeWarning)
</pre></div>
</div>
</div>
</div>
<p>Now that we have calibrated our interest rate <span class="math notranslate nohighlight">\(r\)</span>, we can continue with solving the  model with private information.</p>
</section>
<section id="computation-under-private-information">
<h3><span class="section-number">39.3.4. </span>Computation under Private Information<a class="headerlink" href="#computation-under-private-information" title="Permalink to this heading">#</a></h3>
<p>Our approach to solving the full model is a variant on Judd (1998) <span id="id6">[<a class="reference internal" href="zreferences.html#id166" title="K L Judd. Numerical Methods in Economics. Scientific and Engineering. MIT Press, 1998.">Jud98</a>]</span>, who uses a polynomial to approximate the value function and a numerical optimizer to perform the optimization at each iteration.</p>
<p>In contrast, we will use cubic splines to interpolate across a pre-set grid of points to approximate the value function. For further details of the Judd (1998) <span id="id7">[<a class="reference internal" href="zreferences.html#id166" title="K L Judd. Numerical Methods in Economics. Scientific and Engineering. MIT Press, 1998.">Jud98</a>]</span> method, see <span id="id8">[<a class="reference internal" href="zreferences.html#id173" title="L Ljungqvist and T J Sargent. Recursive Macroeconomic Theory. MIT Press, 4 edition, 2018.">LS18</a>]</span>, Section 5.7.</p>
<p>Our strategy involves finding a function <span class="math notranslate nohighlight">\(C(V)\)</span> â€“ the expected cost of giving the worker value <span class="math notranslate nohighlight">\(V\)</span> â€“ that satisfies the Bellman equation:</p>
<div class="math notranslate nohighlight" id="equation-eq-yad3">
<span class="eqno">(39.15)<a class="headerlink" href="#equation-eq-yad3" title="Permalink to this equation">#</a></span>\[
C(V) = \min_{c,a,V^u} \{c + \beta\left[1-p(a)\right]C(V^u)\}
\]</div>
<p>To solve this model, notice that in equations <a class="reference internal" href="#equation-eq-hugo21">(39.9)</a> and <a class="reference internal" href="#equation-eq-hugo22">(39.11)</a>, we have analytical solutions of <span class="math notranslate nohighlight">\(c\)</span> and <span class="math notranslate nohighlight">\(a\)</span> in terms of (at most) promised value <span class="math notranslate nohighlight">\(V\)</span> and <span class="math notranslate nohighlight">\(V^u\)</span> (and other parameters).</p>
<p>We can substitute these equations for <span class="math notranslate nohighlight">\(c\)</span> and <span class="math notranslate nohighlight">\(a\)</span> and obtain the functional equation <a class="reference internal" href="#equation-eq-hugo23">(39.12)</a> that we want to solve.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calc_c</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Vu</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">a</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the optimal consumption choice coming from the constraint of the insurer&#39;s problem </span>
<span class="sd">    (which is also a Bellman equation)</span>
<span class="sd">    &#39;&#39;&#39;</span>    
    <span class="n">Î²</span><span class="p">,</span><span class="n">Ve</span><span class="p">,</span><span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Î²</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Ve</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">u_inv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">V</span> <span class="o">+</span> <span class="n">a</span> <span class="o">-</span> <span class="n">Î²</span><span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">r</span><span class="p">)</span><span class="o">*</span><span class="n">Ve</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">r</span><span class="p">))</span><span class="o">*</span><span class="n">Vu</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">c</span>

<span class="k">def</span> <span class="nf">calc_a</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Vu</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the optimal effort choice coming from the worker&#39;s effort optimality condition.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">r</span><span class="p">,</span><span class="n">Î²</span><span class="p">,</span><span class="n">Ve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Î²</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Ve</span>
    
    <span class="n">a_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">Î²</span><span class="o">*</span><span class="p">(</span><span class="n">Ve</span> <span class="o">-</span> <span class="n">Vu</span><span class="p">))</span><span class="o">/</span><span class="n">r</span>
    <span class="n">a</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">a_temp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span>
</pre></div>
</div>
</div>
</div>
<p>With these analytical solutions for optimal <span class="math notranslate nohighlight">\(c\)</span> and <span class="math notranslate nohighlight">\(a\)</span> in hand, we can reduce the minimization to  <a class="reference internal" href="#equation-eq-hugo23">(39.12)</a>  in the single variable
<span class="math notranslate nohighlight">\(V^u\)</span>.</p>
<p>With this in hand, we have our algorithm.</p>
</section>
<section id="algorithm">
<h3><span class="section-number">39.3.5. </span>Algorithm<a class="headerlink" href="#algorithm" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Fix a set of grid points <span class="math notranslate nohighlight">\(grid_V\)</span> for <span class="math notranslate nohighlight">\(V\)</span>   and <span class="math notranslate nohighlight">\(Vu_{grid}\)</span> for <span class="math notranslate nohighlight">\(V^u\)</span></p></li>
<li><p>Guess a function <span class="math notranslate nohighlight">\(C_0(V)\)</span> that is evaluated at a grid <span class="math notranslate nohighlight">\(grid_V\)</span>.</p></li>
<li><p>For each point in <span class="math notranslate nohighlight">\(grid_V\)</span> find the <span class="math notranslate nohighlight">\(V^u\)</span> that minimizes the expression on  right side  of <a class="reference internal" href="#equation-eq-hugo23">(39.12)</a>. We find the minimum by evaluating the right side of <a class="reference internal" href="#equation-eq-hugo23">(39.12)</a> at each point in <span class="math notranslate nohighlight">\(Vu_{grid}\)</span>  and then finding the minimum using cubic splines.</p></li>
<li><p>Evaluating the minimum across all points in <span class="math notranslate nohighlight">\(grid_V\)</span> gives you another function <span class="math notranslate nohighlight">\(C_1(V)\)</span>.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(C_0(V)\)</span> and <span class="math notranslate nohighlight">\(C_1(V)\)</span> are sufficiently different, then repeat steps 3-4 again. Otherwise, we are done.</p></li>
<li><p>Thus, the iterations are <span class="math notranslate nohighlight">\(C_{j+1}(V) = \min_{c,a, V^u} \{c - \beta [1 - p(a) ] C_j(V)\} \)</span>.</p></li>
</ol>
<p>The function <code class="docutils literal notranslate"><span class="pre">iterate_C</span></code> below executes step 3 in the above algorithm.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Operator iterate_C that calculates the next iteration of the cost function.</span>
<span class="k">def</span> <span class="nf">iterate_C</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C_old</span><span class="p">,</span><span class="n">Vu_grid</span><span class="p">):</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    We solve the model by minimising the value function across a grid of possible promised values.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">Î²</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">n_grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Î²</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">n_grid</span>

    <span class="n">C_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_grid</span><span class="p">)</span>
    <span class="n">cons_star</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_grid</span><span class="p">)</span>
    <span class="n">a_star</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_grid</span><span class="p">)</span>
    <span class="n">V_star</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_grid</span><span class="p">)</span>

    <span class="n">C_new2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_grid</span><span class="p">)</span>
    <span class="n">V_star2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_grid</span><span class="p">)</span>    

    <span class="k">for</span> <span class="n">V_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_grid</span><span class="p">):</span>
        <span class="n">C_Vi_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_grid</span><span class="p">)</span>
        <span class="n">cons_Vi_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_grid</span><span class="p">)</span>
        <span class="n">a_Vi_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_grid</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">Vu_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_grid</span><span class="p">):</span>
            <span class="n">a_i</span> <span class="o">=</span> <span class="n">calc_a</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Vu_grid</span><span class="p">[</span><span class="n">Vu_i</span><span class="p">])</span>
            <span class="n">c_i</span> <span class="o">=</span> <span class="n">calc_c</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Vu_grid</span><span class="p">[</span><span class="n">Vu_i</span><span class="p">],</span><span class="n">Vu_grid</span><span class="p">[</span><span class="n">V_i</span><span class="p">],</span><span class="n">a_i</span><span class="p">)</span>

            <span class="n">C_Vi_temp</span><span class="p">[</span><span class="n">Vu_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_i</span> <span class="o">+</span> <span class="n">Î²</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">(</span><span class="n">a_i</span><span class="p">,</span><span class="n">r</span><span class="p">))</span><span class="o">*</span><span class="n">C_old</span><span class="p">[</span><span class="n">Vu_i</span><span class="p">]</span> 
            <span class="n">cons_Vi_temp</span><span class="p">[</span><span class="n">Vu_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_i</span>
            <span class="n">a_Vi_temp</span><span class="p">[</span><span class="n">Vu_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_i</span>

        <span class="c1"># Interpolate across the grid to get better approximation of the minimum</span>
        <span class="n">C_Vi_temp_interp</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">Vu_grid</span><span class="p">,</span><span class="n">C_Vi_temp</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
        <span class="n">cons_Vi_temp_interp</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">Vu_grid</span><span class="p">,</span><span class="n">cons_Vi_temp</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
        <span class="n">a_Vi_temp_interp</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">Vu_grid</span><span class="p">,</span><span class="n">a_Vi_temp</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;cubic&#39;</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">minimize_scalar</span><span class="p">(</span><span class="n">C_Vi_temp_interp</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;bounded&#39;</span><span class="p">,</span><span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="n">Vu_min</span><span class="p">,</span><span class="n">Vu_max</span><span class="p">))</span>
        <span class="n">V_star</span><span class="p">[</span><span class="n">V_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span>
        <span class="n">C_new</span><span class="p">[</span><span class="n">V_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">fun</span>
        
        <span class="c1"># Save the associated consumpton and search policy functions as well</span>
        <span class="n">cons_star</span><span class="p">[</span><span class="n">V_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cons_Vi_temp_interp</span><span class="p">(</span><span class="n">V_star</span><span class="p">[</span><span class="n">V_i</span><span class="p">])</span>
        <span class="n">a_star</span><span class="p">[</span><span class="n">V_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_Vi_temp_interp</span><span class="p">(</span><span class="n">V_star</span><span class="p">[</span><span class="n">V_i</span><span class="p">])</span>        

    <span class="k">return</span> <span class="n">C_new</span><span class="p">,</span><span class="n">V_star</span><span class="p">,</span><span class="n">cons_star</span><span class="p">,</span><span class="n">a_star</span>
</pre></div>
</div>
</div>
</div>
<p>The below code executes steps 4 and 5 in the Algorithm  until convergence to a function <span class="math notranslate nohighlight">\(C^*(V)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">solve_incomplete_info_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Vu_grid</span><span class="p">,</span><span class="n">Vu_aut</span><span class="p">,</span><span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span><span class="n">max_iter</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">):</span>
    <span class="nb">iter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">error</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">C_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_grid</span><span class="p">)</span><span class="o">*</span><span class="mi">0</span>
    <span class="n">C_old</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">C_init</span><span class="p">)</span>

    <span class="k">while</span> <span class="nb">iter</span><span class="o">&lt;</span><span class="n">max_iter</span> <span class="ow">and</span> <span class="n">error</span> <span class="o">&gt;</span><span class="n">tol</span><span class="p">:</span>
        <span class="n">C_new</span><span class="p">,</span><span class="n">V_new</span><span class="p">,</span><span class="n">cons_star</span><span class="p">,</span><span class="n">a_star</span> <span class="o">=</span> <span class="n">iterate_C</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C_old</span><span class="p">,</span><span class="n">Vu_grid</span><span class="p">)</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">C_new</span> <span class="o">-</span> <span class="n">C_old</span><span class="p">))</span>
        
        <span class="c1">#Only print the iterations every 50 steps</span>
        <span class="k">if</span> <span class="nb">iter</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteration: </span><span class="si">{</span><span class="nb">iter</span><span class="si">}</span><span class="s2">, error:</span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">C_old</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">C_new</span><span class="p">)</span>
        <span class="nb">iter</span><span class="o">+=</span><span class="mi">1</span>

    <span class="k">return</span> <span class="n">C_new</span><span class="p">,</span><span class="n">V_new</span><span class="p">,</span><span class="n">cons_star</span><span class="p">,</span><span class="n">a_star</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="outcomes">
<h2><span class="section-number">39.4. </span>Outcomes<a class="headerlink" href="#outcomes" title="Permalink to this heading">#</a></h2>
<p>Using the above functions, we create another instance of the parameters with the correctly calibrated interest rate, <span class="math notranslate nohighlight">\(r\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##? Create another instance with the correct r now</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">params_instance</span><span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="n">r_calibrated</span><span class="p">)</span> 

<span class="c1">#Set up grid</span>
<span class="n">Vu_min</span> <span class="o">=</span> <span class="n">Vu_aut</span>
<span class="n">Vu_max</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">Ve</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">Î²</span><span class="o">*</span><span class="n">p_prime</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">params</span><span class="o">.</span><span class="n">r</span><span class="p">))</span>
<span class="n">Vu_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">Vu_min</span><span class="p">,</span><span class="n">Vu_max</span><span class="p">,</span><span class="n">params</span><span class="o">.</span><span class="n">n_grid</span><span class="p">)</span>

<span class="c1">#Solve model</span>
<span class="n">C_star</span><span class="p">,</span><span class="n">V_star</span><span class="p">,</span><span class="n">cons_star</span><span class="p">,</span><span class="n">a_star</span> <span class="o">=</span> <span class="n">solve_incomplete_info_model</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">Vu_grid</span><span class="p">,</span><span class="n">Vu_aut</span><span class="p">,</span><span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span><span class="n">max_iter</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">)</span> <span class="c1">#,cons_star,a_star</span>

<span class="c1"># Since we have the policy functions in grid form, we will interpolate them to be able to</span>
<span class="c1"># evaluate any promised value</span>
<span class="n">cons_star_interp</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">Vu_grid</span><span class="p">,</span><span class="n">cons_star</span><span class="p">)</span>
<span class="n">a_star_interp</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">Vu_grid</span><span class="p">,</span><span class="n">a_star</span><span class="p">)</span>
<span class="n">V_star_interp</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">Vu_grid</span><span class="p">,</span><span class="n">V_star</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration: 0, error:72.95964854907824
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration: 50, error:12.222761762494429
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration: 100, error:0.12875960366955042
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration: 150, error:0.0009402349710398994
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration: 200, error:6.115462838351959e-06
</pre></div>
</div>
</div>
</div>
<section id="replacement-ratios-and-continuation-values">
<h3><span class="section-number">39.4.1. </span>Replacement Ratios and Continuation Values<a class="headerlink" href="#replacement-ratios-and-continuation-values" title="Permalink to this heading">#</a></h3>
<p>We want to graph the  replacement ratio (<span class="math notranslate nohighlight">\(c/w\)</span>) and  search effort <span class="math notranslate nohighlight">\(a\)</span> as  functions of the duration of unemployment.</p>
<p>Weâ€™ll do this for three levels of <span class="math notranslate nohighlight">\(V_0\)</span>, the lowest being the autarky value <span class="math notranslate nohighlight">\(V_{\rm aut}\)</span>.</p>
<p>We accomplish this by using the optimal policy functions <code class="docutils literal notranslate"><span class="pre">V_star</span></code>, <code class="docutils literal notranslate"><span class="pre">cons_star</span></code> and <code class="docutils literal notranslate"><span class="pre">a_star</span></code> computed above as well the following  iterative procedure:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Replacement ratio and effort as a function of unemployment duration</span>
<span class="n">T_max</span> <span class="o">=</span> <span class="mi">52</span>
<span class="n">Vu_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">T_max</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">cons_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">T_max</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">a_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">T_max</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="c1"># Calculate the replacement ratios depending on different initial</span>
<span class="c1"># promised values</span>
<span class="n">Vu_0_hold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Vu_aut</span><span class="p">,</span><span class="mi">16942</span><span class="p">,</span><span class="mi">17000</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">Vu_0</span><span class="p">,</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Vu_0_hold</span><span class="p">):</span>
    <span class="n">Vu_t</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Vu_0</span> 
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">T_max</span><span class="p">):</span>
        <span class="n">cons_t</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cons_star_interp</span><span class="p">(</span><span class="n">Vu_t</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">])</span>
        <span class="n">a_t</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_star_interp</span><span class="p">(</span><span class="n">Vu_t</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">])</span>
        <span class="n">Vu_t</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_star_interp</span><span class="p">(</span><span class="n">Vu_t</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fontSize</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">fontSize</span><span class="p">)</span>          <span class="c1"># controls default text sizes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="n">fontSize</span><span class="p">)</span>     <span class="c1"># fontsize of the axes title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fontSize</span><span class="p">)</span>    <span class="c1"># fontsize of the x and y labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fontSize</span><span class="p">)</span>    <span class="c1"># fontsize of the tick labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;ytick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fontSize</span><span class="p">)</span>    <span class="c1"># fontsize of the tick labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontSize</span><span class="p">)</span>    <span class="c1"># legend fontsize</span>

<span class="n">f1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T_max</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">cons_t</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">params</span><span class="o">.</span><span class="n">w</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$V^u_0$ = 16759 (aut)&#39;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T_max</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">cons_t</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">params</span><span class="o">.</span><span class="n">w</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$V^u_0$ = 16942&#39;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T_max</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">cons_t</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">params</span><span class="o">.</span><span class="n">w</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$V^u_0$ = 17000&#39;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Replacement ratio (c/w)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Optimal replacement ratio&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T_max</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">a_t</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T_max</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">a_t</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T_max</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">a_t</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">320</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Optimal search effort (a)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Duration of unemployment&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Optimal search effort&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/598c2912e5c552f57af7aea9669268ec2140b91152f638b6d5e6a24691703e17.png" src="_images/598c2912e5c552f57af7aea9669268ec2140b91152f638b6d5e6a24691703e17.png" />
</div>
</div>
<p>For an initial promised value <span class="math notranslate nohighlight">\(V^u = V_{\rm aut}\)</span>, the planner chooses the autarky level of <span class="math notranslate nohighlight">\(0\)</span> for the replacement ratio and instructs the worker to search at the autarky search intensity, regardless of the duration of unemployment</p>
<p>But for <span class="math notranslate nohighlight">\(V^u &gt; V_{\rm aut}\)</span>, the planner makes the replacement ratio  decline and search effort increase  with the duration of unemployment.</p>
</section>
<section id="interpretations">
<h3><span class="section-number">39.4.2. </span>Interpretations<a class="headerlink" href="#interpretations" title="Permalink to this heading">#</a></h3>
<p>The  downward slope of the replacement ratio when <span class="math notranslate nohighlight">\(V^u &gt; V_{\rm aut}\)</span> is a consequence of the
the plannerâ€™s limited information about the workerâ€™s search effort.</p>
<p>By providing the worker with a duration-dependent schedule of replacement ratios, the planner induces the worker in effect to reveal
his/her search effort to the planner.</p>
<p>We saw earlier that with full  information, the
planner would smooth consumption
over an unemployment spell by
keeping the  replacement ratio constant.</p>
<p>With private information, the planner canâ€™t observe the workerâ€™s search effort
and therefore makes   the replacement ratio  fall.</p>
<p>Evidently, search
effort rise as the duration of unemployment increases, especially
early in an unemployment spell.</p>
<p>There is a <strong>carrot-and-stick</strong>
aspect to the replacement rate and search effort  schedules:</p>
<ul class="simple">
<li><p>the <strong>carrot</strong> occurs in the forms of high compensation and low search
effort early in an unemployment spell.</p></li>
<li><p>the <strong>stick</strong> occurs in the low compensation and high effort  later in
the spell.</p></li>
</ul>
<p>We shall encounter a related  carrot-and-stick feature in our other lectures about dynamic programming squared.</p>
<p>The planner offers declining benefits and induces increased search
effort as the duration of an unemployment spell rises in order to provide an
unemployed worker with proper incentives, not to punish an unlucky worker
who has been unemployed for a long time.</p>
<p>The planner believes that a worker who has been unemployed a long time is unlucky, not that he has
done anything wrong (i.e., has not lived up to the contract).</p>
<p>Indeed, the
contract is designed to induce the unemployed workers to search in
the way the planner expects.</p>
<p>The falling consumption and rising
search effort of the unlucky ones with long unemployment spells are
simply  costs that have to be paid in order to  provide
proper incentives.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tools and Techniques
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="orth_proj.html">
   1. Orthogonal Projections and Their Applications
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stationary_densities.html">
   2. Continuous State Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="muth_kalman.html">
   3. Reverse Engineering a la Muth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="discrete_dp.html">
   4. Discrete State Dynamic Programming
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  LQ Control
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="cons_news.html">
   5. Information and Consumption Smoothing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="smoothing.html">
   6. Consumption Smoothing with Complete and Incomplete Markets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="smoothing_tax.html">
   7. Tax Smoothing with Complete and Incomplete Markets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_jump_lq.html">
   8. Markov Jump Linear Quadratic Dynamic Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tax_smoothing_1.html">
   9. How to Pay for a War: Part 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tax_smoothing_2.html">
   10. How to Pay for a War: Part 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tax_smoothing_3.html">
   11. How to Pay for a War: Part 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lqramsey.html">
   12. Optimal Taxation in an LQ Economy
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Multiple Agent Models
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="arellano.html">
   13. Default Risk and Income Fluctuations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="matsuyama.html">
   14. Globalization and Cycles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coase.html">
   15. Coaseâ€™s Theory of the Firm
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Dynamic Linear Economies
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="hs_recursive_models.html">
   16. Recursive Models of Dynamic Linear Economies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="growth_in_dles.html">
   17. Growth in Dynamic Linear Economies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lucas_asset_pricing_dles.html">
   18. Lucas Asset Pricing Using DLE
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="irfs_in_hall_model.html">
   19. IRFs in Hall Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="permanent_income_dles.html">
   20. Permanent Income Model using the DLE Class
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rosen_schooling_model.html">
   21. Rosen Schooling Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cattle_cycles.html">
   22. Cattle Cycles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hs_invertibility_example.html">
   23. Shock Non Invertibility
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Risk, Model Uncertainty, and Robustness
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="five_preferences.html">
   24. Risk and Model Uncertainty
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="entropy.html">
   25. Etymology of Entropy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="robustness.html">
   26. Robustness
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rob_markov_perf.html">
   27. Robust Markov Perfect Equilibrium
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Time Series Models
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="arma.html">
   28. Covariance Stationary Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="estspec.html">
   29. Estimation of Spectra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="additive_functionals.html">
   30. Additive and Multiplicative Functionals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lu_tricks.html">
   31. Classical Control with Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="classical_filtering.html">
   32. Classical Prediction and Filtering With Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="knowing_forecasts_of_others.html">
   33. Knowing the Forecasts of Others
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Asset Pricing and Finance
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lucas_model.html">
   34. Asset Pricing II: The Lucas Asset Pricing Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="asset_pricing_lph.html">
   35. Elementary Asset Pricing Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="black_litterman.html">
   36. Two Modifications of Mean-Variance Portfolio Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="BCG_complete_mkts.html">
   37. Irrelevance of Capital Structures with Complete Markets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="BCG_incomplete_mkts.html">
   38. Equilibrium Capital Structures with Incomplete Markets
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Dynamic Programming Squared
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   39. Optimal Unemployment Insurance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dyn_stack.html">
   40. Stackelberg Plans
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="calvo.html">
   41. Ramsey Plans, Time Inconsistency, Sustainable Plans
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="opt_tax_recur.html">
   42. Optimal Taxation with State-Contingent Debt
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="amss.html">
   43. Optimal Taxation without State-Contingent Debt
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="amss2.html">
   44. Fluctuating Interest Rates Deliver Fiscal Insurance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="amss3.html">
   45. Fiscal Risk and Government Debt
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chang_ramsey.html">
   46. Competitive Equilibria of a Model of Chang
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chang_credible.html">
   47. Credible Government Policies in a Model of Chang
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Other
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="troubleshooting.html">
   48. Troubleshooting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zreferences.html">
   49. References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="status.html">
   50. Execution Statistics
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="intro.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                    <!-- <li class="btn__search">
                        <form action="search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off">
                            <i data-feather="search"></i>
                        </form>
                    </li> -->
                </ul>

                <ul class="qe-toolbar__links">
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li data-tippy-content="Download Notebook"><a href="/_notebooks/un_insure.ipynb" download><i data-feather="download-cloud"></i></a></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li class="download-pdf" id="downloadButton"><i data-feather="file"></i></li>
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python-advanced.myst/tree/master/lectures/un_insure.md" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="/_pdf/quantecon-python-advanced.pdf" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://mybinder.org/v2/gh/QuantEcon/lecture-python-advanced.notebooks/master?urlpath=tree/un_insure.ipynb">BinderHub</option>
                
                    <option value="https://colab.research.google.com/github/QuantEcon/lecture-python-advanced.notebooks/blob/master/un_insure.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/QuantEcon/lecture-python-advanced.notebooks" data-urlpath="tree/lecture-python-advanced.notebooks/un_insure.ipynb" data-branch=master>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://mybinder.org/v2/gh/QuantEcon/lecture-python-advanced.notebooks/master?urlpath=tree/un_insure.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "un_insure";
                const repoURL = "https://github.com/QuantEcon/lecture-python-advanced.notebooks";
                const urlPath = "tree/lecture-python-advanced.notebooks/un_insure.ipynb";
                const branch = "master"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/jupyter/hub/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
  </body>
</html>